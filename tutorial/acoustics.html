<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Acoustics</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">Acoustics</a></li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="acoustics">
<h1>Acoustics<a class="headerlink" href="#acoustics" title="Permalink to this headline">¶</a></h1>
<p><strong>Summary :</strong>
<em>Here we go to grip with ill posed problems and eigenvalue problems</em></p>
<p>Pressure variations in air at rest are governed by the wave equation:</p>
<div class="math notranslate nohighlight">
\[{\partial^2 u \over \partial t^2} - c^2 \Delta u =0\]</div>
<p>When the solution wave is monochromatic (and that depends on the boundary and initial conditions), <span class="math notranslate nohighlight">\(u\)</span> is of the form <span class="math notranslate nohighlight">\(u(x,t)=Re(v(x) e^{ik t})\)</span> where <span class="math notranslate nohighlight">\(v\)</span> is a solution of Helmholtz’s equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    k^{2}v + c^{2}\Delta v &amp;= 0 &amp;\hbox{ in } \Omega\\
    \frac{\partial v}{\partial n}|_\Gamma &amp;= g &amp;
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is the source.</p>
<p>Note the “+” sign in front of the Laplace operator and that <span class="math notranslate nohighlight">\(k &gt; 0\)</span> is real.
This sign may make the problem ill posed for some values of <span class="math notranslate nohighlight">\(\frac c k\)</span>, a phenomenon called “resonance”.</p>
<p>At resonance there are non-zero solutions even when <span class="math notranslate nohighlight">\(g=0\)</span>.
So the following program may or may not work:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">kc2</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">g</span> <span class="o">=</span> <span class="kr">y</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="kr">y</span><span class="p">);</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">5.</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">5.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">3.</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">3.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">3.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">1.</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">1.</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a5</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">a6</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;}</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a0</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">a1</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">a2</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">a3</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">a4</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">a5</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">a6</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="c1">// Solve</span>
<span class="kt">solve</span> <span class="nf">sound</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">u</span><span class="o">*</span><span class="n">v</span> <span class="o">*</span> <span class="n">kc2</span>
      <span class="o">-</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
      <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
   <span class="p">)</span>
   <span class="o">-</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">a4</span><span class="p">)(</span>
        <span class="n">g</span> <span class="o">*</span> <span class="n">v</span>
   <span class="p">)</span>
   <span class="p">;</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Sound.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Results are on <a class="reference internal" href="#figacoustics"><span class="std std-numref">Fig. 86</span></a>. But when <span class="math notranslate nohighlight">\(kc2\)</span> is an eigenvalue of the problem, then the solution is not unique:</p>
<ul class="simple">
<li>if <span class="math notranslate nohighlight">\(u_e \neq 0\)</span> is an eigen state, then for any given solution <span class="math notranslate nohighlight">\(u+u_e\)</span> is <strong>another</strong> solution.</li>
</ul>
<p>To find all the <span class="math notranslate nohighlight">\(u_e\)</span> one can do the following :</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="kp">sigma</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">//value of the shift</span>

<span class="c1">// Problem</span>
<span class="c1">// OP = A - sigma B ; // The shifted matrix</span>
<span class="kt">varf</span> <span class="kp">op</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
      <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">)</span>
      <span class="o">-</span> <span class="kp">sigma</span><span class="o">*</span> <span class="n">u1</span><span class="o">*</span><span class="n">u2</span>
   <span class="p">)</span>
   <span class="p">;</span>

<span class="kt">varf</span> <span class="nf">b</span><span class="p">([</span><span class="n">u1</span><span class="p">],</span> <span class="p">[</span><span class="n">u2</span><span class="p">])</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">u1</span><span class="o">*</span><span class="n">u2</span>
   <span class="p">)</span>
   <span class="p">;</span> <span class="c1">// No Boundary condition see note \ref{note BC EV}</span>

<span class="kt">matrix</span> <span class="n">OP</span> <span class="o">=</span> <span class="kp">op</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">Crout</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span> <span class="kp">eps</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">);</span>

<span class="c1">// Eigen values</span>
<span class="kt">int</span> <span class="kp">nev</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="c1">// Number of requested eigenvalues near sigma</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ev</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span>  <span class="c1">// To store the nev eigenvalue</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">eV</span><span class="p">(</span><span class="kp">nev</span><span class="p">);</span>    <span class="c1">// To store the nev eigenvector</span>

<span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="nf">EigenValue</span><span class="p">(</span><span class="n">OP</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="kp">sym</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">sigma</span><span class="o">=</span><span class="kp">sigma</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="n">ev</span><span class="p">,</span> <span class="kp">vector</span><span class="o">=</span><span class="n">eV</span><span class="p">,</span>
   <span class="kp">tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="kp">maxit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">ncv</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ev</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; 2 eigen values &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ev</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">eV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;eigen.eps&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="inline2 figure" id="figacoustics">
<img alt="../_images/acoustics_0.png" src="../_images/acoustics_0.png" />
<p class="caption"><span class="caption-number">Fig. 86 </span><span class="caption-text">Amplitude of an acoustic signal coming from the left vertical wall.</span></p>
</div>
<div class="inline2 figure" id="id1">
<img alt="../_images/acoustics.png" src="../_images/acoustics.png" />
<p class="caption"><span class="caption-number">Fig. 87 </span><span class="caption-text">First eigen state (<span class="math notranslate nohighlight">\(\lambda=(k/c)^2=19.4256\)</span>) close to <span class="math notranslate nohighlight">\(20\)</span> of eigenvalue problem: <span class="math notranslate nohighlight">\(-\Delta \varphi = \lambda\varphi\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial \varphi}{\partial n} = 0\)</span> on <span class="math notranslate nohighlight">\(\Gamma\)</span>}</span></p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
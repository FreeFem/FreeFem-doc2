<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>A Large Fluid Problem</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">A Large Fluid Problem</a></li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="a-large-fluid-problem">
<h1>A Large Fluid Problem<a class="headerlink" href="#a-large-fluid-problem" title="Permalink to this headline">¶</a></h1>
<p>A friend of one of us in Auroville-India was building a ramp to access an air conditioned room.
As I was visiting the construction site he told me that he expected to cool air escaping by the door to the room to slide down the ramp and refrigerate the feet of the coming visitors.
I told him “no way” and decided to check numerically.</p>
<p>The fluid velocity and pressure are solution of the Navier-Stokes equations with varying density function of the temperature.</p>
<p>The geometry is trapezoidal with prescribed inflow made of cool air at the bottom and warm air above and so are the initial conditions; there is free outflow, slip velocity at the top (artificial) boundary and no-slip at the bottom.
However the Navier-Stokes cum temperature equations have a RANS <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model and a Boussinesq approximation for the buoyancy.
This comes to :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \partial_t\theta+u\nabla\theta-\nabla\cdot(\kappa_T^m\nabla\theta) &amp;=&amp; 0\\
    \partial_t u +u\nabla u -\nabla\cdot(\mu_T\nabla u) +\nabla p+ e(\theta-\theta_0)\vec e_2 &amp;=&amp;0\\
    \nabla\cdot u &amp;=&amp; 0\\
    \mu_T &amp;=&amp; c_\mu\frac{k^2}\epsilon\\
    \kappa_T &amp;=&amp; \kappa\mu_T\\
    \partial_t k + u\nabla k + \epsilon -\nabla\cdot(\mu_T\nabla k) &amp;=&amp; \frac{\mu_T}2|\nabla u+\nabla u^T|^2\\
    \partial_t\epsilon+u\nabla\epsilon + c_2\frac{\epsilon^2} k -\frac{c_\epsilon}{c_\mu}\nabla\cdot (\mu_T\nabla\epsilon) &amp;=&amp; \frac{c_1}2 k|\nabla u+\nabla u^T|^2\\
\end{array}\end{split}\]</div>
<p>We use a time discretization which preserves positivity and uses the method of characteristics (<span class="math notranslate nohighlight">\(X^m(x)\approx x-u^m(x)\delta t\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \frac 1{\delta t}(\theta^{m+1}-\theta^m \circ X^m)-\nabla\cdot(\kappa_T^m\nabla\theta^{m+1}) &amp;=&amp; 0\\
    \frac1{\delta t}(u^{m+1}-u^m \circ X^m) -\nabla\cdot(\mu_T^m\nabla u^{m+1}) +\nabla p^{m+1}+ e(\theta^{m+1}-\theta_0)\vec e_2 &amp;=&amp; 0\\
    \nabla\cdot u^{m+1} &amp;=&amp; 0\\
    \frac1{\delta t}(k^{m+1}-k^m \circ X^m) + k^{m+1}\frac{\epsilon^m}{k^m} -\nabla\cdot(\mu_T^m\nabla k^{m+1}) &amp;=&amp; \frac{\mu_T^m}2|\nabla u^m+{\nabla u^m}^T|^2\\
    \frac1{\delta t}(\epsilon^{m+1}-\epsilon^m \circ X^m) + c_2\epsilon^{m+1}\frac{\epsilon^m} {k^m} -\frac{c_\epsilon}{c_\mu}\nabla\dot(\mu_T^m\nabla\epsilon^{m+1}) &amp;=&amp; \frac{c_1}2 k^m|\nabla u^m+{\nabla u^m}^T|^2\\
    \mu_T ^{m+1} &amp;=&amp; c_\mu\frac{{k^{m+1}}^2}{\epsilon^{m+1}}\\
    \kappa_T^{m+1} &amp;=&amp; \kappa\mu_T^{m+1}
\end{array}\end{split}\]</div>
<p>In variational form and with appropriated boundary conditions the problem is :</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;iovtk&quot;</span>

<span class="kr">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">nnPlus</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">l</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">15.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">hSlope</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">H</span> <span class="o">=</span> <span class="mf">6.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>

<span class="kt">real</span> <span class="n">reylnods</span> <span class="o">=</span><span class="mi">500</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>

<span class="kt">real</span> <span class="kp">eps</span> <span class="o">=</span> <span class="mf">9.81</span><span class="o">/</span><span class="mf">303.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">nu</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">numu</span> <span class="o">=</span> <span class="n">nu</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">0.09</span><span class="p">);</span>
<span class="kt">real</span> <span class="n">nuep</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span><span class="o">/</span><span class="mf">4.1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>

<span class="kt">real</span> <span class="n">Penalty</span> <span class="o">=</span> <span class="mf">1.e-6</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">b1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="o">-</span><span class="n">l</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">hSlope</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b3</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">hSlope</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">l</span><span class="p">),</span> <span class="n">H</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">L</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">H</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b5</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">H</span><span class="p">,</span> <span class="n">h</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b6</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;}</span>

<span class="kt">mesh</span> <span class="n">Th</span><span class="o">=</span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">b1</span><span class="p">(</span><span class="n">nnPlus</span><span class="o">*</span><span class="n">nn</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">b2</span><span class="p">(</span><span class="n">nn</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">((</span><span class="n">L</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">hSlope</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">l</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">b3</span><span class="p">(</span><span class="n">nn</span><span class="o">*</span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">hSlope</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">l</span><span class="p">)))</span> <span class="o">+</span> <span class="n">b4</span><span class="p">(</span><span class="n">nn</span><span class="o">*</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="n">b5</span><span class="p">(</span><span class="n">nn</span><span class="o">*</span><span class="p">(</span><span class="n">H</span><span class="o">-</span><span class="n">h</span><span class="p">))</span> <span class="o">+</span> <span class="n">b6</span><span class="p">(</span><span class="n">nnPlus</span><span class="o">*</span><span class="n">nn</span><span class="o">*</span><span class="n">h</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>

<span class="c1">// Fespaces</span>
<span class="kt">fespace</span> <span class="nf">Vh2</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1b</span><span class="p">);</span>
<span class="n">Vh2</span> <span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">;</span>
<span class="n">Vh2</span> <span class="n">Vx</span><span class="p">,</span> <span class="n">Vy</span><span class="p">;</span>
<span class="n">Vh2</span> <span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">Tp</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">35</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">kp</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">ep</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">epp</span><span class="o">=</span><span class="n">ep</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">V0h</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P0</span><span class="p">);</span>
<span class="n">V0h</span> <span class="n">muT</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">V0h</span> <span class="n">prodk</span><span class="p">,</span> <span class="n">prode</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">0.25e-4</span><span class="p">,</span> <span class="n">stress</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">Grad</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="p">[</span><span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">x</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">y</span><span class="p">)]</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">Div</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">x</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">y</span><span class="p">))</span> <span class="c1">//</span>

<span class="c1">// Functions</span>
<span class="kt">func</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="kr">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>

<span class="kt">problem</span> <span class="nf">Temperature</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">alpha</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">q</span>
      <span class="o">+</span> <span class="n">kappa</span><span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
      <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">Tp</span><span class="p">)</span><span class="o">*</span><span class="n">q</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b6</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
   <span class="p">;</span>

<span class="kt">problem</span> <span class="nf">KineticTurbulence</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="p">(</span><span class="n">epp</span><span class="o">/</span><span class="n">kp</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="n">q</span>
      <span class="o">+</span> <span class="n">muT</span><span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">prodk</span> <span class="o">*</span> <span class="n">q</span>
      <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">q</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b5</span><span class="p">,</span> <span class="n">b6</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">beta</span><span class="o">*</span><span class="n">numu</span><span class="o">*</span><span class="n">stress</span><span class="p">)</span>
   <span class="p">;</span>

<span class="kt">problem</span> <span class="nf">ViscosityTurbulence</span><span class="p">(</span><span class="n">ep</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="p">(</span><span class="mf">1.92</span><span class="o">*</span><span class="n">epp</span><span class="o">/</span><span class="n">kp</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">ep</span> <span class="o">*</span> <span class="n">q</span>
      <span class="o">+</span> <span class="n">muT</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)(</span>
        <span class="n">T</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="mf">0.001</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">prode</span> <span class="o">*</span> <span class="n">q</span>
      <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">epp</span><span class="p">)</span><span class="o">*</span><span class="n">q</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b5</span><span class="p">,</span> <span class="n">b6</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="n">beta</span><span class="o">*</span><span class="n">nuep</span><span class="o">*</span><span class="nf">pow</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
   <span class="p">;</span>

<span class="c1">// Initialization with stationary solution</span>
<span class="kt">solve</span> <span class="nf">NavierStokes</span> <span class="p">([</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">,</span> <span class="n">p</span><span class="p">],</span> <span class="p">[</span><span class="n">Vx</span><span class="p">,</span> <span class="n">Vy</span><span class="p">,</span> <span class="n">q</span><span class="p">])</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">alpha</span> <span class="o">*</span> <span class="p">[</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">]</span><span class="o">&#39;</span> <span class="o">*</span> <span class="p">[</span><span class="n">Vx</span><span class="p">,</span> <span class="n">Vy</span><span class="p">]</span>
      <span class="o">+</span> <span class="n">muT</span> <span class="o">*</span> <span class="p">(</span><span class="n">Grad</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">:</span> <span class="n">Grad</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
      <span class="o">+</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="n">Penalty</span>
      <span class="o">-</span> <span class="n">p</span> <span class="o">*</span> <span class="n">Div</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
      <span class="o">-</span> <span class="n">Div</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">)(</span>
        <span class="n">Ux</span> <span class="o">*</span> <span class="n">Vx</span> <span class="o">*</span> <span class="mf">0.1</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="kp">eps</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">35</span><span class="p">)</span> <span class="o">*</span> <span class="n">Vx</span>
      <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">Upx</span><span class="p">)</span><span class="o">*</span><span class="n">Vx</span>
      <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">Upx</span><span class="p">,</span> <span class="n">Upy</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">Upy</span><span class="p">)</span><span class="o">*</span><span class="n">Vy</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b6</span><span class="p">,</span> <span class="n">Ux</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">Uy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b5</span><span class="p">,</span> <span class="n">Ux</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Uy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span> <span class="n">Uy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">Uy</span><span class="o">=-</span><span class="n">Upx</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">/</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">b3</span><span class="p">,</span> <span class="n">Uy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="p">;</span>

<span class="nf">plot</span><span class="p">([</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">coef</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;[Ux, Uy] - p&quot;</span><span class="p">);</span>

<span class="p">{</span>
   <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">xx</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span> <span class="n">yy</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span> <span class="n">pp</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span>
   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="mf">20.</span><span class="p">;</span>
      <span class="n">xx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ux</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mf">20.</span><span class="p">);</span>
      <span class="n">pp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mf">20.</span><span class="p">,</span><span class="mf">0.999</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">yy</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
   <span class="nf">plot</span><span class="p">([</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Ux x=0.5 cup&quot;</span><span class="p">);</span>
   <span class="nf">plot</span><span class="p">([</span><span class="n">yy</span><span class="p">,</span> <span class="n">pp</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;p y=0.999 cup&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Initialization</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="c1">//probably too big</span>
<span class="kt">int</span> <span class="kp">nbiter</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">coefdt</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">^</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="kp">nbiter</span><span class="p">);</span>
<span class="kt">real</span> <span class="n">coefcut</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">^</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="kp">nbiter</span><span class="p">);</span>
<span class="kt">real</span> <span class="n">cut</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="kt">real</span> <span class="kp">tol</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">coeftol</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">^</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="kp">nbiter</span><span class="p">);</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">reylnods</span><span class="p">;</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">T</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="p">((</span><span class="kr">x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">y</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="kr">x</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">y</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">));</span>

<span class="c1">// Convergence loop</span>
<span class="kt">real</span> <span class="n">T0</span> <span class="o">=</span> <span class="nf">clock</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">iter</span> <span class="o">&lt;=</span> <span class="kp">nbiter</span><span class="p">;</span> <span class="n">iter</span><span class="o">++</span><span class="p">){</span>
   <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Iteration &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">iter</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - dt = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">dt</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
   <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">;</span>

   <span class="c1">// Time loop</span>
   <span class="kt">real</span> <span class="kp">t</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">500</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="kp">t</span> <span class="o">+=</span> <span class="n">dt</span><span class="p">;</span>
      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Time step &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - t = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">t</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

      <span class="c1">// Update</span>
      <span class="n">Upx</span> <span class="o">=</span> <span class="n">Ux</span><span class="p">;</span>
      <span class="n">Upy</span> <span class="o">=</span> <span class="n">Uy</span><span class="p">;</span>
      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
      <span class="n">epp</span> <span class="o">=</span> <span class="n">ep</span><span class="p">;</span>
      <span class="n">Tp</span> <span class="o">=</span> <span class="kr">max</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span> <span class="c1">//for beauty only should be removed</span>
      <span class="n">Tp</span> <span class="o">=</span> <span class="kr">min</span><span class="p">(</span><span class="n">Tp</span><span class="p">,</span> <span class="mi">35</span><span class="p">);</span> <span class="c1">//for security only should be removed</span>
      <span class="n">kp</span> <span class="o">=</span> <span class="kr">max</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">);</span> <span class="n">epp</span> <span class="o">=</span> <span class="kr">max</span><span class="p">(</span><span class="n">ep</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">);</span> <span class="c1">// to be secure: should not be active</span>
      <span class="n">muT</span> <span class="o">=</span> <span class="mf">0.09</span><span class="o">*</span><span class="n">kp</span><span class="o">*</span><span class="n">kp</span><span class="o">/</span><span class="n">epp</span><span class="p">;</span>

      <span class="c1">// Solve NS</span>
      <span class="n">NavierStokes</span><span class="p">;</span>

      <span class="c1">// Update</span>
      <span class="n">prode</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.126</span><span class="o">*</span><span class="n">kp</span><span class="o">*</span><span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">Ux</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nf">pow</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">Uy</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="nf">pow</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">Uy</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">Ux</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
      <span class="n">prodk</span> <span class="o">=</span> <span class="o">-</span><span class="n">prode</span><span class="o">*</span><span class="n">kp</span><span class="o">/</span><span class="n">epp</span><span class="o">*</span><span class="mf">0.09</span><span class="o">/</span><span class="mf">0.126</span><span class="p">;</span>
      <span class="n">kappa</span> <span class="o">=</span> <span class="n">muT</span><span class="o">/</span><span class="mf">0.41</span><span class="p">;</span>
      <span class="n">stress</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="nf">dy</span><span class="p">(</span><span class="n">Ux</span><span class="p">));</span>

      <span class="c1">// Solve k-eps-T</span>
      <span class="n">KineticTurbulence</span><span class="p">;</span>
      <span class="n">ViscosityTurbulence</span><span class="p">;</span>
      <span class="n">Temperature</span><span class="p">;</span>

      <span class="c1">// Plot</span>
      <span class="nf">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
      <span class="nf">plot</span><span class="p">([</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="kp">coef</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot; [Ux, Uy] - p&quot;</span><span class="p">,</span> <span class="kp">WindowIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>

      <span class="c1">// Time</span>
      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">Time = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">clock</span><span class="p">()</span><span class="o">-</span><span class="n">T0</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="c1">// Check</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">iter</span> <span class="o">&gt;=</span> <span class="kp">nbiter</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

   <span class="c1">// Adaptmesh</span>
   <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">Ux</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Ux</span><span class="p">),</span> <span class="nf">dx</span><span class="p">(</span><span class="n">Ux</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">Uy</span><span class="p">)],</span> <span class="kp">splitpbedge</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">abserror</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">cutoff</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span><span class="kp">tol</span><span class="p">,</span> <span class="kp">inquire</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">ratio</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="kp">hmin</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">1000</span><span class="p">);</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>

   <span class="c1">// Update</span>
   <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">coefdt</span><span class="p">;</span>
   <span class="kp">tol</span> <span class="o">=</span> <span class="kp">tol</span> <span class="o">*</span> <span class="n">coeftol</span><span class="p">;</span>
   <span class="n">cut</span> <span class="o">=</span> <span class="n">cut</span> <span class="o">*</span> <span class="n">coefcut</span><span class="p">;</span>
<span class="p">}</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Total Time = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">clock</span><span class="p">()</span><span class="o">-</span><span class="n">T0</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<div class="inline2 figure" id="id1">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_T_100.png"><img alt="../_images/ALargeFluidProblem_T_100.png" src="../_images/ALargeFluidProblem_T_100.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 102 </span><span class="caption-text">Temperature at time step 100</span></p>
</div>
<div class="inline2 figure" id="id2">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_U_100.png"><img alt="../_images/ALargeFluidProblem_U_100.png" src="../_images/ALargeFluidProblem_U_100.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 103 </span><span class="caption-text">Velocity at time step 100</span></p>
</div>
<div class="inline2 figure" id="id3">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_T_200.png"><img alt="../_images/ALargeFluidProblem_T_200.png" src="../_images/ALargeFluidProblem_T_200.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 104 </span><span class="caption-text">Temperature at time step 200</span></p>
</div>
<div class="inline2 figure" id="id4">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_U_200.png"><img alt="../_images/ALargeFluidProblem_U_200.png" src="../_images/ALargeFluidProblem_U_200.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 105 </span><span class="caption-text">Velocity at time step 200</span></p>
</div>
<div class="inline2 figure" id="id5">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_T_300.png"><img alt="../_images/ALargeFluidProblem_T_300.png" src="../_images/ALargeFluidProblem_T_300.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 106 </span><span class="caption-text">Temperature at time step 300</span></p>
</div>
<div class="inline2 figure" id="id6">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_U_300.png"><img alt="../_images/ALargeFluidProblem_U_300.png" src="../_images/ALargeFluidProblem_U_300.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 107 </span><span class="caption-text">Velocity at time step 300</span></p>
</div>
<div class="inline2 figure" id="id7">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_T_400.png"><img alt="../_images/ALargeFluidProblem_T_400.png" src="../_images/ALargeFluidProblem_T_400.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 108 </span><span class="caption-text">Temperature at time step 400</span></p>
</div>
<div class="inline2 figure" id="id8">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_U_400.png"><img alt="../_images/ALargeFluidProblem_U_400.png" src="../_images/ALargeFluidProblem_U_400.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 109 </span><span class="caption-text">Velocity at time step 400</span></p>
</div>
<div class="inline2 figure" id="id9">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_T_500.png"><img alt="../_images/ALargeFluidProblem_T_500.png" src="../_images/ALargeFluidProblem_T_500.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 110 </span><span class="caption-text">Temperature at time step 500</span></p>
</div>
<div class="inline2 figure" id="id10">
<a class="reference internal image-reference" href="../_images/ALargeFluidProblem_U_500.png"><img alt="../_images/ALargeFluidProblem_U_500.png" src="../_images/ALargeFluidProblem_U_500.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 111 </span><span class="caption-text">Velocity at time step 500</span></p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
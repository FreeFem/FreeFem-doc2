<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>Membrane &#8212; FreeFem++ 3.61.2 documentation</title>

    <link rel="stylesheet" href="../_static/material-icons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/extra.css" />
    <link rel="stylesheet" type="text/css" href="../_static/notosanscjkjp.css" />
    <link rel="stylesheet" type="text/css" href="../_static/roboto.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material-design-lite-1.3.0/material.indigo-pink.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_materialdesign_theme.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sphinx_materialdesign_theme.js"></script>
    <link rel="canonical" href="doc.freefem.org/dev/tutorial/membrane.html" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Heat Exchanger" href="heatExchanger.html" />
    <link rel="prev" title="Classification of partial differential equations" href="equationsClassification.html" /> 
  </head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-drawer"><header class="mdl-layout__header mdl-layout__header--waterfall ">
    <div class="mdl-layout__header-row">
        
        <nav class="mdl-navigation breadcrumb">
            <a class="mdl-navigation__link" href="index.html">Tutorials</a><i class="material-icons">navigate_next</i>
            <a class="mdl-navigation__link is-active">Membrane</a>
        </nav>
        <div class="mdl-layout-spacer"></div>
        <nav class="mdl-navigation">
        
<form class="form-inline pull-sm-right" action="../search.html" method="get">
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">
        <label id="quick-search-icon" class="mdl-button mdl-js-button mdl-button--icon"  for="waterfall-exp">
            <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="q"  id="waterfall-exp" placeholder="Search" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </div>
      </div>
      <div class="mdl-tooltip" data-mdl-for="quick-search-icon">
      Quick search
      </div>
</form>
        
<a id="button-show-source"
    class="mdl-button mdl-js-button mdl-button--icon"
    href="../_sources/tutorial/membrane.rst.txt" rel="nofollow">
<i class="material-icons">code</i>
</a>
<div class="mdl-tooltip" data-mdl-for="button-show-source">
Show Source
</div>
        </nav>
    </div>
    <div class="mdl-layout__header-row header-links">
      <div class="mdl-layout-spacer"></div>
      <nav class="mdl-navigation">
      </nav>
    </div>
</header><header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <span class="title-text">
                  FreeFem++
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <p class="caption"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFem++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/meshGeneration.html">Mesh Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/finiteElement.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/algorithmsOptimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/developers.html">Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/reference.html">Language reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/globalVariables.html">Global variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/quadratureFormulae.html">Quadrature formulae</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/loops.html">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/IO.html">I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/externalLibraries.html">External libraries</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="poisson.html">Solving Poisson’s equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermalConduction.html">Thermal Conduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotatingHill.html">Pure Convection : The Rotating Hill</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="wifiPropagation.html">Wifi Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlabOctavePlot.html">Plotting in Matlab and Octave</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model/model.html">Mathematical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/staticProblems.html">Static problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/elasticity.html">Elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearStaticProblems.html">Non-linear static problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/eigenValueProblems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/evolutionProblems.html">Evolution problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/navierStokesEquations.html">Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/variationalInequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/domainDecomposition.html">Domain decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/fluidStructureCoupledProblem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/transmissionProblem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/freeBoundaryProblem.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearElasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html">Compressible Neo-Hookean materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/whisperingGalleryModes.html">Whispering gallery modes</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>
        <main class="mdl-layout__content" tabIndex="0">
<header class="mdl-layout__drawer">
    
          <!-- Title -->
      <span class="mdl-layout-title">
          <a class="title" href="../index.html">
              <span class="title-text">
                  FreeFem++
              </span>
          </a>
      </span>
    
    
      <div class="globaltoc">
        <span class="mdl-layout-title toc">Table Of Contents</span>
        
        
            
            <nav class="mdl-navigation">
                <p class="caption"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFem++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation/documentation.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/meshGeneration.html">Mesh Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/finiteElement.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/algorithmsOptimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../documentation/developers.html">Developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/reference.html">Language reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/globalVariables.html">Global variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/quadratureFormulae.html">Quadrature formulae</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/loops.html">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/IO.html">I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/externalLibraries.html">External libraries</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="poisson.html">Solving Poisson’s equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermalConduction.html">Thermal Conduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotatingHill.html">Pure Convection : The Rotating Hill</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="wifiPropagation.html">Wifi Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="matlabOctavePlot.html">Plotting in Matlab and Octave</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model/model.html">Mathematical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/staticProblems.html">Static problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/elasticity.html">Elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearStaticProblems.html">Non-linear static problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/eigenValueProblems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/evolutionProblems.html">Evolution problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/navierStokesEquations.html">Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/variationalInequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/domainDecomposition.html">Domain decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/fluidStructureCoupledProblem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/transmissionProblem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/freeBoundaryProblem.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearElasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html">Compressible Neo-Hookean materials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/whisperingGalleryModes.html">Whispering gallery modes</a></li>
</ul>
</li>
</ul>

            </nav>
        
        </div>
    
</header>

    <div class="document">
        <div class="page-content">
        
  <div class="section" id="membrane">
<span id="tutorialmembrane"></span><h1>Membrane<a class="headerlink" href="#membrane" title="Permalink to this headline">¶</a></h1>
<p><strong>Summary :</strong> <em>Here we shall learn how to solve a Dirichlet and/or mixed Dirichlet Neumann problem for the Laplace operator with application to the equilibrium of a membrane under load.
We shall also check the accuracy of the method and interface with other graphics packages</em></p>
<p>An elastic membrane <span class="math notranslate nohighlight">\(\Omega\)</span> is attached to a planar rigid support <span class="math notranslate nohighlight">\(\Gamma\)</span>, and a force <span class="math notranslate nohighlight">\(f(x) dx\)</span> is exerted on each surface element <span class="math notranslate nohighlight">\(\text{d}{x}=\text{d}{x}_1 \text{d}{x}_2\)</span>.
The vertical membrane displacement, <span class="math notranslate nohighlight">\(\varphi(x)\)</span>, is obtained by solving Laplace’s equation:</p>
<div class="math notranslate nohighlight">
\[-\Delta \varphi =f ~\hbox{in}~ \Omega\]</div>
<p>As the membrane is fixed to its planar support, one has:</p>
<div class="math notranslate nohighlight">
\[\varphi |_{\Gamma }=0\]</div>
<p>If the support wasn’t planar but had an elevation <span class="math notranslate nohighlight">\(z(x_1,x_2)\)</span> then the boundary conditions would be of non-homogeneous Dirichlet type.</p>
<div class="math notranslate nohighlight">
\[\varphi|_{\Gamma}=z\]</div>
<p>If a part <span class="math notranslate nohighlight">\(\Gamma_2\)</span> of the membrane border <span class="math notranslate nohighlight">\(\Gamma\)</span> is not fixed to the support but is left hanging, then due to the membrane’s rigidity the angle with the normal vector <span class="math notranslate nohighlight">\(n\)</span> is zero; thus the boundary conditions are:</p>
<div class="math notranslate nohighlight">
\[\varphi|_{\Gamma_1}=z,~~~~\frac{\partial\varphi}{\partial n}|_{\Gamma_2}=0\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma_1=\Gamma-\Gamma_2\)</span>; recall that <span class="math notranslate nohighlight">\(\frac{\partial\varphi}{\partial n}=\nabla\varphi\cdot n\)</span>
Let us recall also that the Laplace operator <span class="math notranslate nohighlight">\(\Delta\)</span> is defined by:</p>
<div class="math notranslate nohighlight">
\[\Delta \varphi = {\partial ^{2}\varphi \over \partial x^{2}_{1} }
+ {\partial ^{2}\varphi \over \partial x_{2}^{2} }\]</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Check references</p>
</div>
<p>With such <em>“mixed boundary conditions”</em> the problem has a unique solution (<strong>see (1987)</strong>, Dautray-Lions (1988), Strang (1986) and Raviart-Thomas (1983)).
The easiest proof is to notice that <span class="math notranslate nohighlight">\(\varphi\)</span> is the state of least energy, i.e.</p>
<div class="math notranslate nohighlight">
\[E(\phi) =\min_{\varphi-z\in V} E(v) ,\quad \mbox{with} \quad E(v)=\int_\Omega(\frac12|\nabla v|^2-fv )\]</div>
<p>and where <span class="math notranslate nohighlight">\(V\)</span> is the subspace of the Sobolev space <span class="math notranslate nohighlight">\(H^1(\Omega)\)</span> of functions which have zero trace on <span class="math notranslate nohighlight">\(\Gamma_1\)</span>.
Recall that (<span class="math notranslate nohighlight">\(x\in\mathbb{R}^d,~d=2\)</span> here):</p>
<div class="math notranslate nohighlight">
\[H^1(\Omega)=\{u\in L^2(\Omega)~:~\nabla u\in (L^2(\Omega))^d\}\]</div>
<p>Calculus of variation shows that the minimum must satisfy, what is known as the weak form of the PDE or its variational formulation (also known here as the theorem of virtual work)</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla\varphi\cdot\nabla w = \int_\Omega f w\quad\forall w\in V\]</div>
<p>Next an integration by parts (Green’s formula) will show that this is equivalent to the PDE when second derivatives exist.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Unlike Freefem+ which had both weak and strong forms, FreeFem++ implements only weak formulations.
It is not possible to go further in using this software if you don’t know the weak form (i.e.&nbsp;variational formulation) of your problem: either you read a book, or ask help form a colleague or drop the matter.
Now if you want to solve a system of PDE like <span class="math notranslate nohighlight">\(A(u,v)=0,~ B(u,v)=0\)</span> don’t close this manual, because in weak form it is</p>
</div>
<div class="math notranslate nohighlight">
\[\int_\Omega(A(u,v)w_1+B(u,v)w_2)=0~~\forall w_1,w_2...\]</div>
<p><strong>Example</strong></p>
<p>Let an ellipse have the length of the semimajor axis <span class="math notranslate nohighlight">\(a=2\)</span>, and unitary the semiminor axis.
Let the surface force be <span class="math notranslate nohighlight">\(f=1\)</span>.
Programming this case with FreeFem++ gives:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span>// Parameters
real theta = 4.*pi/3.;
real a = 2.; //The length of the semimajor axis
real b = 1.; //The length of the semiminor axis
func z = x;

// Mesh
border Gamma1(t=0., theta){x=a*cos(t); y=b*sin(t);}
border Gamma2(t=theta, 2.*pi){x=a*cos(t); y=b*sin(t);}
mesh Th = buildmesh(Gamma1(100) + Gamma2(50));

// Fespace
fespace Vh(Th, P2); //P2 conforming triangular FEM
Vh phi, w, f=1;

// Solve
solve Laplace(phi, w)
    = int2d(Th)(
          dx(phi)*dx(w)
        + dy(phi)*dy(w)
    )
    - int2d(Th)(
          f*w
    )
    + on(Gamma1, phi=z)
    ;

// Plot
plot(phi, wait=true, ps=&quot;membrane.eps&quot;); //Plot phi
plot(Th, wait=true, ps=&quot;membraneTh.eps&quot;); //Plot Th

// Save mesh
savemesh(Th,&quot;Th.msh&quot;);
</pre></div>
</div>
<p>A triangulation is built by the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span>buildmesh</code>.
This keyword calls a triangulation subroutine based on the Delaunay test, which first triangulates with only the boundary points, then adds internal points by subdividing the edges.
How fine the triangulation becomes is controlled by the size of the closest boundary edges.</p>
<p>The PDE is then discretized using the triangular second order finite element method on the triangulation; as was briefly indicated in the previous chapter, a linear system is derived from the discrete formulation whose size is the number of vertices plus the number of mid-edges in the triangulation.</p>
<p>The system is solved by a multi-frontal Gauss LU factorization implemented in the package <code class="code freefem docutils literal highlight highlight-freefem"><span></span>UMFPACK</code>.</p>
<p>The keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span>plot</code> will display both <span class="math notranslate nohighlight">\(\T_h\)</span> and <span class="math notranslate nohighlight">\(\varphi\)</span> (remove <code class="docutils literal highlight highlight-freefem"><span></span>Th</code> if <span class="math notranslate nohighlight">\(\varphi\)</span> only is desired) and the qualifier <code class="code freefem docutils literal highlight highlight-freefem"><span></span>fill=true</code> replaces the default option (colored level lines) by a full color display.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span>plot(phi,wait=true,fill=true); //Plot phi with full color display
</pre></div>
</div>
<p>Results are on <a class="reference internal" href="#figmembranemesh"><span class="std std-numref">Fig. 41</span></a> and <a class="reference internal" href="#figmembranelevellines"><span class="std std-numref">Fig. 42</span></a>.</p>
<div class="inline2 figure" id="figmembranemesh">
<img alt="../_images/membraneTh.png" src="../_images/membraneTh.png" />
<p class="caption"><span class="caption-number">Fig. 41 </span><span class="caption-text">Mesh of the ellipse</span></p>
</div>
<div class="inline2 figure" id="figmembranelevellines">
<img alt="../_images/membrane.png" src="../_images/membrane.png" />
<p class="caption"><span class="caption-number">Fig. 42 </span><span class="caption-text">Level lines of the membrane deformation</span></p>
</div>
<p>Next we would like to check the results !</p>
<p>One simple way is to adjust the parameters so as to know the solutions.
For instance on the unit circle <code class="docutils literal highlight highlight-freefem"><span></span>a=1</code>, <span class="math notranslate nohighlight">\(\varphi_e=\sin(x^2+y^2-1)\)</span> solves the problem when:</p>
<div class="math notranslate nohighlight">
\[z=0, f=-4(\cos(x^2+y^2-1)-(x^2+y^2)\sin(x^2+y^2-1))\]</div>
<p>except that on <span class="math notranslate nohighlight">\(\Gamma_2\)</span> <span class="math notranslate nohighlight">\(\partial_n\varphi=2\)</span> instead of zero.
So we will consider a non-homogeneous Neumann condition and solve:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega\nabla\varphi\cdot\nabla w = \int_\Omega f w+\int_{\Gamma_2}2w\quad\forall w\in V\]</div>
<p>We will do that with two triangulations, compute the <span class="math notranslate nohighlight">\(L^2\)</span> error:</p>
<div class="math notranslate nohighlight">
\[\epsilon = \int_\Omega|\varphi-\varphi_e|^2\]</div>
<p>and print the error in both cases as well as the log of their ratio an indication of the rate of convergence.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span>//  Parameters
verbosity = 0; //to remove all default output
real theta = 4.*pi/3.;
real a=1.; //the length of the semimajor axis
real b=1.; //the length of the semiminor axis
func f = -4*(cos(x^2+y^2-1) - (x^2+y^2)*sin(x^2+y^2-1));
func phiexact = sin(x^2 + y^2 - 1);

// Mesh
border Gamma1(t=0., theta){x=a*cos(t); y=b*sin(t);}
border Gamma2(t=theta, 2.*pi){x=a*cos(t); y=b*sin(t);}

// Error loop
real[int] L2error(2); //an array of two values
for(int n = 0; n &lt; 2; n++){
    // Mesh
    mesh Th = buildmesh(Gamma1(20*(n+1)) + Gamma2(10*(n+1)));

    // Fespace
    fespace Vh(Th, P2);
    Vh phi, w;

    // Solve
    solve Laplace(phi, w)
        = int2d(Th)(
              dx(phi)*dx(w)
            + dy(phi)*dy(w)
        )
        - int2d(Th)(
              f*w
        )
        - int1d(Th, Gamma2)(
              2*w
        )
        + on(Gamma1,phi=0)
        ;

    // Plot
    plot(Th, phi, wait=true, ps=&quot;membrane.eps&quot;);

    // Error
    L2error[n] = sqrt(int2d(Th)((phi-phiexact)^2));
}

// Display loop
for(int n = 0; n &lt; 2; n++)
    cout &lt;&lt; &quot;L2error &quot; &lt;&lt; n &lt;&lt; &quot; = &quot; &lt;&lt; L2error[n] &lt;&lt; endl;

// Convergence rate
cout &lt;&lt; &quot;convergence rate = &quot;&lt;&lt; log(L2error[0]/L2error[1])/log(2.) &lt;&lt; endl;
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>L2error <span class="nv">0</span> <span class="o">=</span> <span class="m">0</span>.00462991
L2error <span class="nv">1</span> <span class="o">=</span> <span class="m">0</span>.00117128
convergence <span class="nv">rate</span> <span class="o">=</span> <span class="m">1</span>.9829
times: compile <span class="m">0</span>.02s, execution <span class="m">6</span>.94s
</pre></div>
</div>
<p>We find a rate of 1.93591, which is not close enough to the 3 predicted by the theory.</p>
<p>The Geometry is always a polygon so we lose one order due to the geometry approximation in <span class="math notranslate nohighlight">\(O(h^2)\)</span>.</p>
<p>Now if you are not satisfied with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span>.eps</code> plot generated by FreeFem++ and you want to use other graphic facilities, then you must store the solution in a file very much like in <code class="docutils literal highlight highlight-freefem"><span></span>C++</code>.
It will be useless if you don’t save the triangulation as well, consequently you must do</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span>{
    ofstream ff(&quot;phi.txt&quot;);
    ff &lt;&lt; phi[];
}
savemesh(Th,&quot;Th.msh&quot;);
</pre></div>
</div>
<p>For the triangulation the name is important: <strong>the extension determines the format</strong>.</p>
<div class="figure" id="figmembrane">
<img alt="../_images/gnumembrane.png" src="../_images/gnumembrane.png" />
<p class="caption"><span class="caption-number">Fig. 43 </span><span class="caption-text">The 3D version drawn by <code class="docutils literal highlight highlight-freefem"><span></span>gnuplot</code> from a file generated by FreeFem++</span></p>
</div>
<p>Still that may not take you where you want. Here is an interface with gnuplot to produce the <a class="reference internal" href="#figmembrane"><span class="std std-numref">Fig. 43</span></a>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span>//to build a gnuplot data file
{
    ofstream ff(&quot;graph.txt&quot;);
    for (int i = 0; i &lt; Th.nt; i++)
    {
        for (int j = 0; j &lt; 3; j++)
            ff &lt;&lt; Th[i][j].x &lt;&lt; &quot; &quot;&lt;&lt; Th[i][j].y &lt;&lt; &quot; &quot; &lt;&lt; phi[][Vh(i,j)] &lt;&lt; endl;

        ff &lt;&lt; Th[i][0].x &lt;&lt; &quot; &quot; &lt;&lt; Th[i][0].y &lt;&lt; &quot; &quot; &lt;&lt; phi[][Vh(i,0)] &lt;&lt; &quot;\n\n\n&quot;
    }
}
</pre></div>
</div>
<p>We use the finite element numbering, where <code class="docutils literal highlight highlight-freefem"><span></span>Wh(i,j)</code> is the global index of <span class="math notranslate nohighlight">\(j^{Th}\)</span> degrees of freedom of triangle number <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Then open <code class="docutils literal highlight highlight-freefem"><span></span>gnuplot</code> and do:</p>
<div class="highlight-gnuplot notranslate"><div class="highlight"><pre><span></span><span class="k">set</span> <span class="nb">palette</span> <span class="n">rgbformulae</span> <span class="mi">30</span><span class="o">,</span><span class="mi">31</span><span class="o">,</span><span class="mi">32</span>
<span class="k">splot</span> <span class="s">&quot;graph.txt&quot;</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">pal</span>
</pre></div>
</div>
<p>This works with <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P2</code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P1</code>, but not with <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P1nc</code> because the 3 first degrees of freedom of <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P2</code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P2</code> are on vertices and not with <code class="code freefem docutils literal highlight highlight-freefem"><span></span>P1nc</code>.</p>
</div>


        </div>
        <div class="side-doc-outline">
            <div class="side-doc-outline--content"> 
            </div>
        </div>

      <div class="clearer"></div>
    </div><div class="pagenation">
     <a id="button-prev" href="equationsClassification.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="P">
         <i class="pagenation-arrow-L material-icons">arrow_back</i>
         <div class="pagenation-text">
            <span class="pagenation-direction">Previous</span>
            <div>Classification of partial differential equations</div>
         </div>
     </a>
     <a id="button-next" href="heatExchanger.html" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--colored" role="botton" accesskey="N">
        <i class="pagenation-arrow-R material-icons">arrow_forward</i>
        <div class="pagenation-text">
            <span class="pagenation-direction">Next</span>
            <div>Heat Exchanger</div>
        </div>
     </a>
  </div>
        <footer class="mdl-mini-footer">
    <div class="mdl-mini-footer__left-section">
      <div class="mdl-logo">FreeFem++</div>
      <div>
        
        <p class="caption"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a></li>
</ul>

      </div>
    </div>

    <div class="mdl-mini-footer__right-section">
        <div>&copy; Copyright 2018, FreeFem++.</div>
      <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.3 using <a href="https://github.com/myyasuda/sphinx_materialdesign_theme">sphinx_materialdesign_theme</a>.</div>
    </div>
</footer>
        </main>
    </div>
  </body>
</html>
<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Pure Convection : The Rotating Hill</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">Pure Convection : The Rotating Hill</a><ul>
<li><a class="reference internal" href="#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li><a class="reference internal" href="#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
<li><a class="reference internal" href="#finite-volume-methods-can-also-be-handled-with-freefem-but-it-requires-programming"><strong>Finite Volume Methods</strong> can also be handled with FreeFem++ but it requires programming.</a></li>
</ul>
</li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="pure-convection-the-rotating-hill">
<h1>Pure Convection : The Rotating Hill<a class="headerlink" href="#pure-convection-the-rotating-hill" title="Permalink to this headline">¶</a></h1>
<p><strong>Summary:</strong>
<em>Here we will present two methods for upwinding for the simplest convection problem.
We will learn about Characteristics-Galerkin and Discontinuous-Galerkin Finite Element Methods.</em></p>
<p>Let <span class="math notranslate nohighlight">\(\Omega\)</span> be the unit disk centered at <span class="math notranslate nohighlight">\((0,0)\)</span>; consider the rotation vector field</p>
<div class="math notranslate nohighlight">
\[\mathbf{u} = [u1,u2], \qquad u_1 = y,\quad u_2 = -x\]</div>
<p>Pure convection by <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \partial_t c + \mathbf{u}.\nabla c &amp;= 0 &amp;\hbox{ in } \Omega\times(0,T)\\
    c (t=0) &amp;= c ^0 &amp;\hbox{ in } \Omega.
\end{array}\end{split}\]</div>
<p>The exact solution <span class="math notranslate nohighlight">\(c(x_t,t)\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> en point <span class="math notranslate nohighlight">\(x_t\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[c(x_t,t)=c^0(x,0)\]</div>
<p>where <span class="math notranslate nohighlight">\(x_t\)</span> is the particle path in the flow starting at point <span class="math notranslate nohighlight">\(x\)</span> at time <span class="math notranslate nohighlight">\(0\)</span>. So <span class="math notranslate nohighlight">\(x_t\)</span> are solutions of</p>
<div class="math notranslate nohighlight">
\[\dot{x_t} = u(x_t), \quad\ x_{t=0} =x , \quad\mbox{where}\quad \dot{x_t} = \frac{\text{d} ( t \mapsto x_t)}{\text{d} t}\]</div>
<p>The ODE are reversible and we want the solution at point <span class="math notranslate nohighlight">\(x\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> ( not at point <span class="math notranslate nohighlight">\(x_t\)</span>) the initial point is <span class="math notranslate nohighlight">\(x_{-t}\)</span>, and we have</p>
<div class="math notranslate nohighlight">
\[c(x,t)=c^0(x_{-t},0)\]</div>
<p>The game consists in solving the equation until <span class="math notranslate nohighlight">\(T=2\pi\)</span>, that is for a full revolution and to compare the final solution with the initial one; they should be equal.</p>
<div class="section" id="solution-by-a-characteristics-galerkin-method">
<h2>Solution by a Characteristics-Galerkin Method<a class="headerlink" href="#solution-by-a-characteristics-galerkin-method" title="Permalink to this headline">¶</a></h2>
<p>In FreeFem++ there is an operator called <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">convect</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span></code> which compute <span class="math notranslate nohighlight">\(c\circ X\)</span> with <span class="math notranslate nohighlight">\(X\)</span> is the convect field defined by <span class="math notranslate nohighlight">\(X(x)= x_{dt}\)</span> and where <span class="math notranslate nohighlight">\(x_\tau\)</span> is particule path in the steady state velocity field <span class="math notranslate nohighlight">\(\mathbf{u}=[u1,u2]\)</span> starting at point <span class="math notranslate nohighlight">\(x\)</span> at time <span class="math notranslate nohighlight">\(\tau=0\)</span>, so <span class="math notranslate nohighlight">\(x_\tau\)</span> is solution of the following ODE:</p>
<div class="math notranslate nohighlight">
\[\dot{x}_\tau = u(x_\tau), \mathbf{x}_{\tau=0}=x.\]</div>
<p>When <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is piecewise constant; this is possible because <span class="math notranslate nohighlight">\(x_\tau\)</span> is then a polygonal curve which can be computed exactly and the solution exists always when <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is divergence free; convect returns <span class="math notranslate nohighlight">\(c(x_{df})=C\circ X\)</span>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.17</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span> <span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Uh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Uh</span> <span class="n">cold</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="p">((</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span>
<span class="n">Uh</span> <span class="n">u1</span> <span class="o">=</span> <span class="kr">y</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="o">-</span><span class="kr">x</span><span class="p">;</span>

<span class="c1">// Time loop</span>
<span class="kt">real</span> <span class="kp">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="kr">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="kr">m</span> <span class="o">&lt;</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">/</span><span class="n">dt</span><span class="p">;</span> <span class="kr">m</span><span class="o">++</span><span class="p">){</span>
    <span class="kp">t</span> <span class="o">+=</span> <span class="n">dt</span><span class="p">;</span>
    <span class="n">cold</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nf">convect</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="o">-</span><span class="n">dt</span><span class="p">,</span> <span class="n">cold</span><span class="p">);</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot; t=&quot;</span><span class="o">+</span><span class="kp">t</span> <span class="o">+</span><span class="s">&quot;, min=&quot;</span><span class="o">+</span><span class="n">c</span><span class="p">[].</span><span class="kr">min</span><span class="o">+</span><span class="s">&quot;, max=&quot;</span><span class="o">+</span><span class="n">c</span><span class="p">[].</span><span class="kr">max</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">3D plots can be done by adding the qualifyer <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dim</span><span class="o">=</span><span class="mi">3</span></code> to the plot instruction.</p>
</div>
<p>The method is very powerful but has two limitations:</p>
<ul class="simple">
<li>it is not conservative</li>
<li>it may diverge in rare cases when <span class="math notranslate nohighlight">\(|\mathbf{u}|\)</span> is too small due to quadrature error.</li>
</ul>
</div>
<div class="section" id="solution-by-discontinuous-galerkin-fem">
<h2>Solution by Discontinuous-Galerkin FEM<a class="headerlink" href="#solution-by-discontinuous-galerkin-fem" title="Permalink to this headline">¶</a></h2>
<p>Discontinuous Galerkin methods take advantage of the discontinuities of <span class="math notranslate nohighlight">\(c\)</span> at the edges to build upwinding.
There are may formulations possible.
We shall implement here the so-called dual-<span class="math notranslate nohighlight">\(P_1^{DC}\)</span> formulation (see <a class="reference internal" href="../reference.html#ern2006" id="id1">[ERN2006]</a>):</p>
<div class="math notranslate nohighlight">
\[\int_\Omega(\frac{c^{n+1}-c^n}{\delta t} +u\cdot\nabla c)w
+\int_E(\alpha|n\cdot u|-\frac 12 n\cdot u)[c]w
=\int_{E_\Gamma^-}|n\cdot u| cw~~~\forall w\]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> is the set of inner edges and <span class="math notranslate nohighlight">\(E_\Gamma^-\)</span> is the set of boundary edges where <span class="math notranslate nohighlight">\(u\cdot n&lt;0\)</span> (in our case there is no such edges).
Finally <span class="math notranslate nohighlight">\([c]\)</span> is the jump of <span class="math notranslate nohighlight">\(c\)</span> across an edge with the convention that <span class="math notranslate nohighlight">\(c^+\)</span> refers to the value on the right of the oriented edge.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">al</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span> <span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1dc</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">w</span><span class="p">,</span> <span class="n">ccold</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="kr">y</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="o">-</span><span class="kr">x</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="p">((</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="kr">n</span><span class="p">()</span> <span class="p">(</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="o">*</span><span class="n">v2</span><span class="p">)</span> <span class="c1">// Macro without parameter</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="n">Adual</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span><span class="n">cc</span><span class="o">/</span><span class="n">dt</span><span class="o">+</span><span class="p">(</span><span class="n">v1</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">v2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">cc</span><span class="p">)))</span><span class="o">*</span><span class="n">w</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">nTonEdge</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="p">(</span><span class="n">al</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">-</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nf">jump</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">ccold</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="n">dt</span>
    <span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Time iterations</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">real</span> <span class="kp">t</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="kp">t</span> <span class="o">&lt;</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="kp">t</span> <span class="o">+=</span> <span class="n">dt</span><span class="p">){</span>
    <span class="n">ccold</span> <span class="o">=</span> <span class="n">cc</span><span class="p">;</span>
    <span class="n">Adual</span><span class="p">;</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;t=&quot;</span><span class="o">+</span><span class="kp">t</span><span class="o">+</span><span class="s">&quot;, min=&quot;</span><span class="o">+</span><span class="n">cc</span><span class="p">[].</span><span class="kr">min</span><span class="o">+</span><span class="s">&quot;, max=&quot;</span><span class="o">+</span> <span class="n">cc</span><span class="p">[].</span><span class="kr">max</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Plot</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">viso</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">];</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;ConvectCG.eps&quot;</span><span class="p">,</span> <span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;ConvectDG.eps&quot;</span><span class="p">,</span> <span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>New keywords: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">intalledges</span></code> to integrate on all edges of all triangles</p>
<div class="last math notranslate nohighlight">
\[\mathtt{intalledges}(\mathtt{Th}) \equiv \sum_{T\in\mathtt{Th}}\int_{\partial T }\]</div>
</div>
<p>(so all internal edges are see two times), nTonEdge which is one if the triangle has a boundary edge and two otherwise, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">jump</span></code> to implement <span class="math notranslate nohighlight">\([c]\)</span>.</p>
<p>Results of both methods are shown on <a class="reference internal" href="#figrotatingcg"><span class="std std-numref">Fig. 92</span></a> nad <a class="reference internal" href="#figrotatingdg"><span class="std std-numref">Fig. 93</span></a> with identical levels for the level line; this is done with the plot-modifier viso.</p>
<p>Notice also the macro where the parameter <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is not used (but the syntax needs one) and which ends with a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="c1">//</span></code>; it simply replaces the name <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span></code> by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">(</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">*</span><span class="n">v1</span><span class="o">+</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="o">*</span><span class="n">v2</span><span class="p">)</span></code>.
As easily guessed <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="p">,</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span></code> is the normal to the edge.</p>
<div class="inline2 figure" id="figrotatingcg">
<img alt="../_images/convectCG.png" src="../_images/convectCG.png" />
<p class="caption"><span class="caption-number">Fig. 92 </span><span class="caption-text">The rotating hill after one revolution with Characteristics-Galerkin</span></p>
</div>
<div class="inline2 figure" id="figrotatingdg">
<img alt="../_images/convectDG.png" src="../_images/convectDG.png" />
<p class="caption"><span class="caption-number">Fig. 93 </span><span class="caption-text">The rotating hill after one revolution with Discontinuous <span class="math notranslate nohighlight">\(P_1\)</span> Galerkin</span></p>
</div>
<p>Now if you think that DG is too slow try this:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">al</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span> <span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1dc</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">w</span><span class="p">,</span> <span class="n">ccold</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="kr">y</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="o">-</span><span class="kr">x</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="p">((</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span>
<span class="n">Vh</span> <span class="n">rhs</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="kr">n</span><span class="p">()</span> <span class="p">(</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="o">*</span><span class="n">v2</span><span class="p">)</span> <span class="c1">// Macro without parameter</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="kp">t</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>

<span class="kt">varf</span> <span class="nf">vAdual</span> <span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span><span class="n">cc</span><span class="o">/</span><span class="n">dt</span><span class="o">+</span><span class="p">(</span><span class="n">v1</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">v2</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">cc</span><span class="p">)))</span><span class="o">*</span><span class="n">w</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">intalledges</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">nTonEdge</span><span class="p">)</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="p">(</span><span class="n">al</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span><span class="o">-</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nf">jump</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="p">;</span>

<span class="kt">varf</span> <span class="nf">vBdual</span> <span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="o">=</span> <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">ccold</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="n">dt</span>
    <span class="p">)</span>
    <span class="p">;</span>

<span class="kt">matrix</span> <span class="n">AA</span> <span class="o">=</span> <span class="n">vAdual</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="n">BB</span> <span class="o">=</span> <span class="n">vBdual</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>
<span class="nf">set</span> <span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="kp">t</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>

<span class="c1">// Time iterations</span>
<span class="k">for</span> <span class="p">(</span><span class="kp">t</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="kp">t</span> <span class="o">&lt;</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="kp">t</span> <span class="o">+=</span> <span class="n">dt</span><span class="p">){</span>
    <span class="n">ccold</span> <span class="o">=</span> <span class="n">cc</span><span class="p">;</span>
    <span class="n">rhs</span><span class="p">[]</span> <span class="o">=</span> <span class="n">BB</span> <span class="o">*</span> <span class="n">ccold</span><span class="p">[];</span>
    <span class="n">cc</span><span class="p">[]</span> <span class="o">=</span> <span class="n">AA</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">[];</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;t=&quot;</span><span class="o">+</span><span class="kp">t</span><span class="o">+</span><span class="s">&quot;, min=&quot;</span><span class="o">+</span><span class="n">cc</span><span class="p">[].</span><span class="kr">min</span><span class="o">+</span><span class="s">&quot;, max=&quot;</span><span class="o">+</span> <span class="n">cc</span><span class="p">[].</span><span class="kr">max</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice the new keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">set</span></code> to specify a solver in this framework; the modifier <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span></code> is used to tell the solver that the matrix has not changed (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span><span class="o">=</span><span class="kr">true</span></code>), and the name parameter are the same that in problem definition (see <a class="reference internal" href="../documentation/finiteElement.html#problemdefinition"><span class="std std-ref">Problem</span></a>)</p>
</div>
<div class="section" id="finite-volume-methods-can-also-be-handled-with-freefem-but-it-requires-programming">
<h2><strong>Finite Volume Methods</strong> can also be handled with FreeFem++ but it requires programming.<a class="headerlink" href="#finite-volume-methods-can-also-be-handled-with-freefem-but-it-requires-programming" title="Permalink to this headline">¶</a></h2>
<p>For instance the <span class="math notranslate nohighlight">\(P_0-P_1\)</span> Finite Volume Method of Dervieux <em>et al</em> associates to each <span class="math notranslate nohighlight">\(P_0\)</span> function <span class="math notranslate nohighlight">\(c^1\)</span> a <span class="math notranslate nohighlight">\(P_0\)</span> function <span class="math notranslate nohighlight">\(c^0\)</span> with constant value around each vertex <span class="math notranslate nohighlight">\(q^i\)</span> equal to <span class="math notranslate nohighlight">\(c^1(q^i)\)</span> on the cell <span class="math notranslate nohighlight">\(\sigma_i\)</span> made by all the medians of all triangles having <span class="math notranslate nohighlight">\(q^i\)</span> as vertex.</p>
<p>Then upwinding is done by taking left or right values at the median:</p>
<div class="math notranslate nohighlight">
\[\int_{\sigma_i}\frac 1{\delta t}({c^1}^{n+1}-{c^1}^n) + \int_{\partial\sigma_i}u\cdot n c^-=0, \forall i\]</div>
<p>It can be programmed as :</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;mat_dervieux&quot;</span><span class="p">;</span> <span class="c1">//External module in C++ must be loaded</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.025</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">vh</span><span class="p">,</span> <span class="n">vold</span><span class="p">,</span> <span class="n">u1</span><span class="o">=</span><span class="kr">y</span><span class="p">,</span> <span class="n">u2</span><span class="o">=-</span><span class="kr">x</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">v</span><span class="o">=</span><span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="p">((</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)),</span> <span class="n">vWall</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rhs</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="c1">//qf1pTlump means mass lumping is used</span>
<span class="kt">problem</span> <span class="nf">FVM</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">vh</span><span class="p">)</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="kp">qft</span><span class="o">=</span><span class="kr">qf1pTlump</span><span class="p">)(</span><span class="n">v</span><span class="o">*</span><span class="n">vh</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="kp">qft</span><span class="o">=</span><span class="kr">qf1pTlump</span><span class="p">)(</span><span class="n">vold</span><span class="o">*</span><span class="n">vh</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="o">+</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">a</span><span class="p">)(((</span><span class="n">u1</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">+</span><span class="n">u2</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u1</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">+</span><span class="n">u2</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="n">vWall</span><span class="o">*</span><span class="n">vh</span><span class="p">)</span>
<span class="o">+</span> <span class="n">rhs</span><span class="p">[]</span> <span class="p">;</span>

<span class="kt">matrix</span> <span class="kp">A</span><span class="p">;</span>
<span class="n">MatUpWind0</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">vold</span><span class="p">,</span> <span class="p">[</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">]);</span>

<span class="c1">// Time loop</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="kp">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="kp">t</span> <span class="o">&lt;</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span> <span class="p">;</span> <span class="kp">t</span> <span class="o">+=</span> <span class="n">dt</span><span class="p">){</span>
    <span class="n">vold</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">rhs</span><span class="p">[]</span> <span class="o">=</span> <span class="kp">A</span> <span class="o">*</span> <span class="n">vold</span><span class="p">[];</span>
    <span class="n">FVM</span><span class="p">;</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>the “mass lumping” parameter forces a quadrature formula with Gauss points at the vertices so as to make the mass matrix diagonal; the linear system solved by a conjugate gradient method for instance will then converge in one or two iterations.</p>
<p>The right hand side <code class="docutils literal highlight highlight-default"><span></span><span class="n">rhs</span></code> is computed by an external C++ function <code class="docutils literal highlight highlight-default"><span></span><span class="n">MatUpWind0</span><span class="p">(</span><span class="o">...</span><span class="p">)</span></code> which is programmed as :</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Computes matrix a on a triangle for the Dervieux FVM</span>
<span class="kt">int</span> <span class="nf">fvmP1P0</span><span class="p">(</span><span class="kt">double</span> <span class="n">q</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="c1">// the 3 vertices of a triangle T</span>
    <span class="kt">double</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="c1">// convection velocity on T</span>
    <span class="kt">double</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="c1">// the P1 function on T</span>
    <span class="kt">double</span> <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span><span class="c1">// output matrix</span>
    <span class="kt">double</span> <span class="n">where</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="c1">// where&gt;0 means we&#39;re on the boundary</span>
<span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">ip</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">,</span> <span class="n">ipp</span> <span class="o">=</span> <span class="p">(</span><span class="n">ip</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">unL</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">q</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">ipp</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="p">[</span><span class="n">ipp</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">6.</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">unL</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">unL</span><span class="p">;</span>
            <span class="n">a</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span><span class="n">unL</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">ip</span><span class="p">]</span> <span class="o">+=</span> <span class="n">unL</span><span class="p">;</span>
            <span class="n">a</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="n">ip</span><span class="p">]</span> <span class="o">-=</span><span class="n">unL</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">where</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">where</span><span class="p">[</span><span class="n">ip</span><span class="p">]){</span> <span class="c1">// this is a boundary edge</span>
            <span class="n">unL</span> <span class="o">=</span> <span class="p">((</span><span class="n">q</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">unL</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">unL</span><span class="p">;</span>
                <span class="n">a</span><span class="p">[</span><span class="n">ip</span><span class="p">][</span><span class="n">ip</span><span class="p">]</span> <span class="o">+=</span> <span class="n">unL</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It must be inserted into a larger .cpp file, shown in Appendix A, which is the load module linked to FreeFem++.</p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Plotting in Matlab and Octave</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">Plotting in Matlab and Octave</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#d-problem">2D Problem</a></li>
<li><a class="reference internal" href="#exporting-data">Exporting Data</a></li>
<li><a class="reference internal" href="#importing-data">Importing Data</a></li>
<li><a class="reference internal" href="#d-plot-examples">2D Plot Examples</a></li>
<li><a class="reference internal" href="#id1">3D Plot Examples</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="plotting-in-matlab-and-octave">
<span id="tutorialmatlaboctaveplot"></span><h1>Plotting in Matlab and Octave<a class="headerlink" href="#plotting-in-matlab-and-octave" title="Permalink to this headline">¶</a></h1>
<p>This chapter is about plotting FreeFem++ simulation results with <a class="reference external" href="https://www.mathworks.com/">Matlab©</a> and <a class="reference external" href="https://www.gnu.org/software/octave/">Octave</a>.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In order to create a plot of FreeFem++ simulation results in Matlab / Octave two steps are necessary:</p>
<ul class="simple">
<li>The mesh and the FE-space functions must be exported to text files</li>
<li>The text files have to be imported into Matlab / Octave and plotted with the <a class="reference external" href="https://github.com/samplemaker/freefem_matlab_octave_plot">ffmatlib commands</a></li>
</ul>
<p>Both steps are explained in more detail below using the example of a stripline capacitor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To be able to call <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffmatlib</span></code> commands the path name of the <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffmatlib</span></code> must be added to the search path with the command <code class="code matlab docutils literal highlight highlight-matlab"><span></span><span class="n">addpath</span><span class="p">(</span><span class="s">&#39;Path to ffmatlib&#39;</span><span class="p">)</span></code>.</p>
</div>
</div>
<div class="section" id="d-problem">
<h2>2D Problem<a class="headerlink" href="#d-problem" title="Permalink to this headline">¶</a></h2>
<p>To create some example simulation data consider the problem of a stripline capacitor which is also shown in <a class="reference internal" href="#figmatlabboundaryplot"><span class="std std-numref">Fig. 127</span></a>.
On the two boundaries (the electrodes) <span class="math notranslate nohighlight">\(C_{A}\)</span>, <span class="math notranslate nohighlight">\(C_{K}\)</span> a dirichlet condition and on the enclosure <span class="math notranslate nohighlight">\(C_{B}\)</span> a Neumann condition is set.
The electrostatic potential <span class="math notranslate nohighlight">\(u\)</span> between the two electrodes is given by the Laplace equation:</p>
<div class="math notranslate nohighlight">
\[\Delta u(x,y) = 0\]</div>
<p>and the electrostatic field is calculated by</p>
<div class="math notranslate nohighlight">
\[\mathbf{E} = -\nabla u\]</div>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">CA</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">CK</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">CB</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">w2</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">d2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>

<span class="kt">border</span> <span class="nf">bottomA</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">w2</span><span class="p">,</span><span class="n">w2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">d2</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CA</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">rightA</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">d2</span><span class="p">,</span><span class="n">d2</span><span class="o">+</span><span class="n">h</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="n">w2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CA</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">topA</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">w2</span><span class="p">,</span><span class="o">-</span><span class="n">w2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">d2</span><span class="o">+</span><span class="n">h</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CA</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">leftA</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">d2</span><span class="o">+</span><span class="n">h</span><span class="p">,</span><span class="n">d2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=-</span><span class="n">w2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CA</span><span class="p">;};</span>

<span class="kt">border</span> <span class="nf">bottomK</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">w2</span><span class="p">,</span><span class="n">w2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">d2</span><span class="o">-</span><span class="n">h</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CK</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">rightK</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">d2</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="o">-</span><span class="n">d2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="n">w2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CK</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">topK</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">w2</span><span class="p">,</span><span class="o">-</span><span class="n">w2</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">d2</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CK</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">leftK</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="n">d2</span><span class="p">,</span><span class="o">-</span><span class="n">d2</span><span class="o">-</span><span class="n">h</span><span class="p">){</span> <span class="kr">x</span><span class="o">=-</span><span class="n">w2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">CK</span><span class="p">;};</span>

<span class="kt">border</span> <span class="nf">enclosure</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="n">CB</span><span class="p">;}</span>

<span class="kt">int</span> <span class="kr">n</span><span class="o">=</span><span class="mi">15</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">enclosure</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span>
             <span class="n">bottomA</span><span class="p">(</span><span class="o">-</span><span class="n">w2</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">topA</span><span class="p">(</span><span class="o">-</span><span class="n">w2</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">rightA</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">leftA</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span>
             <span class="n">bottomK</span><span class="p">(</span><span class="o">-</span><span class="n">w2</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">topK</span><span class="p">(</span><span class="o">-</span><span class="n">w2</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">rightK</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span><span class="o">+</span><span class="n">leftK</span><span class="p">(</span><span class="o">-</span><span class="n">h</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>

<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span>

<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">u0</span><span class="o">=</span><span class="mf">2.0</span><span class="p">;</span>

<span class="kt">problem</span> <span class="nf">Laplace</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">)</span> <span class="o">=</span>
          <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">CA</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="n">u0</span><span class="p">)</span><span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="n">CK</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="kt">real</span> <span class="n">error</span><span class="o">=</span><span class="mf">0.01</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
   <span class="n">Laplace</span><span class="p">;</span>
   <span class="n">Th</span><span class="o">=</span><span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="kp">err</span><span class="o">=</span><span class="n">error</span><span class="p">);</span>
   <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="o">/</span><span class="mf">2.0</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Laplace</span><span class="p">;</span>

<span class="n">Vh</span> <span class="n">Ex</span><span class="p">,</span> <span class="n">Ey</span><span class="p">;</span>
<span class="n">Ex</span> <span class="o">=</span> <span class="o">-</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="n">Ey</span> <span class="o">=</span> <span class="o">-</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,[</span><span class="n">Ex</span><span class="p">,</span><span class="n">Ey</span><span class="p">],</span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="exporting-data">
<h2>Exporting Data<a class="headerlink" href="#exporting-data" title="Permalink to this headline">¶</a></h2>
<p>To export a FEM mesh FreeFem++ offers the <a class="reference internal" href="../documentation/meshGeneration.html#meshdatastructurereadwrite"><span class="std std-ref">savemesh()</span></a> command.
FE-space functions must be written to text files by for-loops.
The following code section writes the mesh, the potential <span class="math notranslate nohighlight">\(u\)</span> and the 2D vector field <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> of the stripline capacitor example into three different files:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">//Stores the Mesh</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;capacitor.msh&quot;</span><span class="p">);</span>

<span class="c1">//Stores the potential u</span>
<span class="p">{</span>
<span class="kt">ofstream</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;capacitor_potential.txt&quot;</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">u</span><span class="p">[].</span><span class="kr">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
   <span class="kp">file</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">[][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Stores the 2D vector field</span>
<span class="p">{</span>
<span class="kt">ofstream</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;capacitor_field.txt&quot;</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">Ex</span><span class="p">[].</span><span class="kr">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
   <span class="kp">file</span> <span class="o">&lt;&lt;</span> <span class="n">Ex</span><span class="p">[][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Ey</span><span class="p">[][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="importing-data">
<h2>Importing Data<a class="headerlink" href="#importing-data" title="Permalink to this headline">¶</a></h2>
<p>A mesh file as previously written with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="s">&quot;filename.msh&quot;</span><span class="p">)</span></code> command consists of <a class="reference internal" href="../documentation/meshGeneration.html#meshdatastructurereadwrite"><span class="std std-ref">three main sections</span></a>:</p>
<ol class="arabic simple">
<li>The mesh points as nodal coordinates</li>
<li>A list of boundary edges including boundary labels</li>
<li>List of triangles defining the mesh in terms of connectivity</li>
</ol>
<p>A mesh file is loaded to the Matlab / Octave workspace with the following command:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">nv</span><span class="p">,</span><span class="n">nbe</span><span class="p">,</span><span class="n">nt</span><span class="p">,</span><span class="n">labels</span><span class="p">]</span> <span class="p">=</span> <span class="n">ffreadmesh</span><span class="p">(</span><span class="s">&#39;filename.msh&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The three data sections mentioned are stored in the variables <code class="docutils literal highlight highlight-default"><span></span><span class="n">p</span></code>, <code class="docutils literal highlight highlight-default"><span></span><span class="n">b</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="n">t</span></code>. On the other hand the simulation data can be loaded into the Matlab / Octave workspace with the function:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="p">=</span> <span class="n">ffreaddata</span><span class="p">(</span><span class="s">&#39;filename.txt&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Therefore to load the complete simulation result from the capacitor example the following statement sequence must be executed:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%Where to find the ffmatlib commands</span>
<span class="n">addpath</span><span class="p">(</span><span class="s">&#39;ffmatlib&#39;</span><span class="p">);</span>
<span class="c">%Loads the mesh</span>
<span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">nv</span><span class="p">,</span><span class="n">nbe</span><span class="p">,</span><span class="n">nt</span><span class="p">,</span><span class="n">labels</span><span class="p">]=</span><span class="n">ffreadmesh</span><span class="p">(</span><span class="s">&#39;capacitor.msh&#39;</span><span class="p">);</span>
<span class="c">%Loads scalar data</span>
<span class="p">[</span><span class="n">u</span><span class="p">]=</span><span class="n">ffreaddata</span><span class="p">(</span><span class="s">&#39;capacitor_potential.txt&#39;</span><span class="p">);</span>
<span class="c">%Loads vector field data</span>
<span class="p">[</span><span class="n">Ex</span><span class="p">,</span><span class="n">Ey</span><span class="p">]=</span><span class="n">ffreaddata</span><span class="p">(</span><span class="s">&#39;capacitor_field.txt&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="d-plot-examples">
<h2>2D Plot Examples<a class="headerlink" href="#d-plot-examples" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal highlight highlight-default"><span></span><span class="n">ffpdeplot</span><span class="p">()</span></code> is a plot solution for creating patch, contour, quiver, border, and mesh plots of 2D geometries.
The basic syntax is:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">handles</span><span class="p">,</span><span class="n">varargout</span><span class="p">]</span> <span class="p">=</span> <span class="n">ffpdeplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal highlight highlight-default"><span></span><span class="n">varargin</span></code> specifies parameter name / value pairs to control the plot behaviour.
A table showing all options can be found in the <a class="reference external" href="https://github.com/samplemaker/freefem_matlab_octave_plot">ffmatlib documentation</a>.</p>
<ul class="simple">
<li>Plot of the boundary and the mesh:</li>
</ul>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ffpdeplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;Mesh&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;Boundary&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure" id="figmatlabboundaryplot">
<img alt="../_images/capacitor_boundary_mesh_500x400.png" src="../_images/capacitor_boundary_mesh_500x400.png" />
<p class="caption"><span class="caption-number">Fig. 127 </span><span class="caption-text">Boundary and Mesh</span></p>
</div>
<ul class="simple">
<li>Patch plot (2D map or density plot) including mesh and boundary:</li>
</ul>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ffpdeplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;XYData&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="s">&#39;Mesh&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;Boundary&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="c">...</span>
          <span class="s">&#39;XLim&#39;</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">],</span><span class="s">&#39;YLim&#39;</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
</pre></div>
</div>
<div class="figure" id="figmatlabpatchplot">
<img alt="../_images/capacitor_patch_500x400.png" src="../_images/capacitor_patch_500x400.png" />
<p class="caption"><span class="caption-number">Fig. 128 </span><span class="caption-text">Patch Plot with Mesh</span></p>
</div>
<ul class="simple">
<li>3D surf plot:</li>
</ul>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ffpdeplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;XYData&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="s">&#39;ZStyle&#39;</span><span class="p">,</span><span class="s">&#39;continuous&#39;</span><span class="p">,</span><span class="s">&#39;Mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">);</span>
<span class="n">lighting</span> <span class="n">gouraud</span><span class="p">;</span>
<span class="n">view</span><span class="p">([</span><span class="o">-</span><span class="mi">47</span><span class="p">,</span><span class="mi">24</span><span class="p">]);</span>
<span class="n">camlight</span><span class="p">(</span><span class="s">&#39;headlight&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure" id="figmatlabsurf">
<img alt="../_images/capacitor_surf_500x400.png" src="../_images/capacitor_surf_500x400.png" />
<p class="caption"><span class="caption-number">Fig. 129 </span><span class="caption-text">3D Surf Plot</span></p>
</div>
<ul class="simple">
<li>Contour (isovalue) and quiver (vector field) plot:</li>
</ul>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ffpdeplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;XYData&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="s">&#39;XYStyle&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span><span class="s">&#39;Mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span><span class="s">&#39;Boundary&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="c">...</span>
          <span class="s">&#39;Contour&#39;</span><span class="p">,</span><span class="s">&#39;on&#39;</span><span class="p">,</span><span class="s">&#39;CStyle&#39;</span><span class="p">,</span><span class="s">&#39;monochrome&#39;</span><span class="p">,</span><span class="s">&#39;CColor&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="c">...</span>
          <span class="s">&#39;CGridParam&#39;</span><span class="p">,[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span><span class="s">&#39;FlowData&#39;</span><span class="p">,[</span><span class="n">Ex</span><span class="p">,</span><span class="n">Ey</span><span class="p">],</span><span class="s">&#39;FGridParam&#39;</span><span class="p">,[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="c">...</span>
          <span class="s">&#39;ColorBar&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span><span class="s">&#39;XLim&#39;</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">],</span><span class="s">&#39;YLim&#39;</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
</pre></div>
</div>
<div class="figure" id="figmatlabcontour">
<img alt="../_images/capacitor_contour_quiver_500x400.png" src="../_images/capacitor_contour_quiver_500x400.png" />
<p class="caption"><span class="caption-number">Fig. 130 </span><span class="caption-text">Contour and Quiver Plot</span></p>
</div>
<p><strong>Download run through example:</strong></p>
<p><a class="reference download internal" download="" href="../_downloads/42dfd60e53c1fdac93c7b2b33e3f5479/matlab_octave_2d_examples.m"><tt class="xref download docutils literal">Matlab / Octave file</tt></a></p>
<p><a class="reference download internal" download="" href="../_downloads/c09ce216d661d60de2c2e027911ff64f/matlab_octave_2d_examples.edp"><tt class="xref download docutils literal">FreeFem++ script</tt></a></p>
</div>
<div class="section" id="id1">
<h2>3D Plot Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>A 3D plot command <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffpdeplot3D</span><span class="p">()</span></code> is under development.
Note: The interface is not yet frozen and can still change.</p>
<p>The following example shows a slicing feature on a three-dimensional parallel plate capacitor.</p>
<div class="figure" id="figmatlabslice">
<img alt="../_images/capacitor3d_slice_500x400.png" src="../_images/capacitor3d_slice_500x400.png" />
<p class="caption"><span class="caption-number">Fig. 131 </span><span class="caption-text">Slice on a 3D Parall Plate Capacitor</span></p>
</div>
<p><strong>Download run through example:</strong></p>
<p><a class="reference download internal" download="" href="../_downloads/820a0cd290684b676735e607771a9943/matlab_octave_3d_examples.m"><tt class="xref download docutils literal">Matlab / Octave file</tt></a></p>
<p><a class="reference download internal" download="" href="../_downloads/2aaa371699bcfaeae812543dc1e8257d/matlab_octave_3d_examples.edp"><tt class="xref download docutils literal">FreeFem++ script</tt></a></p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.gnu.org/software/octave/">Octave</a></li>
<li><a class="reference external" href="https://www.mathworks.com/">Matlab</a></li>
<li><a class="reference external" href="https://github.com/samplemaker/freefem_matlab_octave_plot">ffmatlib</a></li>
</ul>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>A Flow with Shocks</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">A Flow with Shocks</a></li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="a-flow-with-shocks">
<h1>A Flow with Shocks<a class="headerlink" href="#a-flow-with-shocks" title="Permalink to this headline">¶</a></h1>
<p>Compressible Euler equations should be discretized with Finite Volumes or FEM with flux up-winding scheme but these are not implemented in <strong>FreeFem++</strong>.
Nevertheless acceptable results can be obtained with the method of characteristics provided that the mean values <span class="math notranslate nohighlight">\(\displaystyle \bar f=\frac12\left(f^++f^-\right)\)</span> are used at shocks in the scheme, and finally mesh adaptation.</p>
<div class="math notranslate nohighlight" id="equation-euler">
<span class="eqno">(43)<a class="headerlink" href="#equation-euler" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{rcl}
    \partial_t\rho+\bar u\nabla\rho + \bar\rho\nabla\cdot u &amp;=&amp; 0\nonumber\\
    \bar\rho( \partial_t u+\frac{\overline{\rho u}}{\bar\rho}\nabla u +\nabla p &amp;=&amp; 0\nonumber\\
    \partial_t p + \bar u\nabla p +(\gamma-1)\bar p\nabla\cdot u &amp;=&amp; 0\\
\end{array}\end{split}\]</div>
<p>One possibility is to couple <span class="math notranslate nohighlight">\(u,p\)</span> and then update <span class="math notranslate nohighlight">\(\rho\)</span>, i.e.:</p>
<div class="math notranslate nohighlight" id="equation-eulalgo">
<span class="eqno">(44)<a class="headerlink" href="#equation-eulalgo" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{rcl}
    \frac 1{(\gamma-1)\delta t\bar p^m} (p^{m+1}-p^m \circ X^m) + \nabla\cdot u^{m+1} &amp;=&amp; 0\nonumber\\
    \frac{\bar\rho^m}{\delta t}(u^{m+1}-u^m \circ {\tilde X}^m ) +\nabla p^{m+1} &amp;=&amp; 0\nonumber\\
    \rho^{m+1} = \rho^m \circ X^m + \frac{\bar\rho^m}{(\gamma-1)\bar p^m}(p^{m+1} &amp;-&amp; p^m \circ X^m)
\end{array}\end{split}\]</div>
<p>A numerical result is given on <a class="reference internal" href="#figflowmach"><span class="std std-numref">Fig. 117</span></a> and the <strong>FreeFem++</strong> script is</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kr">verbosity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">anew</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="kr">m</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="kt">real</span> <span class="nf">y0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">rr</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">u0</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">err0</span> <span class="o">=</span> <span class="mf">0.00625</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">pena</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">ccc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">ddd</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">aaa1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x0</span><span class="o">-</span><span class="n">rr</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">cercle</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="kr">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="n">rr</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">y0</span><span class="o">+</span><span class="n">rr</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">border</span> <span class="nf">aaa2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="n">rr</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">bbb</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>

 <span class="kt">mesh</span> <span class="n">Th</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="n">anew</span><span class="p">)</span>
   <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span> <span class="p">(</span><span class="n">ccc</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">ddd</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">aaa1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">cercle</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">aaa2</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">bbb</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">));</span>
<span class="k">else</span>
   <span class="n">Th</span> <span class="o">=</span> <span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;Th_circle.mesh&quot;</span><span class="p">);</span> <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>

<span class="c1">// fespace</span>
<span class="kt">fespace</span> <span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Wh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
<span class="n">Wh</span> <span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">;</span>
<span class="n">Wh</span> <span class="n">uh</span><span class="p">,</span> <span class="n">vh</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">r</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">r1</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="nf">dn</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">(</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">+</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="c1">//</span>

<span class="c1">// Initialization</span>
<span class="k">if</span><span class="p">(</span><span class="n">anew</span><span class="p">){</span>
   <span class="n">u1</span> <span class="o">=</span> <span class="n">u0</span><span class="p">;</span>
   <span class="n">v1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="n">r1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">{</span>
   <span class="kt">ifstream</span> <span class="n">g</span><span class="p">(</span><span class="s">&quot;u.txt&quot;</span><span class="p">);</span> <span class="n">g</span> <span class="o">&gt;&gt;</span> <span class="n">u1</span><span class="p">[];</span>
   <span class="kt">ifstream</span> <span class="nf">gg</span><span class="p">(</span><span class="s">&quot;v.txt&quot;</span><span class="p">);</span> <span class="n">gg</span> <span class="o">&gt;&gt;</span> <span class="n">v1</span><span class="p">[];</span>
   <span class="kt">ifstream</span> <span class="nf">ggg</span><span class="p">(</span><span class="s">&quot;r.txt&quot;</span><span class="p">);</span> <span class="n">ggg</span> <span class="o">&gt;&gt;</span> <span class="n">r1</span><span class="p">[];</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;eta.eps&quot;</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">err0</span> <span class="o">=</span> <span class="n">err0</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
   <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="n">euler</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="n">vh</span><span class="p">,</span> <span class="n">rh</span><span class="p">)</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">uh</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">vh</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">rh</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span>
      <span class="o">+</span> <span class="p">((</span><span class="nf">dx</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">uh</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="n">vh</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">rh</span><span class="p">)</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">rh</span><span class="p">)</span><span class="o">*</span><span class="n">v</span><span class="p">))</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
      <span class="o">-</span> <span class="p">(</span>
           <span class="n">rh</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">v1</span><span class="p">],</span><span class="o">-</span><span class="n">dt</span><span class="p">,</span><span class="n">r1</span><span class="p">)</span>
         <span class="o">+</span> <span class="n">uh</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">v1</span><span class="p">],</span><span class="o">-</span><span class="n">dt</span><span class="p">,</span><span class="n">u1</span><span class="p">)</span>
         <span class="o">+</span> <span class="n">vh</span><span class="o">*</span><span class="nf">convect</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">v1</span><span class="p">],</span><span class="o">-</span><span class="n">dt</span><span class="p">,</span><span class="n">v1</span><span class="p">)</span>
      <span class="p">)</span><span class="o">/</span><span class="n">dt</span>
   <span class="p">)</span>
   <span class="o">+</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">6</span><span class="p">)(</span>
        <span class="n">rh</span><span class="o">*</span><span class="n">u</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">u0</span><span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="p">;</span>

<span class="c1">// Iterations</span>
<span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">){</span>
   <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">20</span><span class="p">){</span>
      <span class="n">err0</span> <span class="o">=</span> <span class="n">err0</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
      <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
      <span class="n">j</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="c1">// Solve</span>
   <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="n">euler</span><span class="p">;</span>
      <span class="n">u1</span><span class="o">=</span><span class="n">u</span><span class="p">;</span>
      <span class="n">v1</span><span class="o">=</span><span class="n">v</span><span class="p">;</span>
      <span class="n">r1</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;k = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; E = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
      <span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="c1">// Mesh adaptation</span>
   <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span> <span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="kp">nbvx</span><span class="o">=</span><span class="mi">40000</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span><span class="n">err0</span><span class="p">,</span> <span class="kp">abserror</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbjacoby</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="kp">omega</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="kp">ratio</span><span class="o">=</span><span class="mf">1.8</span><span class="p">,</span> <span class="kp">nbsmooth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="kp">splitpbedge</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">maxsubdiv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="kp">rescaling</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
   <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
   <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
   <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>

   <span class="c1">// Save</span>
   <span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="s">&quot;Th_circle.mesh&quot;</span><span class="p">);</span>
   <span class="kt">ofstream</span> <span class="nf">f</span><span class="p">(</span><span class="s">&quot;u.txt&quot;</span><span class="p">);</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">[];</span>
   <span class="kt">ofstream</span> <span class="nf">ff</span><span class="p">(</span><span class="s">&quot;v.txt&quot;</span><span class="p">);</span> <span class="n">ff</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">[];</span>
   <span class="kt">ofstream</span> <span class="nf">fff</span><span class="p">(</span><span class="s">&quot;r.txt&quot;</span><span class="p">);</span> <span class="n">fff</span> <span class="o">&lt;&lt;</span> <span class="n">r</span><span class="p">[];</span>
   <span class="n">r1</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;mach.eps&quot;</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">r1</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="figure" id="figflowmach">
<img alt="../_images/mach_2r.png" src="../_images/mach_2r.png" />
<p class="caption"><span class="caption-number">Fig. 117 </span><span class="caption-text">Pressure for a Euler flow around a disk at Mach 2 computed by <a class="reference internal" href="#equation-eulalgo">(44)</a></span></p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
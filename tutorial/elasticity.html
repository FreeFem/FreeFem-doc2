<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>The System of elasticity</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">The System of elasticity</a></li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="the-system-of-elasticity">
<h1>The System of elasticity<a class="headerlink" href="#the-system-of-elasticity" title="Permalink to this headline">¶</a></h1>
<p><strong>Elasticity</strong></p>
<p>Solid objects deform under the action of applied forces:</p>
<p>a point in the solid, originally at <span class="math notranslate nohighlight">\((x,y,z)\)</span> will come to <span class="math notranslate nohighlight">\((X,Y,Z)\)</span> after some time; the vector <span class="math notranslate nohighlight">\(\mathbf{u}=(u_1,u_2,u_3) = (X-x, Y-y, Z-z)\)</span> is called the displacement.
When the displacement is small and the solid is elastic, Hooke’s law gives a relationship between the stress tensor <span class="math notranslate nohighlight">\(\sigma(u)=(\sigma_{ij}(u) )\)</span> and the strain tensor <span class="math notranslate nohighlight">\(\epsilon(u)=\epsilon_{ij}(u)\)</span></p>
<div class="math notranslate nohighlight">
\[\sigma_{ij}(u) = \lambda \delta_{ij} \nabla.\mathbf{u}+ 2\mu\epsilon_{ij}(u),\]</div>
<p>where the Kronecker symbol <span class="math notranslate nohighlight">\(\delta_{ij} = 1\)</span> if <span class="math notranslate nohighlight">\(i=j\)</span>, <span class="math notranslate nohighlight">\(0\)</span> otherwise, with</p>
<div class="math notranslate nohighlight">
\[\epsilon_{ij}(u) = {1\over 2}({\partial u_i\over\partial x_j} + {\partial u_j\over\partial x_i} ),\]</div>
<p>and where <span class="math notranslate nohighlight">\(\lambda, \mu\)</span> are two constants that describe the mechanical properties of the solid, and are themselves related to the better known constants <span class="math notranslate nohighlight">\(E\)</span>, Young’s modulus, and <span class="math notranslate nohighlight">\(\nu\)</span>, Poisson’s ratio:</p>
<div class="math notranslate nohighlight">
\[\mu = {E\over 2( 1+\nu)}, \quad \lambda = {E\nu\over (1+\nu)(1-2\nu)}.\]</div>
<p><strong>Lamé’s system</strong></p>
<p>Let us consider a beam with axis <span class="math notranslate nohighlight">\(Oz\)</span> and with perpendicular section <span class="math notranslate nohighlight">\(\Omega\)</span>.
The components along <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> of the strain <span class="math notranslate nohighlight">\({\bf u}(x)\)</span> in a section <span class="math notranslate nohighlight">\(\Omega\)</span> subject to forces <span class="math notranslate nohighlight">\({\bf f}\)</span> perpendicular to the axis are governed by:</p>
<div class="math notranslate nohighlight">
\[-\mu \Delta {\bf u} - (\mu+\lambda) \nabla (\nabla .{\bf u})={\bf f}~~\hbox{in}~~\Omega,\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> ,<span class="math notranslate nohighlight">\(\mu\)</span> are the Lamé coefficients introduced above.</p>
<p>Remark, we do not use this equation because the associated variational form does not give the right boundary condition, we simply use:</p>
<div class="math notranslate nohighlight">
\[- div( \sigma ) = \mathbf{f} \quad \mbox{in}~~\Omega\]</div>
<p>where the corresponding variational form is:</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega} \sigma(u) : \epsilon(\mathbf{v})\;dx - \int_{\Omega} \mathbf{v} f \;dx =0;\]</div>
<p>where <span class="math notranslate nohighlight">\(:\)</span> denotes the tensor scalar product, i.e.&nbsp;<span class="math notranslate nohighlight">\(a: b = \sum_{i,j} a_{ij}b_{ij}\)</span>.</p>
<p>So the variational form can be written as :</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega} \lambda \nabla.u \nabla.v + 2 \mu \epsilon(\mathbf{u}):\epsilon(\mathbf{v}) \; dx - \int_{\Omega} \mathbf{v} f \;dx =0;\]</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Consider an elastic plate with the undeformed rectangle shape <span class="math notranslate nohighlight">\([0,20]\times [-1,1]\)</span>.</p>
<p>The body force is the gravity force <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> and the boundary force <span class="math notranslate nohighlight">\(\mathbf{g}\)</span> is zero on lower, upper and right sides.
The left vertical side of the beam is fixed.
The boundary conditions are:</p>
<div class="last math notranslate nohighlight">
\[\begin{split}\begin{array}{rcll}
    \sigma . {\bf n} &amp;= \mathbf{g} &amp;= 0 &amp; \hbox{ on }\Gamma_1, \Gamma_4, \Gamma_3, \\
    {\bf u} &amp;= \mathbf{0} &amp;&amp; \hbox{ on }\Gamma_2
\end{array}\end{split}\]</div>
</div>
<p>Here <span class="math notranslate nohighlight">\({\bf u}=(u,v)\)</span> has two components.</p>
<p>The above two equations are strongly coupled by their mixed derivatives, and thus any iterative solution on each of the components is risky.
One should rather use <strong>FreeFem++</strong>’s system approach and write:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21e5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">;</span>

<span class="kt">real</span> <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">real</span> <span class="n">sqrt2</span><span class="o">=</span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">);</span>
<span class="kt">macro</span> <span class="nf">epsilon</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="n">u2</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u1</span><span class="p">),</span><span class="nf">dy</span><span class="p">(</span><span class="n">u2</span><span class="p">),(</span><span class="nf">dy</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span><span class="o">+</span><span class="nf">dx</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">]</span> <span class="c1">//</span>
<span class="c1">// The sqrt2 is because we want: epsilon(u1,u2)&#39;* epsilon(v1,v2) = epsilon(u): epsilon(v)</span>
<span class="kt">macro</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="p">(</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">+</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">)</span> <span class="c1">//</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="n">mu</span><span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="kt">real</span> <span class="n">lambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>

<span class="kt">solve</span> <span class="nf">lame</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="p">[</span><span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">])</span>
   <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">lambda</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span>
      <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">mu</span> <span class="o">*</span> <span class="p">(</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">uu</span><span class="p">,</span><span class="n">vv</span><span class="p">)</span> <span class="p">)</span>
   <span class="p">)</span>
   <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">f</span><span class="o">*</span><span class="n">vv</span>
   <span class="p">)</span>
   <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="p">;</span>

<span class="c1">// Plot</span>
<span class="kt">real</span> <span class="kp">coef</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;lamevect.eps&quot;</span><span class="p">,</span> <span class="kp">coef</span><span class="o">=</span><span class="kp">coef</span><span class="p">);</span>

<span class="c1">// Move mesh</span>
<span class="kt">mesh</span> <span class="n">th1</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="n">u</span><span class="o">*</span><span class="kp">coef</span><span class="p">,</span> <span class="kr">y</span><span class="o">+</span><span class="n">v</span><span class="o">*</span><span class="kp">coef</span><span class="p">]);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">th1</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;lamedeform.eps&quot;</span><span class="p">);</span>

<span class="c1">// Output</span>
<span class="kt">real</span> <span class="n">dxmin</span> <span class="o">=</span> <span class="n">u</span><span class="p">[].</span><span class="kr">min</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dymin</span> <span class="o">=</span> <span class="n">v</span><span class="p">[].</span><span class="kr">min</span><span class="p">;</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - dep. max x = &quot;</span><span class="o">&lt;&lt;</span> <span class="n">dxmin</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; y=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">dymin</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;   dep. (20, 0) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">v</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The output is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>-- square mesh : nb <span class="nv">vertices</span>  <span class="o">=</span><span class="m">121</span> ,  nb <span class="nv">triangles</span> <span class="o">=</span> <span class="m">200</span> ,  nb boundary edges <span class="m">40</span>
-- Solve :           min -0.00174137  max <span class="m">0</span>.00174105
         min -0.0263154  max <span class="m">1</span>.47016e-29
- dep.  max   <span class="nv">x</span> <span class="o">=</span> -0.00174137 <span class="nv">y</span><span class="o">=</span>-0.0263154
   dep.  <span class="o">(</span><span class="m">20</span>,0<span class="o">)</span>  <span class="o">=</span> -1.8096e-07 -0.0263154
times: compile <span class="m">0</span>.010219s, execution <span class="m">1</span>.5827s
</pre></div>
</div>
<p>Solution of Lamé’s equations for elasticity for a 2D beam deflected by its own weight and clamped by its left vertical side is shown <a class="reference internal" href="#figelasticityvector"><span class="std std-numref">Fig. 94</span></a> and <a class="reference internal" href="#figelasticitydeformation"><span class="std std-numref">Fig. 95</span></a>.
Result are shown with a amplification factor equal to 100.
The size of the arrow is automatically bound, but the color gives the real length.</p>
<div class="figure" id="figelasticityvector">
<img alt="../_images/lame_vector.png" src="../_images/lame_vector.png" />
<p class="caption"><span class="caption-number">Fig. 94 </span><span class="caption-text">Vector</span></p>
</div>
<div class="figure" id="figelasticitydeformation">
<img alt="../_images/lame_deformation.png" src="../_images/lame_deformation.png" />
<p class="caption"><span class="caption-number">Fig. 95 </span><span class="caption-text">Deformation</span></p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
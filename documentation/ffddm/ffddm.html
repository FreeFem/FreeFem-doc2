<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>What is ffddm ?</title>
		<link rel="icon" href="../../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../../_static/nav.json"></script>
		<script src="../../_static/js/nav.js"></script>
		<script src="../../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../../")</script>
			<div class="search">
				<script async src="../../_static/js/lunr.js"></script>
<script async src="../../_static/lunr_index.js"></script>

<script src="../../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">What is ffddm ?</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#minimal-example">Minimal Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="what-is-ffddm">
<h1>What is ffddm ?<a class="headerlink" href="#what-is-ffddm" title="Permalink to this headline">¶</a></h1>
<p>In the acronym <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code>, <code class="docutils literal highlight highlight-default"><span></span><span class="n">ff</span></code> stands for FreeFem++ and <code class="docutils literal highlight highlight-default"><span></span><span class="n">ddm</span></code> for domain decomposition methods.
The idea behind ffddm is to simplify the use of parallel solvers in FreeFem++: distributed direct methods and domain decomposition methods.</p>
<p>Parallelism is an important issue because, since about 2004, the clock speed of cores stagnates at 2-3 GHz.
The increase in performance is almost entirely due to the increase in the number of cores per processor.
All major processor vendors are producing multicore chips and now every machine is a parallel machine.
Waiting for the next generation machine does not guarantee anymore a better performance of a software.
To keep doubling performance parallelism must double.
It implies a huge effort in algorithmic development.</p>
<p>Thanks to <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code>, FreeFem++ users have access to high-level functionalities for specifying and solving their finite element problems in parallel.
The first task handled by <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code> is the data distribution among the processors.
This is done via an overlapping domain decomposition and a related distributed linear algebra.
Then, solving a linear system is possible either via an interface to the parallel <a class="reference external" href="http://mumps.enseeiht.fr/">MUMPS</a> solver or by using domain decomposition methods as preconditioners to the GMRES Krylov method.
The <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code> framework makes it easy to use scalable Schwarz methods enhanced by a coarse space correction built either from a coarse mesh or a <a class="reference external" href="https://link.springer.com/article/10.1007%2Fs00211-013-0576-y">GenEO</a> (Generalized Eigenvalue in the Overlap) coarse space, see also the book <a class="reference external" href="http://bookstore.siam.org/ot144/">An Introduction to Domain Decomposition Methods: algorithms, theory, and parallel implementation</a>.
State-of-the-art three level methods are also implemented in <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code>.</p>
<p>The <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code> framework is entirely written in the FreeFem++ language and the ‘.idp’ scripts can be found <a class="reference external" href="https://github.com/FreeFem/FreeFem-sources/tree/develop/examples%2B%2B-ffddm">here</a>.
It makes it also a very good tool for learning and prototyping domain decomposition methods without compromising efficiency.</p>
<p><code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code> can also act as a wrapper for the <a class="reference external" href="https://github.com/hpddm/hpddm">HPDDM</a> library.
HPDDM is an efficient implementation of various domain decomposition methods and a variety of Krylov subspace algorithms, with advanced block and recycling methods for solving sequences of linear systems with multiple right-hand sides: GMRES and Block GMRES, CG, Block CG, and Breakdown-Free Block CG, GCRO-DR and Block GCRO-DR.
For more details on how to use HPDDM within <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code>, see <a class="reference internal" href="documentation.html#ffddmdocumentationhpddmffddm"><span class="std std-ref">the ffddm documentation</span></a>.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="minimal-example">
<h3>Minimal Example<a class="headerlink" href="#minimal-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="n">dimension</span> <span class="mi">2</span><span class="c1">// EOM            // 2D or 3D</span>
<span class="cp">include</span> <span class="s">&quot;ffddm.idp&quot;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>    <span class="c1">// global mesh</span>
<span class="c1">// Step 1: Decompose the mesh</span>
<span class="n">ffddmbuildDmesh</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="n">Th</span> <span class="p">,</span> <span class="kr">mpiCommWorld</span> <span class="p">)</span>
<span class="c1">// Step 2: Define your finite element</span>
<span class="kt">macro</span> <span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>  <span class="n">u</span> <span class="c1">// EOM</span>
<span class="kt">macro</span> <span class="kp">init</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="n">u</span> <span class="c1">// EOM</span>
<span class="n">ffddmbuildDfespace</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="kr">P</span> <span class="p">,</span> <span class="kt">real</span> <span class="p">,</span> <span class="n">def</span> <span class="p">,</span> <span class="kp">init</span> <span class="p">,</span> <span class="nc">P2</span> <span class="p">)</span>
<span class="c1">// Step 3: Define your problem</span>
<span class="kt">macro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">// EOM</span>
<span class="kt">macro</span> <span class="n">Varf</span><span class="p">(</span><span class="n">varfName</span><span class="p">,</span> <span class="n">meshName</span><span class="p">,</span> <span class="n">VhName</span><span class="p">)</span>
    <span class="kt">varf</span> <span class="n">varfName</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">meshName</span><span class="p">)(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;*</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">meshName</span><span class="p">)(</span><span class="mi">1</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
                       <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>  <span class="c1">// EOM</span>
<span class="n">ffddmsetupOperator</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="kr">P</span> <span class="p">,</span> <span class="n">Varf</span> <span class="p">)</span>
<span class="n">PVhi</span> <span class="n">ui</span><span class="p">,</span> <span class="n">bi</span><span class="p">;</span>
<span class="n">ffddmbuildrhs</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="n">Varf</span> <span class="p">,</span> <span class="n">bi</span><span class="p">[]</span> <span class="p">)</span>
<span class="c1">// Step 4: Define the one level DD preconditioner</span>
<span class="n">ffddmsetupPrecond</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="n">Varf</span> <span class="p">)</span>
<span class="c1">// Step 5: Define the two-level GenEO Coarse Space</span>
<span class="n">ffddmgeneosetup</span><span class="p">(</span> <span class="kr">P</span> <span class="p">,</span> <span class="n">Varf</span> <span class="p">)</span>
<span class="c1">// Step 6: Solve the linear system with GMRES</span>
<span class="n">PVhi</span> <span class="n">x0i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">ui</span><span class="p">[]</span> <span class="o">=</span> <span class="n">PfGMRES</span><span class="p">(</span><span class="n">x0i</span><span class="p">[],</span> <span class="n">bi</span><span class="p">[],</span> <span class="mf">1.e-6</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s">&quot;right&quot;</span><span class="p">);</span>
<span class="n">ffddmplot</span><span class="p">(</span><span class="kr">P</span><span class="p">,</span> <span class="n">ui</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">)</span>
<span class="n">Pwritesummary</span>
</pre></div>
</div>
<p>This example solves a Laplace problem in 2D in parallel with a two-level GenEO domain decomposition method.
To try this example, just copy and paste the script above in a file ‘test.edp’ and run it on 2 cores with</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ff</span><span class="o">-</span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">2</span> <span class="n">test</span><span class="o">.</span><span class="n">edp</span> <span class="o">-</span><span class="n">glut</span> <span class="n">ffglut</span>
</pre></div>
</div>
<p>Explanations are given in:</p>
<table border="1" class="docutils">
<colgroup>
<col width="61%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Content</th>
<th class="head">Link</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Quick introduction to domain decomposition methods and <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffddm</span></code></td>
<td><a class="reference internal" href="tutorial.html#ffddmtutorial"><span class="std std-ref">Tutorial</span></a></td>
</tr>
<tr class="row-odd"><td>More about Domain Decomposition</td>
<td><a class="reference internal" href="introddm.html#ffddmintroduction"><span class="std std-ref">Introduction</span></a></td>
</tr>
<tr class="row-even"><td>Complete Documentation of ffddm</td>
<td><a class="reference internal" href="documentation.html#ffddmdocumentation"><span class="std std-ref">Documentation</span></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../../_static/js/toc.js"></script>
	</body>
</html>
<!DOCTYPE html>

<html lang="en">
	<head>
		  <meta charset="UTF-8">
  <title>Parallelization</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- MathJax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <script src="../_static/js/mathjax-config.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-sources" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
<script async src="../_static/js/github.js"></script>
		
		<nav id="nav">
	<div style="display: none;">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFEM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#easy-installation">Easy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-binary-installation">Windows binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-binary-installation">MacOS X binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#text-editor">Text-editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compilation">Compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#branches-os-status">Branches / OS status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/poisson.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/membrane.html">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/thermalConduction.html">Thermal Conduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/thermalConduction.html#axisymmetry-3d-rod-with-circular-section">Axisymmetry: 3D Rod with circular section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/thermalConduction.html#a-nonlinear-problem-radiation">A Nonlinear Problem : Radiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/fanBlade.html#heat-convection-around-the-airfoil">Heat Convection around the airfoil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/rotatingHill.html">Pure Convection : The Rotating Hill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#finite-volume-methods-can-also-be-handled-with-freefem-but-it-requires-programming"><strong>Finite Volume Methods</strong> can also be handled with <strong>FreeFEM</strong> but it requires programming.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/wifiPropagation.html">Wifi Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#coding">Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial/wifiPropagation.html#the-domain">The domain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial/wifiPropagation.html#lets-create-a-mesh">Let’s create a mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/matlabOctavePlot.html">Plotting in Matlab and Octave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#d-problem">2D Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#exporting-data">Exporting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#importing-data">Importing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#d-plot-examples">2D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#id1">3D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#square">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#border">Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#multi-border">Multi-Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#the-keyword-triangulate">The keyword “triangulate”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#boundary-fem-spaces-built-as-empty-meshes">Boundary FEM Spaces Built as Empty Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#remeshing">Remeshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#movemesh">Movemesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#regular-triangulation-htriangle">Regular Triangulation: hTriangle</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#adaptmesh">Adaptmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#trunc">Trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#splitmesh">Splitmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#meshing-examples">Meshing Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">How to change the label of elements and border elements of a mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#mesh-in-three-dimensions">Mesh in three dimensions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#layer-mesh">Layer mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#meshing-examples-1">Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="meshGeneration.html#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#medit">Medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#mshmet">Mshmet</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#freeyams">FreeYams</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#mmg3d">mmg3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l4"><a class="reference internal" href="meshGeneration.html#build-a-2d-mesh-from-a-isoline">Build a 2d mesh from a isoline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finiteElement.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#use-of-freefem-fespace-in-2d">Use of freefem fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="algorithmsOptimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="#global-operations">Global operations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hpddm-solvers">HPDDM solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-dependent-problem">Time dependent problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#distributed-vectors-in-hpddm">Distributed vectors in HPDDM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ffddm/introddm.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introddm.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introddm.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#standard-types">Standard types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#int">int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#bool">bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#real">real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#complex">complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#string">string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#mesh-design">Mesh design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#border">border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#mesh">mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#mesh3">mesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#finite-element-space-design">Finite element space design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#fespace">fespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#macro-design">Macro design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#macro">macro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#ifmacro">IFMACRO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#functions-design">Functions design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#func">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#elementary-functions">Elementary functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#random-functions">Random functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#fe-functions">FE-functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#problem-design">Problem design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#problem">problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#solve">solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#varf">varf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#array">Array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-index">Array index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-size">Array size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-sort">Array sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#double-array">Double array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-of-fe-functions">Array of FE functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#map-arrays">Map arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#matrix">matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-size">Matrix size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-resize">Matrix resize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-diagonal">Matrix diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-renumbering">Matrix renumbering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#complex-matrix">Complex matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#dot-product-outer-product">Dot product / Outer product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/globalVariables.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#area">area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#argv">ARGV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#boundaryedge">BoundaryEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#cg">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#cholesky">Cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#crout">Crout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#edgeorientation">edgeOrientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#false">false</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#gmres">GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#htriangle">hTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#include">include</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#internaledge">InternalEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#lenedge">lenEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#lu">LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#n">N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#ntonedge">nTonEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#nuedge">nuEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#nutriangle">nuTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#p">P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#pi">pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#sparsesolver">sparsesolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#true">true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#verbosity">verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#version">version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#volume">volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#x">x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#y">y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#z">z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/quadratureFormulae.html">Quadrature formulae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int1d">int1d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#notations">Notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pe">qf1pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pe">qf2pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf3pe">qf3pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf4pe">qf4pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf5pe">qf5pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pelump">qf1pElump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int2d">int2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pt">qf1pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pt">qf2pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf5pt">qf5pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1ptlump">qf1pTlump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pt4p1">qf2pT4P1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf7pt">qf7pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf9pt">qf9pT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int3d">int3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv1">qfV1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv2">qfV2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv5">qfV5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv1lump">qfV1lump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#addition-operator">Addition operator +</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#substraction-operator">Substraction operator -</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#multiplication-operator">Multiplication operator *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#term-by-term-multiplication">Term by term multiplication .*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#division-operator">Division operator /</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#term-by-term-division">Term by term division ./</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#remainder-from-the-division">Remainder from the division %</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#power-operator">Power operator ^</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#inverse-of-a-matrix-1">Inverse of a matrix ^-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#transpose-operator">Transpose operator ‘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#tensor-scalar-product">Tensor scalar product :</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#c-arithmetical-if-expression">C++ arithmetical if expression ? :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/loops.html">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#for">for</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#else">else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#while">while</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#continue">continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#break">break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#try">try</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#catch">catch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#implicit-loop">Implicit loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/IO.html">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#cout">cout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#cin">cin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#endl">endl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#ifstream">ifstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#ofstream">ofstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#append">append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#binary">binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#seekg">seekg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#tellg">tellg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#flush">flush</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#getline">getline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#output-format">Output format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#precision">precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#scientific">scientific</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#fixed">fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#showbase">showbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#noshowbase">noshowbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#showpos">showpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#noshowpos">noshowpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#default">default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#setw">setw</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#abs">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#acos">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#acosh">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#adaptmesh">adaptmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#adj">adj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#affinecg">AffineCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#affinegmres">AffineGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#arg">arg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#asin">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#asinh">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#assert">assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atan">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atan2">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atanh">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atoi">atoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atof">atof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#bfgs">BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#buildmesh">buildmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#ceil">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#chi">chi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#checkmovemesh">checkmovemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#clock">clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#complexeigenvalue">complexEigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#conj">conj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#convect">convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#copysign">copysign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#cos">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#cosh">cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#diffnp">diffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#diffpos">diffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dist">dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dumptable">dumptable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dx">dx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxx">dxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxy">dxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxz">dxz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dy">dy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyx">dyx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyy">dyy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyz">dyz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dz">dz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzx">dzx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzy">dzy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzz">dzz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#eigenvalue">EigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#emptymesh">emptymesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#erf">erf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#erfc">erfc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exit">exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exp">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fdim">fdim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#floor">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmax">fmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmin">fmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmod">fmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#imag">imag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int1d">int1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int2d">int2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int3d">int3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#intalledges">intalledges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#intallfaces">intallfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiff">invdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiffnp">invdiffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiffpos">invdiffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#isinf">isInf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#isnan">isNaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#j0">j0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#j1">j1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#jn">jn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#jump">jump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#linearcg">LinearCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lineargmres">LinearGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lgamma">lgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#log">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#log10">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lrint">lrint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lround">lround</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#movemesh">movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#nan">NaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#nlcg">NLCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#on">on</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#plot">plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#polar">polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#pow">pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#projection">projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randinit">randinit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randint31">randint31</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randint32">randint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal1">randreal1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal2">randreal2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal3">randreal3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randres53">randres53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#readmesh">readmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#readmesh3">readmesh3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#real">real</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#rint">rint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#round">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#savemesh">savemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sign">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#signbit">signbit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sin">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sinh">sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sort">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#splitmesh">splitmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sqrt">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#square">square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#swap">swap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#system">system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tan">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tanh">tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tgamma">tgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#trunc">trunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#y0">y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#y1">y1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#yn">yn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/externalLibraries.html">External libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#aniso">aniso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#boundaniso">boundaniso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#bec">BEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bectrap">BECtrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gpvortex">GPvortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxgpvortex">dxGPVortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dygpvortex">dyGPVortex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#binary-i-o">Binary I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#loadvec">LoadVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#loadflag">LoadFlag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savevec">SaveVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#flag">flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#buildlayer">buildlayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#buildlayers">buildlayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#closepoints">ClosePoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#radiussearch">radiusSearch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#voisinage">Voisinage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#neighborhood">neighborhood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoints2">ClosePoints2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoint">ClosePoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoints1">ClosePoints1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#curvature">Curvature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#extractborder">extractborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id1">curvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#raxicurvature">raxicurvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#curves">curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#setecurveabcisse">setecurveabcisse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#equiparameter">equiparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tresca">Tresca</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vonmises">VonMises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#dfft">dfft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#plandfft">plandfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#execute">execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#delete">delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id2">dfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#map">map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#distance">distance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id3">distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#checkdist">checkdist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#dxwriter">DxWriter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddmesh">Dxaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddtimeseries">Dxaddtimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddsol2ts">Dxaddsol2ts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#element-p1bl">Element_P1bl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#expert">expert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#exactpartition">exactpartition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id4">exactpartition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-airybiry">ff-AiryBiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#airy">airy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#biry">biry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-cmaes">ff-cmaes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cmaes">cmaes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-gsl-awk">ff_gsl_awk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianp">gslcdfugaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianq">gslcdfugaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianpinv">gslcdfugaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianqinv">gslcdfugaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianp">gslcdfgaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianq">gslcdfgaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianpinv">gslcdfgaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianqinv">gslcdfgaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammap">gslcdfgammaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammaq">gslcdfgammaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammapinv">gslcdfgammaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammaqinv">gslcdfgammaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyp">gslcdfcauchyP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyq">gslcdfcauchyQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchypinv">gslcdfcauchyPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyqinv">gslcdfcauchyQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplacep">gslcdflaplaceP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplaceq">gslcdflaplaceQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplacepinv">gslcdflaplacePinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplaceqinv">gslcdflaplaceQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighp">gslcdfrayleighP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighq">gslcdfrayleighQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighpinv">gslcdfrayleighPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighqinv">gslcdfrayleighQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqp">gslcdfchisqP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqq">gslcdfchisqQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqpinv">gslcdfchisqPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqqinv">gslcdfchisqQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialp">gslcdfexponentialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialq">gslcdfexponentialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialpinv">gslcdfexponentialPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialqinv">gslcdfexponentialQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexppowp">gslcdfexppowP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexppowq">gslcdfexppowQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistp">gslcdftdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistq">gslcdftdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistpinv">gslcdftdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistqinv">gslcdftdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistp">gslcdffdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistq">gslcdffdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistpinv">gslcdffdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistqinv">gslcdffdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetap">gslcdfbetaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetaq">gslcdfbetaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetapinv">gslcdfbetaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetaqinv">gslcdfbetaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatp">gslcdfflatP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatq">gslcdfflatQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatpinv">gslcdfflatPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatqinv">gslcdfflatQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalp">gslcdflognormalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalq">gslcdflognormalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalpinv">gslcdflognormalPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalqinv">gslcdflognormalQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1p">gslcdfgumbel1P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1q">gslcdfgumbel1Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1pinv">gslcdfgumbel1Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1qinv">gslcdfgumbel1Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2p">gslcdfgumbel2P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2q">gslcdfgumbel2Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2pinv">gslcdfgumbel2Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2qinv">gslcdfgumbel2Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullp">gslcdfweibullP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullq">gslcdfweibullQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullpinv">gslcdfweibullPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullqinv">gslcdfweibullQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetop">gslcdfparetoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetoq">gslcdfparetoQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetopinv">gslcdfparetoPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetoqinv">gslcdfparetoQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticp">gslcdflogisticP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticq">gslcdflogisticQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticpinv">gslcdflogisticPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticqinv">gslcdflogisticQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbinomialp">gslcdfbinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbinomialq">gslcdfbinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpoissonp">gslcdfpoissonP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpoissonq">gslcdfpoissonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgeometricp">gslcdfgeometricP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgeometricq">gslcdfgeometricQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfnegativebinomialp">gslcdfnegativebinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfnegativebinomialq">gslcdfnegativebinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpascalp">gslcdfpascalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpascalq">gslcdfpascalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbernoullipdf">gslranbernoullipdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbeta">gslranbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbetapdf">gslranbetapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbinomialpdf">gslranbinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexponential">gslranexponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexponentialpdf">gslranexponentialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexppow">gslranexppow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexppowpdf">gslranexppowpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrancauchy">gslrancauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrancauchypdf">gslrancauchypdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranchisq">gslranchisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranchisqpdf">gslranchisqpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranerlang">gslranerlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranerlangpdf">gslranerlangpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranfdist">gslranfdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranfdistpdf">gslranfdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranflat">gslranflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranflatpdf">gslranflatpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangamma">gslrangamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammaint">gslrangammaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammapdf">gslrangammapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammamt">gslrangammamt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammaknuth">gslrangammaknuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussian">gslrangaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianratiomethod">gslrangaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianziggurat">gslrangaussianziggurat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianpdf">gslrangaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussian">gslranugaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussianratiomethod">gslranugaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussianpdf">gslranugaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussiantail">gslrangaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussiantailpdf">gslrangaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussiantail">gslranugaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussiantailpdf">gslranugaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlandau">gslranlandau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlandaupdf">gslranlandaupdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangeometricpdf">gslrangeometricpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel1">gslrangumbel1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel1pdf">gslrangumbel1pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel2">gslrangumbel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel2pdf">gslrangumbel2pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogistic">gslranlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogisticpdf">gslranlogisticpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlognormal">gslranlognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlognormalpdf">gslranlognormalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogarithmicpdf">gslranlogarithmicpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrannegativebinomialpdf">gslrannegativebinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpascalpdf">gslranpascalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpareto">gslranpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranparetopdf">gslranparetopdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpoissonpdf">gslranpoissonpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleigh">gslranrayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleighpdf">gslranrayleighpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleightail">gslranrayleightail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleightailpdf">gslranrayleightailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrantdist">gslrantdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrantdistpdf">gslrantdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlaplace">gslranlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlaplacepdf">gslranlaplacepdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlevy">gslranlevy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranweibull">gslranweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranweibullpdf">gslranweibullpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyai">gslsfairyAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybi">gslsfairyBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaiscaled">gslsfairyAiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybiscaled">gslsfairyBiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaideriv">gslsfairyAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybideriv">gslsfairyBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaiderivscaled">gslsfairyAiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybiderivscaled">gslsfairyBiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzeroai">gslsfairyzeroAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzerobi">gslsfairyzeroBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzeroaideriv">gslsfairyzeroAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzerobideriv">gslsfairyzeroBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj0">gslsfbesselJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj1">gslsfbesselJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljn">gslsfbesselJn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely0">gslsfbesselY0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely1">gslsfbesselY1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselyn">gslsfbesselYn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli0">gslsfbesselI0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli1">gslsfbesselI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselin">gslsfbesselIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli0scaled">gslsfbesselI0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli1scaled">gslsfbesselI1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinscaled">gslsfbesselInscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk0">gslsfbesselK0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk1">gslsfbesselK1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselkn">gslsfbesselKn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk0scaled">gslsfbesselK0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk1scaled">gslsfbesselK1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknscaled">gslsfbesselKnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id5">gslsfbesselj0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id6">gslsfbesselj1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj2">gslsfbesselj2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljl">gslsfbesseljl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id7">gslsfbessely0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id8">gslsfbessely1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely2">gslsfbessely2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselyl">gslsfbesselyl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id9">gslsfbesseli0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id10">gslsfbesseli1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli2scaled">gslsfbesseli2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselilscaled">gslsfbesselilscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id11">gslsfbesselk0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id12">gslsfbesselk1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk2scaled">gslsfbesselk2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselklscaled">gslsfbesselklscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljnu">gslsfbesselJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselynu">gslsfbesselYnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinuscaled">gslsfbesselInuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinu">gslsfbesselInu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknuscaled">gslsfbesselKnuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknu">gslsfbesselKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessellnknu">gslsfbessellnKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzeroj0">gslsfbesselzeroJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzeroj1">gslsfbesselzeroJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzerojnu">gslsfbesselzeroJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfclausen">gslsfclausen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhydrogenicr1">gslsfhydrogenicR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdawson">gslsfdawson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye1">gslsfdebye1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye2">gslsfdebye2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye3">gslsfdebye3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye4">gslsfdebye4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye5">gslsfdebye5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye6">gslsfdebye6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdilog">gslsfdilog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfmultiply">gslsfmultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintkcomp">gslsfellintKcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintecomp">gslsfellintEcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintpcomp">gslsfellintPcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintdcomp">gslsfellintDcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintf">gslsfellintF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellinte">gslsfellintE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintrc">gslsfellintRC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfc">gslsferfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflogerfc">gslsflogerfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferf">gslsferf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfz">gslsferfZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfq">gslsferfQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhazard">gslsfhazard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexp">gslsfexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpmult">gslsfexpmult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpm1">gslsfexpm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexprel">gslsfexprel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexprel2">gslsfexprel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpreln">gslsfexpreln</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte1">gslsfexpintE1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte2">gslsfexpintE2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinten">gslsfexpintEn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte1scaled">gslsfexpintE1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte2scaled">gslsfexpintE2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpintenscaled">gslsfexpintEnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpintei">gslsfexpintEi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinteiscaled">gslsfexpintEiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfshi">gslsfShi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfchi">gslsfChi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpint3">gslsfexpint3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsi">gslsfSi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfci">gslsfCi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfatanint">gslsfatanint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracm1">gslsffermidiracm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac0">gslsffermidirac0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac1">gslsffermidirac1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac2">gslsffermidirac2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracint">gslsffermidiracint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracmhalf">gslsffermidiracmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirachalf">gslsffermidirachalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac3half">gslsffermidirac3half</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracinc0">gslsffermidiracinc0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflngamma">gslsflngamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgamma">gslsfgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammastar">gslsfgammastar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammainv">gslsfgammainv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftaylorcoeff">gslsftaylorcoeff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffact">gslsffact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdoublefact">gslsfdoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnfact">gslsflnfact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflndoublefact">gslsflndoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnchoose">gslsflnchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfchoose">gslsfchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnpoch">gslsflnpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpoch">gslsfpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpochrel">gslsfpochrel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammaincq">gslsfgammaincQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammaincp">gslsfgammaincP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammainc">gslsfgammainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnbeta">gslsflnbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbeta">gslsfbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbetainc">gslsfbetainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly1">gslsfgegenpoly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly2">gslsfgegenpoly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly3">gslsfgegenpoly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpolyn">gslsfgegenpolyn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg0f1">gslsfhyperg0F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg1f1int">gslsfhyperg1F1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg1f1">gslsfhyperg1F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperguint">gslsfhypergUint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhypergu">gslsfhypergU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg2f0">gslsfhyperg2F0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre1">gslsflaguerre1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre2">gslsflaguerre2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre3">gslsflaguerre3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerren">gslsflaguerren</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflambertw0">gslsflambertW0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflambertwm1">gslsflambertWm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrepl">gslsflegendrePl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep1">gslsflegendreP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep2">gslsflegendreP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep3">gslsflegendreP3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreq0">gslsflegendreQ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreq1">gslsflegendreQ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreql">gslsflegendreQl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreplm">gslsflegendrePlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendresphplm">gslsflegendresphPlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrearraysize">gslsflegendrearraysize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalphalf">gslsfconicalPhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpmhalf">gslsfconicalPmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalp0">gslsfconicalP0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalp1">gslsfconicalP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpsphreg">gslsfconicalPsphreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpcylreg">gslsfconicalPcylreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d0">gslsflegendreH3d0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d1">gslsflegendreH3d1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d">gslsflegendreH3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog">gslsflog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflogabs">gslsflogabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog1plusx">gslsflog1plusx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog1plusxmx">gslsflog1plusxmx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpowint">gslsfpowint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsiint">gslsfpsiint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi">gslsfpsi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1piy">gslsfpsi1piy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1int">gslsfpsi1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1">gslsfpsi1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsin">gslsfpsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsynchrotron1">gslsfsynchrotron1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsynchrotron2">gslsfsynchrotron2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport2">gslsftransport2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport3">gslsftransport3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport4">gslsftransport4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport5">gslsftransport5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsin">gslsfsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfcos">gslsfcos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhypot">gslsfhypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsinc">gslsfsinc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnsinh">gslsflnsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflncosh">gslsflncosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfanglerestrictsymm">gslsfanglerestrictsymm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfanglerestrictpos">gslsfanglerestrictpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetaint">gslsfzetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzeta">gslsfzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetam1">gslsfzetam1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetam1int">gslsfzetam1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhzeta">gslsfhzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfetaint">gslsfetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfeta">gslsfeta</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-ipopt">ff-Ipopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ipopt">IPOPT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#fflapack">fflapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgeev">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zgeev">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#geev">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id13">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dggev">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zggev">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dsygvd">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgesdd">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zhegv">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dsyev">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zheev">zheev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-mmap-semaphore">ff-mmap-semaphore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#wait">Wait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#trywait">trywait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#post">Post</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#msync">msync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#read">Read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#write">Write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ffnewuoa">ffnewuoa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#newuoa">newuoa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-nlopt">ff-NLopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirect">nloptDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectl">nloptDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlrand">nloptDIRECTLRand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectscal">nloptDIRECTScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectnoscal">nloptDIRECTNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlnoscal">nloptDIRECTLNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlrandnoscal">nloptDIRECTLRandNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptorigdirect">nloptOrigDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptorigdirectl">nloptOrigDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptstogo">nloptStoGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptstogorand">nloptStoGORand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptlbfgs">nloptLBFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptpraxis">nloptPRAXIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptvar1">nloptVar1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptvar2">nloptVar2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewton">nloptTNewton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonrestart">nloptTNewtonRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonprecond">nloptTNewtonPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonprecondrestart">nloptTNewtonPrecondRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptcrs2">nloptCRS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmma">nloptMMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptcobyla">nloptCOBYLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptnewuoa">nloptNEWUOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptnewuoabound">nloptNEWUOABound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptneldermead">nloptNelderMead</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptsbplx">nloptSbplx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptbobyqa">nloptBOBYQA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptisres">nloptISRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptslsqp">nloptSLSQP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmlsl">nloptMLSL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmlsllds">nloptMLSLLDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptauglag">nloptAUGLAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptauglageq">nloptAUGLAGEQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ffrandom">ffrandom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#srandomdev">srandomdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#srandom">srandom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#random">random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#freefemqa">FreeFemQA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#meshgenqa">MeshGenQA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#freeyams">freeyams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id14">freeyams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#gmsh">gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gmshload">gmshload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gmshload3">gmshload3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savegmsh">savegmsh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#gsl">gsl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolysolvequadratic">gslpolysolvequadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolysolvecubic">gslpolysolvecubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolycomplexsolve">gslpolycomplexsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrnguniform">gslrnguniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrnguniformpos">gslrnguniformpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslname">gslname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngget">gslrngget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngmin">gslrngmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngmax">gslrngmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngset">gslrngset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngtype">gslrngtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ilut">ilut</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#applyilutprecond">applyIlutPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#makeilutprecond">makeIlutPrecond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#iohdf5">iohdf5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savehdf5sol">savehdf5sol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#iovtk">iovtk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savevtk">savevtk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkload">vtkload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkload3">vtkload3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#isoline">isoline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id15">isoline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#curve">Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#area">Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#findallocalmin">findallocalmin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#lapack">lapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id16">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id17">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id18">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id19">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id20">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id21">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id22">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id23">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id24">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id25">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id26">zheev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgelsy">dgelsy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#lgbmo">lgbmo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bmo">bmo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mat-dervieux">mat_dervieux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#matupwind1">MatUpWind1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mat-psi">mat_psi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#matupwind0">MatUpWind0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#medit">medit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id27">medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savesol">savesol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readsol">readsol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metis">metis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#metisnodal">metisnodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#metisdual">metisdual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metrickuate">MetricKuate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id28">MetricKuate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metricpk">MetricPk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id29">MetricPk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mmg3d">mmg3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id30">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mmg3d-v4-0">mmg3d-v4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id31">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#msh3">msh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#change">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh23">movemesh23</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh2d3dsurf">movemesh2D3Dsurf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh3">movemesh3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh">movemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh3d">movemesh3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#deplacement">deplacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#checkbemesh">checkbemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id32">buildlayers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bcube">bcube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cube">cube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#trunc">trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gluemesh">gluemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#showborder">showborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#getborder">getborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#addlayers">AddLayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mshmet">mshmet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id33">mshmet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mumps">MUMPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttomumpsseq">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mumps-seq">MUMPS_seq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id34">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#netgen">netgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netg">netg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netgstl">netgstl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netgload">netgload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#newsolver">NewSolver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttoumfpack">defaulttoUMFPACK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pardiso">PARDISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttopardiso">defaulttoPARDISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompsetnumthreads">ompsetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompgetnumthreads">ompgetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompgetmaxthreads">ompgetmaxthreads</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pcm2rnm">pcm2rnm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readpcm">readpcm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pipe">pipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#flush">flush</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#usleep">usleep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#qf11to25">qf11to25</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf1d">QF1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf2d">QF2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf3d">QF3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tripleqf">tripleQF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#scotch">scotch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id35">scotch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#shell">shell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readdir">readdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#unlink">unlink</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#rmdir">rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cddir">cddir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#chdir">chdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#basename">basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dirname">dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#mkdir">mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#chmod">chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cpfile">cpfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#stat">stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#isdir">isdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#getenv">getenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#setenv">setenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#unsetenv">unsetenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitedges">splitedges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#splitedgemesh">SplitedgeMesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh12">splitmesh12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id36">splitmesh12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh3">splitmesh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id37">splitmesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh4">splitmesh4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#splimesh4">splimesh4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh6">splitmesh6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id38">splitmesh6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#superlu">SuperLu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttosuperlu">defaulttoSuperLu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#symmetrizecsr">symmetrizeCSR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id39">symmetrizeCSR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#tetgen">tetgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgconvexhull">tetgconvexhull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgtransfo">tetgtransfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetg">tetg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgreconstruction">tetgreconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#umfpack64">UMFPACK64</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttoumfpack64">defaulttoUMFPACK64</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#vtk-writer-3d">VTK_writer_3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkaddmesh">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkaddscalar">Vtkaddscalar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#vtk-writer">VTK_writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id40">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id41">Vtkaddscalar</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model/staticProblems.html">Static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#soap-film">Soap Film</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#electrostatics">Electrostatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#aerodynamics">Aerodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#error-estimation">Error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#poisson-problems-with-mixed-boundary-condition">Poisson Problems with mixed boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#poisson-with-mixed-finite-element">Poisson with mixed finite element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#metric-adaptation-and-residual-error-indicator">Metric Adaptation and residual error indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#adaptation-using-residual-error-indicator">Adaptation using residual error indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/elasticity.html">Elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/elasticity.html#fracture-mechanics">Fracture Mechanics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearStaticProblems.html">Non-linear static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/nonLinearStaticProblems.html#newton-raphson-algorithm">Newton-Raphson algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/eigenValueProblems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/evolutionProblems.html">Evolution problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#mathematical-theory-on-time-difference-approximations">Mathematical Theory on Time Difference Approximations.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#convection">Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#d-black-scholes-equation-for-an-european-put-option">2D Black-Scholes equation for an European Put option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/navierStokesEquations.html">Navier-Stokes equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/navierStokesEquations.html#uzawa-algorithm-and-conjugate-gradients">Uzawa Algorithm and Conjugate Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/navierStokesEquations.html#nsuzawacahouetchabart-edp">NSUzawaCahouetChabart.edp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/variationalInequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/domainDecomposition.html">Domain decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-overlapping">Schwarz overlapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-non-overlapping-scheme">Schwarz non overlapping Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-conjuguate-gradient">Schwarz conjuguate gradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/fluidStructureCoupledProblem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/transmissionProblem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/freeBoundaryProblem.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearElasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html">Compressible Neo-Hookean materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#recommended-references">Recommended References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#a-neo-hookean-compressible-material">A Neo-Hookean Compressible Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#an-approach-to-implementation-in-freefem">An Approach to Implementation in FreeFEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/whisperingGalleryModes.html">Whispering gallery modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#weak-formulation">Weak formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../example/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/finiteElement.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/algoOptimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr/lunr_index.js"></script>

<div class="search-container">
	<label for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Search ..." id="searchInput">
	<div id="searchResults"></div>
</div>

<script src="../_static/js/search.js"></script>
<script>
   initSearch('../')
</script>
	
</nav>
<script async src="../_static/js/nav.js"></script>
		

		<div id="subnav">
	<div style="display: none">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a></li>
<li class="toctree-l2"><a class="reference internal" href="meshGeneration.html">Mesh Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="finiteElement.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithmsOptimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mpi">MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallel-sparse-solvers">Parallel sparse solvers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
</ul>

	</div>
</div>
<script async src="../_static/js/subnav.js"></script>
		
		<div id="content">
			
   <div class="section" id="parallelization">
<h1>Parallelization<a class="headerlink" href="#parallelization" title="Permalink to this headline"> </a></h1>
<p>A first attempt of parallelization of <strong>FreeFEM</strong> is made here with <strong>MPI</strong>.
An extended interface with MPI has been added to <strong>FreeFEM</strong> version 3.5, (see the <a class="reference external" href="https://www.mpi-forum.org/docs/">MPI documentation</a> for the functionality of the language).</p>
<div class="section" id="mpi">
<h2>MPI<a class="headerlink" href="#mpi" title="Permalink to this headline"> </a></h2>
<div class="section" id="mpi-keywords">
<h3>MPI Keywords<a class="headerlink" href="#mpi-keywords" title="Permalink to this headline"> </a></h3>
<p>The following keywords and concepts are used:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mpiComm</span></code> to defined a <em>communication world</em></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mpiGroup</span></code> to defined a group of <em>processors</em> in the communication world</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mpiRequest</span></code> to defined a request to wait for the end of the communication</li>
</ul>
</div>
<div class="section" id="mpi-constants">
<h3>MPI Constants<a class="headerlink" href="#mpi-constants" title="Permalink to this headline"> </a></h3>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpisize</span></code> The total number of <em>processes</em>,</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpirank</span></code> the id-number of my current process in <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="p">...,</span> <span class="kr">mpisize</span><span class="o">-</span><span class="mi">1</span><span class="p">}</span></code>,</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiUndefined</span></code> The <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_Undefined</span></code> constant,</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiAnySource</span></code> The <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_ANY_SOURCE</span></code> constant,</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiCommWorld</span></code> The <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_COMM_WORLD</span></code> constant,</li>
<li>[ … ] and all the keywords of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Op</span></code> for the <em>reduce</em> operator: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiMAX</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiMIN</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiSUM</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiPROD</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLAND</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLOR</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLXOR</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiBAND</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiBXOR</span></code>.</li>
</ul>
</div>
<div class="section" id="mpi-constructor">
<h3>MPI Constructor<a class="headerlink" href="#mpi-constructor" title="Permalink to this headline"> </a></h3>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">proc1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">proc2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// MPI ranks</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MPI rank = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">mpirank</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

<span class="c1">// MPI</span>
<span class="kt">mpiComm</span> <span class="nf">comm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">//set a MPI_Comm to MPI_COMM_WORLD</span>

<span class="kt">mpiGroup</span> <span class="nf">grp</span><span class="p">(</span><span class="n">proc1</span><span class="p">);</span> <span class="c1">//set MPI_Group to proc 1,2 in MPI_COMM_WORLD</span>
<span class="kt">mpiGroup</span> <span class="nf">grp1</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">proc1</span><span class="p">);</span> <span class="c1">//set MPI_Group to proc 1,2 in comm</span>

<span class="kt">mpiComm</span> <span class="nf">ncomm1</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="n">grp</span><span class="p">);</span> <span class="c1">//set the MPI_Comm form grp</span>

<span class="kt">mpiComm</span> <span class="nf">ncomm2</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="c1">//MPI_Comm_split(MPI_Comm comm, int color, int key, MPI_Comm *ncomm)</span>

<span class="kt">mpiRequest</span> <span class="n">rq</span><span class="p">;</span> <span class="c1">//defined an MPI_Request</span>
<span class="kt">mpiRequest</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">arq</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="c1">//defined an array of 10 MPI_Request</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="mpi-functions">
<h3>MPI Functions<a class="headerlink" href="#mpi-functions" title="Permalink to this headline"> </a></h3>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mpiComm</span> <span class="nf">Comm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">MPICommSize</span> <span class="o">=</span> <span class="nf">mpiSize</span><span class="p">(</span><span class="n">Comm</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">MPIRank</span> <span class="o">=</span> <span class="nf">mpiRank</span><span class="p">(</span><span class="n">Comm</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">MPIRank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MPI Comm size = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">MPICommSize</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MPI rank in Comm = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">mpiRank</span><span class="p">(</span><span class="n">Comm</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

<span class="kt">mpiRequest</span> <span class="n">Req</span><span class="p">;</span>
<span class="kt">mpiRequest</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ReqArray</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MPICommSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
     <span class="c1">//return processor i with no Resquest in MPI_COMM_WORLD</span>
    <span class="nf">processor</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="c1">//return processor any source with no Resquest in MPI_COMM_WORLD</span>
    <span class="nf">processor</span><span class="p">(</span><span class="kr">mpiAnySource</span><span class="p">);</span>
    <span class="c1">//return processor i with no Resquest in Comm</span>
    <span class="nf">processor</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Comm</span><span class="p">);</span>
    <span class="c1">//return processor i with no Resquest in Comm</span>
    <span class="nf">processor</span><span class="p">(</span><span class="n">Comm</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="c1">//return processor i with Resquest rq in Comm</span>
    <span class="cm">/* processor(i, Req, Comm);</span>
<span class="cm">    //return processor i with Resquest rq in MPI_COMM_WORLD</span>
<span class="cm">    processor(i, Req); */</span>
    <span class="c1">//return processor i in MPI_COMM_WORLD in block mode for synchronously communication</span>
    <span class="nf">processorblock</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="c1">//return processor any source in MPI_COMM_WORLD in block mode for synchronously communication</span>
    <span class="nf">processorblock</span><span class="p">(</span><span class="kr">mpiAnySource</span><span class="p">);</span>
    <span class="c1">//return processor i in in Comm in block mode</span>
    <span class="nf">processorblock</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Comm</span><span class="p">);</span>
<span class="p">}</span>

<span class="nf">mpiBarrier</span><span class="p">(</span><span class="n">Comm</span><span class="p">);</span> <span class="c1">//do a MPI_Barrier on communicator Comm</span>
<span class="nf">mpiWaitAny</span><span class="p">(</span><span class="n">ReqArray</span><span class="p">);</span> <span class="c1">//wait add of Request array,</span>
<span class="nf">mpiWait</span><span class="p">(</span><span class="n">Req</span><span class="p">);</span> <span class="c1">//wait on a Request</span>
<span class="kt">real</span> <span class="kp">t</span> <span class="o">=</span> <span class="nf">mpiWtime</span><span class="p">();</span> <span class="c1">//return MPIWtime in second</span>
<span class="kt">real</span> <span class="n">tick</span> <span class="o">=</span> <span class="nf">mpiWtick</span><span class="p">();</span> <span class="c1">//return MPIWTick in second</span>
</pre></div>
</td></tr></table></div>
<p>where a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span></code> is just a integer rank, pointer to a <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_comm</span></code> and pointer to a <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_Request</span></code>, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processorblock</span></code> with a special <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">MPI_Request</span></code>.</p>
</div>
<div class="section" id="mpi-communicator-operator">
<h3>MPI Communicator operator<a class="headerlink" href="#mpi-communicator-operator" title="Permalink to this headline"> </a></h3>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">status</span><span class="p">;</span> <span class="c1">//to get the MPI status of send / recv</span>
<span class="kt">real</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>

<span class="kt">mpiComm</span> <span class="nf">comm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">mpiRequest</span> <span class="n">req</span><span class="p">;</span>

<span class="c1">//send a,b asynchronously to the process 1</span>
<span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">b</span><span class="p">;</span>
<span class="c1">//receive a,b synchronously from the process 10</span>
<span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>

<span class="c1">//broadcast from processor of comm to other comm processor</span>
<span class="c1">// broadcast(processor(10, comm), a);</span>
<span class="c1">//send synchronously to the process 10 the data a</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">Send</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>
<span class="c1">//receive synchronously from the process 10 the data a</span>
<span class="n">status</span> <span class="o">=</span> <span class="nf">Recv</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>

<span class="c1">//send asynchronously to the process 10 the data a without request</span>
<span class="n">status</span> <span class="o">=</span> <span class="nf">Isend</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>
<span class="c1">//send asynchronously to the process 10 the data a with request</span>
<span class="n">status</span> <span class="o">=</span> <span class="nf">Isend</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">req</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>
<span class="c1">//receive asynchronously from the process 10 the data a</span>
<span class="n">status</span> <span class="o">=</span> <span class="nf">Irecv</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">req</span><span class="p">),</span> <span class="n">a</span><span class="p">);</span>
<span class="c1">//Error asynchronously without request.</span>
<span class="c1">// status = Irecv(processor(10), a);</span>
</pre></div>
</td></tr></table></div>
<p>where the data type of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span></code> can be of type of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">double</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span></code></p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//send asynchronously to the process 10 the data a with request</span>
<span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="p">;</span>
<span class="c1">//receive asynchronously from the process 10 the data a with request</span>
<span class="nf">processor</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span></code> are arrays or full matrices of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, we can use the following MPI functions:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">mpiAlltoall</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">comm</span><span class="p">]);</span>
<span class="nf">mpiAllgather</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">comm</span><span class="p">]);</span>
<span class="nf">mpiGather</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(..)</span> <span class="p">);</span>
<span class="nf">mpiScatter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(..));</span>
<span class="nf">mpiReduce</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(..),</span> <span class="kr">mpiMAX</span><span class="p">);</span>
<span class="nf">mpiAllReduce</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="kr">mpiMAX</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>Thank you to Guy-Antoine Atenekeng Kahou for his help to code this interface.</p>
</div>
<div class="section" id="schwarz-example-in-parallel">
<h3>Schwarz example in parallel<a class="headerlink" href="#schwarz-example-in-parallel" title="Permalink to this headline"> </a></h3>
<p>This example is a rewritting of example <a class="reference internal" href="../model/domainDecomposition.html#domaindecompositionschwarzoverlapping"><span class="std std-ref">Schwarz overlapping</span></a>.</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>ff-mpirun -np <span class="m">2</span> SchwarzParallel.edp
<span class="c1"># OR</span>
mpirun -np <span class="m">2</span> FreeFem++-mpi SchwarzParallel.edp
</pre></div>
</td></tr></table></div>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="kr">mpisize</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; sorry, number of processors !=2 &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Parameters</span>
<span class="kr">verbosity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">interior</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">exterior</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">exterior</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">exterior</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">exterior</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">interior</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="n">interior</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">e1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="n">exterior</span><span class="p">;}</span>
<span class="kt">mesh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Th</span><span class="p">(</span><span class="kr">mpisize</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">Th</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="nf">d</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>
<span class="k">else</span>
    <span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">e1</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>

<span class="nf">broadcast</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Th</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="nf">broadcast</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="kr">mpirank</span><span class="p">],</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vhother</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="kr">mpirank</span><span class="p">],</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vhother</span> <span class="n">U</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">//Problem</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">problem</span> <span class="nf">pb</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">Cholesky</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="kr">mpirank</span><span class="p">])(</span>
          <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="kr">mpirank</span><span class="p">])(</span>
          <span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">interior</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">U</span><span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">exterior</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Loop</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="kr">mpirank</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - Loop &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="c1">// Solve</span>
    <span class="n">pb</span><span class="p">;</span>
    <span class="c1">//send u to the other proc, receive in U</span>
    <span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">mpirank</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">[];</span>
    <span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">mpirank</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">U</span><span class="p">[];</span>

    <span class="c1">// Error</span>
    <span class="kt">real</span> <span class="n">err0</span><span class="p">,</span> <span class="n">err1</span><span class="p">;</span>
    <span class="n">err0</span> <span class="o">=</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="kr">mpirank</span><span class="p">],</span><span class="n">interior</span><span class="p">)(</span><span class="nf">square</span><span class="p">(</span><span class="n">U</span> <span class="o">-</span> <span class="n">u</span><span class="p">));</span>
    <span class="c1">// send err0 to the other proc, receive in err1</span>
    <span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">mpirank</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">err0</span><span class="p">;</span>
    <span class="nf">processor</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">mpirank</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">err1</span><span class="p">;</span>
    <span class="kt">real</span> <span class="kp">err</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">err0</span> <span class="o">+</span> <span class="n">err1</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; err = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">err</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - err0 = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">err0</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - err1 = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">err1</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kp">err</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">U</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">script freeze in the loop</p>
</div>
<div class="section" id="true-parallel-schwarz-example">
<h4>True parallel Schwarz example<a class="headerlink" href="#true-parallel-schwarz-example" title="Permalink to this headline"> </a></h4>
<p><em>Thank you to F. Nataf</em></p>
<p>This is a explanation of the two examples <a class="reference internal" href="../example/parallelization.html#examplempigmres2d"><span class="std std-ref">MPI-GMRES 2D</span></a> and <a class="reference internal" href="../example/parallelization.html#examplempigmres3d"><span class="std std-ref">MPI-GMRES 3D</span></a>, a Schwarz parallel with a complexity almost independent of the number of process (with a coarse grid preconditioner).</p>
<p>To solve the following Poisson problem on domain <span class="math notranslate nohighlight">\(\Omega\)</span> with boundary <span class="math notranslate nohighlight">\(\Gamma\)</span> in <span class="math notranslate nohighlight">\(L^2(\Omega)\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcll}
    -\Delta u &amp;=&amp; f &amp; \mbox{ in } \Omega\\
    u &amp;=&amp; g &amp; \mbox{ on } \Gamma
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are two given functions of <span class="math notranslate nohighlight">\(L^2(\Omega)\)</span> and of <span class="math notranslate nohighlight">\(H^{\frac12}(\Gamma)\)</span>,</p>
<p>Lets introduce <span class="math notranslate nohighlight">\((\pi_i)_{i=1,.., N_p}\)</span> a regular partition of the unity of <span class="math notranslate nohighlight">\(\Omega\)</span>, q-e-d:</p>
<div class="math notranslate nohighlight">
\[\pi_i \in \mathcal{C}^0(\Omega) : \quad \pi_i\ge 0 \mbox{ and } \sum_{i=1}^{N_p} \pi_i =1 .\]</div>
<p>Denote <span class="math notranslate nohighlight">\(\Omega_i\)</span> the sub domain which is the support of <span class="math notranslate nohighlight">\(\pi_i\)</span> function and also denote <span class="math notranslate nohighlight">\(\Gamma_i\)</span> the boundary of <span class="math notranslate nohighlight">\(\Omega_i\)</span>.</p>
<p>The parallel Schwarz method is:</p>
<p>Let <span class="math notranslate nohighlight">\(\ell=0\)</span> the iterator and a initial guest <span class="math notranslate nohighlight">\(u^0\)</span> respecting the boundary condition (i.e.&nbsp;<span class="math notranslate nohighlight">\(u^0_{|\Gamma} = g\)</span>).</p>
<div class="math notranslate nohighlight" id="equation-eq-lapl">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-lapl" title="Permalink to this equation"> </a></span>\[\begin{split}\begin{array}{rcll}
    \forall i = 1 .., N_p:&amp;\nonumber\\
    \displaystyle -\Delta u_i^\ell &amp;=&amp; f &amp;\mbox{ in } \Omega_i\\
    u_i^\ell &amp;=&amp; u^\ell &amp; \mbox{ on } \Gamma_i \setminus \Gamma\\
    u_i^\ell &amp;=&amp; g &amp; \mbox{ on } \Gamma_i \cap \Gamma
\end{array}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-pu1">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-pu1" title="Permalink to this equation"> </a></span>\[u^{\ell+1} = \sum_{i=1}^{N_p} \pi_i u_i^\ell\]</div>
<p>After discretization with the Lagrange finite element method, with a compatible mesh <span class="math notranslate nohighlight">\({\mathcal{T}_h}_i\)</span> of <span class="math notranslate nohighlight">\(\Omega_i\)</span>, i. e., the exist a global mesh <span class="math notranslate nohighlight">\({\mathcal{T}_h}\)</span> such that <span class="math notranslate nohighlight">\({\mathcal{T}_h}_i\)</span> is include in <span class="math notranslate nohighlight">\({\mathcal{T}_h}\)</span>.</p>
<p>Let us denote:</p>
<ul>
<li><p class="first"><span class="math notranslate nohighlight">\({V_h}_i\)</span> the finite element space corresponding to domain <span class="math notranslate nohighlight">\(\Omega_i\)</span>,</p>
</li>
<li><p class="first"><span class="math notranslate nohighlight">\({\mathcal{N}_h}_i\)</span> is the set of the degree of freedom <span class="math notranslate nohighlight">\(\sigma_i^k\)</span>,</p>
</li>
<li><p class="first"><span class="math notranslate nohighlight">\({\mathcal{N}^{\Gamma_i}_{hi}}\)</span> is the set of the degree of freedom of <span class="math notranslate nohighlight">\({V_h}_i\)</span> on the boundary <span class="math notranslate nohighlight">\(\Gamma_i\)</span> of <span class="math notranslate nohighlight">\(\Omega_i\)</span>,</p>
</li>
<li><p class="first"><span class="math notranslate nohighlight">\(\sigma_i^k({v_h})\)</span> is the value the degree of freedom <span class="math notranslate nohighlight">\(k\)</span>,</p>
</li>
<li><p class="first"><span class="math notranslate nohighlight">\({V_{0h}}_i= \{ {v_h} \in {V_h}_i :\forall k \in {\mathcal{N}^{\Gamma_i}_{hi}}, \quad \sigma_i^k({v_h})=0 \}\)</span>,</p>
</li>
<li><p class="first">The conditional expression <span class="math notranslate nohighlight">\(a\;?\;b:c\)</span> is defined like in :c`C` of <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">C</span><span class="p">++</span></code> language by</p>
<div class="math notranslate nohighlight">
\[\begin{split}a?b: c \equiv
\left\{
\begin{array}{l}
\mbox{if } a \mbox{ is true then return b}\\
\mbox{else return } c\\
\end{array}
\right..\end{split}\]</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We never use finite element space associated to the full domain <span class="math notranslate nohighlight">\(\Omega\)</span> because it is too expensive.</p>
</div>
<p>We have to defined to operator to build the previous algorithm:</p>
<p>We denote <span class="math notranslate nohighlight">\({u_h^{\ell}}_{|i}\)</span> the restriction of <span class="math notranslate nohighlight">\(u_h^\ell\)</span> on <span class="math notranslate nohighlight">\({V_h}_i\)</span>, so the discrete problem on <span class="math notranslate nohighlight">\(\Omega_i\)</span> of problem <a class="reference internal" href="#equation-eq-lapl">(37)</a> is find <span class="math notranslate nohighlight">\({u_h^{\ell}}_{i}\in {V_h}_i\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\forall {v_h}_i\in V_{0i}:
\int_{\Omega_i} \nabla {v_h}_i \cdot \nabla {u_h}^{\ell}_{i}
= \int_{\Omega_i} f {v_h}_i ,\quad \forall k \in {\mathcal{N}^{\Gamma_i}_{hi}}\;:\; \sigma_i^k({u_h}^\ell_i) = (k\in \Gamma) \; ? \; g_i^k : \sigma_i^k({u_h}^{\ell}_{|i})\]</div>
<p>where <span class="math notranslate nohighlight">\(g_i^k\)</span> is the value of <span class="math notranslate nohighlight">\(g\)</span> associated to the degree of freedom <span class="math notranslate nohighlight">\(k\in {\mathcal{N}^{\Gamma_i}_{hi}}\)</span>.</p>
<p>In <strong>FreeFEM</strong>, it can be written has with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">U</span></code> is the vector corresponding to <span class="math notranslate nohighlight">\({u_h^{\ell}}_{|i}\)</span> and the vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">U1</span></code> is the vector corresponding to <span class="math notranslate nohighlight">\({u_h^{\ell}}_{i}\)</span> is the solution of:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">U1</span><span class="p">(</span><span class="n">Ui</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="p">.</span><span class="o">*</span> <span class="n">U</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="o">?</span> <span class="nl">b</span> <span class="o">:</span> <span class="n">Bi</span> <span class="p">;</span>
<span class="n">U1</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>where <span class="math notranslate nohighlight">\(\mathtt{onG}[i] =(i \in \Gamma_i\setminus\Gamma) ? 1 : 0\)</span>, and <span class="math notranslate nohighlight">\(\mathtt{Bi}\)</span> the right of side of the problem, are defined by</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Whi</span><span class="p">(</span><span class="n">Thi</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>

<span class="c1">// Problem</span>
<span class="kt">varf</span> <span class="nf">vPb</span> <span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Thi</span><span class="p">)(</span>
          <span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">grad</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Thi</span><span class="p">)(</span>
          <span class="n">F</span><span class="o">*</span><span class="n">V</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
    <span class="p">;</span>

<span class="kt">varf</span> <span class="nf">vPbon</span> <span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span> <span class="o">=</span> <span class="nf">on</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="kt">matrix</span> <span class="n">Ai</span> <span class="o">=</span> <span class="n">vPb</span> <span class="p">(</span><span class="n">Whi</span><span class="p">,</span> <span class="n">Whi</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">onG</span> <span class="o">=</span> <span class="n">vPbon</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Whi</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Bi</span><span class="o">=</span><span class="n">vPb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Whi</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>where the <strong>FreeFEM</strong> label of <span class="math notranslate nohighlight">\(\Gamma\)</span> is 1 and the label of <span class="math notranslate nohighlight">\(\Gamma_i\setminus \Gamma\)</span> is <span class="math notranslate nohighlight">\(10\)</span>.</p>
<p>To build the transfer/update part corresponding to <a class="reference internal" href="#equation-eq-pu1">(38)</a> equation on process <span class="math notranslate nohighlight">\(i\)</span>, let us call <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">njpart</span></code> the number the neighborhood of domain of <span class="math notranslate nohighlight">\(\Omega_i\)</span> (i.e: <span class="math notranslate nohighlight">\(\pi_j\)</span> is none <span class="math notranslate nohighlight">\(0\)</span> of <span class="math notranslate nohighlight">\(\Omega_i\)</span>), we store in an array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">jpart</span></code> of size <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">njpart</span></code> all this neighborhood.</p>
<p>Let us introduce two array of matrix, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Smj</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></code> to defined the vector to send from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> a neighborhood process, and the matrix <span class="math notranslate nohighlight">\(rMj[j]\)</span> to after to reduce owith neighborhood <span class="math notranslate nohighlight">\(j\)</span> domain.</p>
<p>So the tranfert and update part compute <span class="math notranslate nohighlight">\(v_i= \pi_i u_i + \sum_{j\in J_i} \pi_j u_j\)</span> and can be write the <strong>FreeFEM</strong> function Update:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">bool</span> <span class="nf">Update</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">ui</span><span class="p">,</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">vi</span><span class="p">){</span>
    <span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="n">jpart</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">njpart</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">Usend</span><span class="p">[</span><span class="n">j</span><span class="p">][]</span> <span class="o">=</span> <span class="n">sMj</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">ui</span><span class="p">;</span>
    <span class="kt">mpiRequest</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rq</span><span class="p">(</span><span class="kr">n</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="nf">Irecv</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="n">jpart</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">comm</span><span class="p">,</span><span class="n">rq</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">Ri</span><span class="p">[</span><span class="n">j</span><span class="p">][]);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="nf">Isend</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="n">jpart</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">comm</span><span class="p">,</span> <span class="n">rq</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="kr">n</span><span class="p">]),</span> <span class="n">Si</span><span class="p">[</span><span class="n">j</span><span class="p">][]);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="nf">mpiWaitAny</span><span class="p">(</span><span class="n">rq</span><span class="p">);</span>
    <span class="c1">// apply the unity local partition</span>
    <span class="n">vi</span> <span class="o">=</span> <span class="n">Pii</span><span class="o">*</span><span class="n">ui</span><span class="p">;</span> <span class="c1">//set to pi_i u_i</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">njpart</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">vi</span> <span class="o">+=</span> <span class="n">rMj</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">Vrecv</span><span class="p">[</span><span class="n">j</span><span class="p">][];</span> <span class="c1">//add pi_j u_j</span>
    <span class="k">return</span> <span class="kr">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>where the buffer are defined by:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">InitU</span><span class="p">(</span><span class="n">njpart</span><span class="p">,</span> <span class="n">Whij</span><span class="p">,</span> <span class="n">Thij</span><span class="p">,</span> <span class="n">aThij</span><span class="p">,</span> <span class="n">Usend</span><span class="p">)</span> <span class="c1">//defined the send buffer</span>
<span class="n">InitU</span><span class="p">(</span><span class="n">njpart</span><span class="p">,</span> <span class="n">Whij</span><span class="p">,</span> <span class="n">Thij</span><span class="p">,</span> <span class="n">aThij</span><span class="p">,</span> <span class="n">Vrecv</span><span class="p">)</span> <span class="c1">//defined the revc buffer</span>
</pre></div>
</td></tr></table></div>
<p>with the following macro definition:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="nf">InitU</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="n">Vh</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">aTh</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span> <span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">U</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span> <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">){</span><span class="n">Th</span> <span class="o">=</span> <span class="n">aTh</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
</pre></div>
</td></tr></table></div>
<p><em>First GMRES algorithm:</em> you can easily accelerate the fixed point algorithm by using a parallel GMRES algorithm after the introduction the following affine <span class="math notranslate nohighlight">\(\mathcal{A}_i\)</span> operator sub domain <span class="math notranslate nohighlight">\(\Omega_i\)</span>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">DJ0</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">){</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="kr">n</span><span class="p">),</span> <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="p">.</span><span class="o">*</span> <span class="n">U</span><span class="p">;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="o">?</span> <span class="nl">b</span> <span class="o">:</span> <span class="n">Bi</span> <span class="p">;</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="n">Update</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">U</span><span class="p">);</span>
    <span class="n">V</span> <span class="o">-=</span> <span class="n">U</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">V</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Where the parallel <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIGMRES</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPICG</span></code> algorithm is just a simple way to solve in parallel the following <span class="math notranslate nohighlight">\(A_i x_i = b_i, i = 1, .., N_p\)</span> by just changing the dot product by reduce the local dot product of all process with the following MPI code:</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">template</span><span class="p">&lt;</span><span class="n">class</span> <span class="n">R</span><span class="p">&gt;</span> <span class="nb">R </span><span class="n">ReduceSum1</span><span class="p">(</span><span class="nb">R </span><span class="n">s</span><span class="p">,</span> <span class="n">MPI_Comm</span> <span class="p">*</span><span class="n">comm</span><span class="p">){</span>
    <span class="nb">R r </span><span class="p">=</span> <span class="n">0</span><span class="p">;</span>
    <span class="n">MPI_Allreduce</span><span class="p">(&amp;</span><span class="n">s</span><span class="p">,</span> <span class="p">&amp;</span><span class="n">r</span><span class="p">,</span> <span class="n">1</span><span class="p">,</span> <span class="n">MPI_TYPE</span><span class="p">&lt;</span><span class="n">R</span><span class="p">&gt;::</span><span class="n">TYPE</span><span class="p">(),</span> <span class="n">MPI_SUM</span><span class="p">,</span> <span class="p">*</span><span class="n">comm</span> <span class="p">);</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This is done in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIGC</span></code> dynamics library tool.</p>
<p><em>Second GMRES algorithm:</em> Use scharwz algorithm as a preconditioner of basic GMRES method to solving the parallel problem.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">DJ</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">){</span> <span class="c1">//the original problem</span>
    <span class="o">++</span><span class="n">kiter</span><span class="p">;</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">*</span><span class="n">U</span><span class="p">;</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">onGi</span> <span class="o">?</span> <span class="mf">0.</span><span class="o">:</span> <span class="n">V</span><span class="p">;</span> <span class="c1">//remove boundary term</span>
    <span class="k">return</span> <span class="n">V</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">PDJ</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">){</span> <span class="c1">//the preconditioner</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="o">?</span> <span class="mf">0.</span> <span class="o">:</span> <span class="n">U</span><span class="p">;</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="n">Update</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">U</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><em>Third GMRES algorithm:</em> Add a coarse solver to the previous algorithm</p>
<p>First build a coarse grid on processor 0, and the</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="n">AC</span><span class="p">,</span> <span class="n">Rci</span><span class="p">,</span> <span class="n">Pci</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nf">mpiRank</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">AC</span> <span class="o">=</span> <span class="n">vPbC</span><span class="p">(</span><span class="n">VhC</span><span class="p">,</span> <span class="n">VhC</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span> <span class="c1">//the coarse problem</span>

<span class="n">Pci</span> <span class="o">=</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">Whi</span><span class="p">,</span> <span class="n">VhC</span><span class="p">);</span> <span class="c1">//the projection on coarse grid</span>
<span class="n">Rci</span> <span class="o">=</span> <span class="n">Pci</span><span class="o">&#39;*</span><span class="n">Pii</span><span class="p">;</span> <span class="c1">//the restriction on Process i grid with the partition pi_i</span>

<span class="kt">func</span> <span class="kt">bool</span> <span class="nf">CoarseSolve</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">V</span><span class="p">,</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">,</span> <span class="kt">mpiComm</span><span class="o">&amp;</span> <span class="n">comm</span><span class="p">){</span>
    <span class="c1">// solving the coarse problem</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Uc</span><span class="p">(</span><span class="n">Rci</span><span class="p">.</span><span class="kr">n</span><span class="p">),</span> <span class="n">Bc</span><span class="p">(</span><span class="n">Uc</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
    <span class="n">Uc</span> <span class="o">=</span> <span class="n">Rci</span><span class="o">*</span><span class="n">U</span><span class="p">;</span>
    <span class="nf">mpiReduce</span><span class="p">(</span><span class="n">Uc</span><span class="p">,</span> <span class="n">Bc</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="kr">mpiSUM</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nf">mpiRank</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">Uc</span> <span class="o">=</span> <span class="n">AC</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">Bc</span><span class="p">;</span>
    <span class="nf">broadcast</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="n">Uc</span><span class="p">);</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Pci</span><span class="o">*</span><span class="n">Uc</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The New preconditionner</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">PDJC</span> <span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">U</span><span class="p">){</span>
    <span class="c1">// Idea: F. Nataf.</span>
    <span class="c1">// 0 ~ (I C1A)(I-C2A) =&gt; I ~ - C1AC2A +C1A +C2A</span>
    <span class="c1">// New Prec P= C1+C2 - C1AC2 = C1(I- A C2) +C2</span>
    <span class="c1">// ( C1(I- A C2) +C2 ) Uo</span>
    <span class="c1">// V = - C2*Uo</span>
    <span class="c1">// ....</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
    <span class="n">CoarseSolve</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">comm</span><span class="p">);</span>
    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">V</span><span class="p">;</span> <span class="c1">//-C2*Uo</span>
    <span class="n">U</span> <span class="o">+=</span> <span class="n">Ai</span><span class="o">*</span><span class="n">V</span><span class="p">;</span> <span class="c1">//U = (I-A C2) Uo</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="o">?</span> <span class="mf">0.</span> <span class="o">:</span> <span class="n">U</span><span class="p">;</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span> <span class="c1">//C1( I -A C2) Uo</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">U</span> <span class="o">-</span> <span class="n">V</span><span class="p">;</span>
    <span class="n">Update</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">U</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">U</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The code of the 4 algorithms:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">epss</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">rgmres</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">gmres</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
    <span class="n">rgmres</span> <span class="o">=</span> <span class="n">MPIAffineGMRES</span><span class="p">(</span><span class="n">DJ0</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="kp">veps</span><span class="o">=</span><span class="n">epss</span><span class="p">,</span> <span class="kp">nbiter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
        <span class="n">comm</span><span class="o">=</span><span class="n">comm</span><span class="p">,</span> <span class="nf">dimKrylov</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="kr">verbosity</span><span class="o">=</span><span class="n">ipart</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span> <span class="mi">50</span><span class="p">);</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="p">.</span><span class="o">*</span> <span class="n">u</span><span class="p">[];</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">onG</span> <span class="o">?</span> <span class="nl">b</span> <span class="o">:</span> <span class="n">Bi</span> <span class="p">;</span>
    <span class="n">v</span><span class="p">[]</span> <span class="o">=</span> <span class="n">Ai</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="n">Update</span><span class="p">(</span><span class="n">v</span><span class="p">[],</span> <span class="n">u</span><span class="p">[]);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">gmres</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">rgmres</span> <span class="o">=</span> <span class="n">MPILinearGMRES</span><span class="p">(</span><span class="n">DJ</span><span class="p">,</span> <span class="kp">precon</span><span class="o">=</span><span class="n">PDJ</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">Bi</span><span class="p">,</span> <span class="kp">veps</span><span class="o">=</span><span class="n">epss</span><span class="p">,</span>
        <span class="kp">nbiter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">comm</span><span class="p">,</span> <span class="nf">dimKrylov</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="kr">verbosity</span><span class="o">=</span><span class="n">ipart</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span> <span class="mi">50</span><span class="p">);</span>
<span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">gmres</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">rgmres</span> <span class="o">=</span> <span class="n">MPILinearGMRES</span><span class="p">(</span><span class="n">DJ</span><span class="p">,</span> <span class="kp">precon</span><span class="o">=</span><span class="n">PDJC</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">Bi</span><span class="p">,</span> <span class="kp">veps</span><span class="o">=</span><span class="n">epss</span><span class="p">,</span>
        <span class="kp">nbiter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">comm</span><span class="o">=</span><span class="n">comm</span><span class="p">,</span> <span class="nf">dimKrylov</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="kr">verbosity</span><span class="o">=</span><span class="n">ipart</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span> <span class="mi">50</span><span class="p">);</span>
<span class="k">else</span> <span class="c1">//algo Shwarz for demo</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iter</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="o">++</span><span class="n">iter</span><span class="p">)</span>
        <span class="p">...</span>
</pre></div>
</td></tr></table></div>
<p>We have all ingredient to solve in parallel if we have et the partitions of the unity.
To build this partition we do:</p>
<p>The initial step on process <span class="math notranslate nohighlight">\(1\)</span> to build a coarse mesh, <span class="math notranslate nohighlight">\({\mathcal{T}_h}^*\)</span> of the full domain, and build the partition <span class="math notranslate nohighlight">\(\pi\)</span> function constant equal to <span class="math notranslate nohighlight">\(i\)</span> on each sub domain <span class="math notranslate nohighlight">\(\mathcal{O}_i, i =1 ,.., N_p\)</span>, of the grid with the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">metis</span></code> graph partitioner <a class="reference internal" href="../reference.html#karypis1995" id="id1">[KARYPIS1995]</a> and on each process <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(1..,N_p\)</span> do</p>
<ol class="arabic">
<li><p class="first">Broadcast from process <span class="math notranslate nohighlight">\(1\)</span>, the mesh <span class="math notranslate nohighlight">\({\mathcal{T}_h}^*\)</span> (call <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Thii</span></code> in <strong>FreeFEM</strong> script), and <span class="math notranslate nohighlight">\(\pi\)</span> function,</p>
</li>
<li><p class="first">remark that the characteristic function <span class="math notranslate nohighlight">\(\mathrm{1\!\!I}_{\mathcal{O}_i}\)</span> of domain <span class="math notranslate nohighlight">\(\mathcal{O}_i\)</span>, is defined by <span class="math notranslate nohighlight">\((\pi=i)?1:0\)</span>,</p>
</li>
<li><p class="first">Let us call <span class="math notranslate nohighlight">\(\Pi^2_P\)</span> (resp. <span class="math notranslate nohighlight">\(\Pi^2_V\)</span>) the <span class="math notranslate nohighlight">\(L^2\)</span> on <span class="math notranslate nohighlight">\(P_h^*\)</span> the space of the constant finite element function per element on <span class="math notranslate nohighlight">\({\mathcal{T}_h}^*\)</span> (resp. <span class="math notranslate nohighlight">\(V_h^*\)</span> the space of the affine continuous finite element per element on <span class="math notranslate nohighlight">\({\mathcal{T}_h}^*\)</span>) and build in parallel the <span class="math notranslate nohighlight">\(\pi_i\)</span> and <span class="math notranslate nohighlight">\(\Omega_i\)</span>, such that <span class="math notranslate nohighlight">\(\mathcal{O}_i\ \subset \Omega_i\)</span> where <span class="math notranslate nohighlight">\(\mathcal{O}_i= supp ((\Pi^2_V \Pi^2_C)^m \mathrm{1\!\!I}_{O_i})\)</span>, and <span class="math notranslate nohighlight">\(m\)</span> is a the overlaps size on the coarse mesh (generally one), (this is done in function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">AddLayers</span><span class="p">(</span><span class="n">Thii</span><span class="p">,</span><span class="n">suppii</span><span class="p">[],</span><span class="n">nlayer</span><span class="p">,</span><span class="n">phii</span><span class="p">[]);</span></code> We choose a function <span class="math notranslate nohighlight">\(\pi^*_i = (\Pi^2_1 \Pi^2_0)^m \mathrm{1\!\!I}_{\mathcal{O}_i}\)</span> so the partition of the unity is simply defined by</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\pi_i = \frac{\pi_i^*}{\sum_{j=1}^{N_p} \pi_j^*}\]</div>
<p>The set <span class="math notranslate nohighlight">\(J_i\)</span> of neighborhood of the domain <span class="math notranslate nohighlight">\(\Omega_i\)</span>, and the local version on <span class="math notranslate nohighlight">\(V_{hi}\)</span> can be defined the array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">jpart</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">njpart</span></code> with:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Vhi</span> <span class="n">pii</span> <span class="o">=</span> <span class="n">piistar</span><span class="p">;</span>
<span class="n">Vhi</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">pij</span><span class="p">(</span><span class="n">npij</span><span class="p">);</span> <span class="c1">//local partition of 1 = pii + sum_j pij[j]</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">jpart</span><span class="p">(</span><span class="n">npart</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">njpart</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">Vhi</span> <span class="n">sumphi</span> <span class="o">=</span> <span class="n">piistar</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">npart</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">ipart</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">int3d</span><span class="p">(</span><span class="n">Thi</span><span class="p">)(</span><span class="n">pijstar</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">pij</span><span class="p">[</span><span class="n">njpart</span><span class="p">]</span> <span class="o">=</span> <span class="n">pijstar</span><span class="p">;</span>
            <span class="n">sumphi</span><span class="p">[]</span> <span class="o">+=</span> <span class="n">pij</span><span class="p">[</span><span class="n">njpart</span><span class="p">][];</span>
            <span class="n">jpart</span><span class="p">[</span><span class="n">njpart</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="n">pii</span><span class="p">[]</span> <span class="o">=</span> <span class="n">pii</span><span class="p">[]</span> <span class="p">.</span><span class="o">/</span> <span class="n">sumphi</span><span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">njpart</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="n">pij</span><span class="p">[</span><span class="n">j</span><span class="p">][]</span> <span class="o">=</span> <span class="n">pij</span><span class="p">[</span><span class="n">j</span><span class="p">][]</span> <span class="p">.</span><span class="o">/</span> <span class="n">sumphi</span><span class="p">[];</span>
<span class="n">jpart</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">njpart</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</li>
<li><p class="first">We call <span class="math notranslate nohighlight">\({\mathcal{T}_h}^*_{ij}\)</span> the sub mesh part of <span class="math notranslate nohighlight">\({\mathcal{T}_h}_i\)</span> where <span class="math notranslate nohighlight">\(\pi_j\)</span> are none zero.
And thanks to the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> to build this array,</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">jp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">jp</span> <span class="o">&lt;</span> <span class="n">njpart</span><span class="p">;</span> <span class="o">++</span><span class="n">jp</span><span class="p">)</span>
    <span class="n">aThij</span><span class="p">[</span><span class="n">jp</span><span class="p">]</span> <span class="o">=</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">Thi</span><span class="p">,</span> <span class="n">pij</span><span class="p">[</span><span class="n">jp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</li>
<li><p class="first">At this step we have all on the coarse mesh, so we can build the fine final mesh by splitting all meshes: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Thi</span><span class="p">,</span> <span class="n">Thij</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Thij</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></code> with <strong>FreeFEM</strong> <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> mesh function which do restriction and slipping.</p>
</li>
<li><p class="first">The construction of the send/recv matrices <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">sMj</span></code> and <cite>freefem:`rMj</cite>: can done with this code:</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Thij</span> <span class="o">=</span> <span class="n">Thi</span><span class="p">;</span>
<span class="kt">fespace</span> <span class="nf">Whij</span><span class="p">(</span><span class="n">Thij</span><span class="p">,</span> <span class="n">Pk</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="n">Pii</span><span class="p">;</span> <span class="n">Whi</span> <span class="n">wpii</span> <span class="o">=</span> <span class="n">pii</span><span class="p">;</span> <span class="n">Pii</span> <span class="o">=</span> <span class="n">wpii</span><span class="p">[];</span> <span class="c1">//Diagonal matrix corresponding X pi_i</span>
<span class="kt">matrix</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">sMj</span><span class="p">(</span><span class="n">njpart</span><span class="p">),</span> <span class="n">rMj</span><span class="p">(</span><span class="n">njpart</span><span class="p">);</span> <span class="c1">//M send/recive case</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">jp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">jp</span> <span class="o">&lt;</span> <span class="n">njpart</span><span class="p">;</span> <span class="o">++</span><span class="n">jp</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">jpart</span><span class="p">[</span><span class="n">jp</span><span class="p">];</span>
    <span class="n">Thij</span> <span class="o">=</span> <span class="n">aThij</span><span class="p">[</span><span class="n">jp</span><span class="p">];</span> <span class="c1">//change mesh to change Whij, Whij</span>
    <span class="kt">matrix</span> <span class="n">I</span> <span class="o">=</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">Whij</span><span class="p">,</span> <span class="n">Whi</span><span class="p">);</span> <span class="c1">//Whij &lt;- Whi</span>
    <span class="n">sMj</span><span class="p">[</span><span class="n">jp</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="o">*</span><span class="n">Pii</span><span class="p">;</span> <span class="c1">//Whi -&gt; s Whij</span>
    <span class="n">rMj</span><span class="p">[</span><span class="n">jp</span><span class="p">]</span> <span class="o">=</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">Whij</span><span class="p">,</span> <span class="n">Whi</span><span class="p">,</span> <span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//Whij -&gt; Whi</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</li>
</ol>
<p>To buil a not too bad application, all variables come from parameters value with the following code</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">include</span> <span class="s">&quot;getARGV.idp&quot;</span>
<span class="kr">verbosity</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-vv&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">vdebug</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-d&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ksplit</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-k&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">nloc</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-n&quot;</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
<span class="kt">string</span> <span class="n">sff</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-p, &quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">gmres</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-gmres&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">dplot</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-dp&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">nC</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-N&quot;</span><span class="p">,</span> <span class="kr">max</span><span class="p">(</span><span class="n">nloc</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
</pre></div>
</td></tr></table></div>
<p>And small include to make graphic in parallel of distribute solution of vector <span class="math notranslate nohighlight">\(u\)</span> on mesh <span class="math notranslate nohighlight">\(T_h\)</span> with the following interface:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">include</span> <span class="s">&quot;MPIplot.idp&quot;</span>
<span class="kt">func</span> <span class="kt">bool</span> <span class="n">plotMPIall</span><span class="p">(</span><span class="kt">mesh</span> <span class="o">&amp;</span><span class="n">Th</span><span class="p">,</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="kt">string</span> <span class="n">cm</span><span class="p">){</span>
    <span class="n">PLOTMPIALL</span><span class="p">(</span><span class="kt">mesh</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="p">{</span><span class="kp">cmm</span><span class="o">=</span><span class="n">cm</span><span class="p">,</span> <span class="kp">nbiso</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="mi">1</span><span class="p">});</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cmm</span><span class="o">=</span><span class="n">cm</span><span class="p">,</span> <span class="p">...</span></code> in the macro argument is a way to quote macro argument so the argument is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cmm</span><span class="o">=</span><span class="n">cm</span><span class="p">,</span> <span class="p">...</span></code>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-sparse-solvers">
<span id="parallelsparsesolvers"></span><h2>Parallel sparse solvers<a class="headerlink" href="#parallel-sparse-solvers" title="Permalink to this headline"> </a></h2>
<p>Parallel sparse solvers use several processors to solve linear systems of equation. Like sequential, parallel linear solvers can be direct or iterative. In <strong>FreeFEM</strong> both are available.</p>
<div class="section" id="using-parallel-sparse-solvers-in-freefem">
<h3>Using parallel sparse solvers in <strong>FreeFEM</strong><a class="headerlink" href="#using-parallel-sparse-solvers-in-freefem" title="Permalink to this headline"> </a></h3>
<p>We recall that the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span></code> parameters are defined in the following commands: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">solve</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">problem</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">set</span></code> (setting parameter of a matrix) and in the construction of the matrix corresponding to a bilinear form.
In these commands, the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span></code> must be set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> for parallel sparse solver.
We have added specify parameters to these command lines for parallel sparse solvers.
These are:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code> : vector of integer parameters (<code class="docutils literal highlight highlight-freefem"><span></span><span class="n">l</span></code> is for the <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">C</span><span class="o">++</span></code> type <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">long</span></code>)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code> : vector of real parameters</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code> : string parameters</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">datafilename</span></code> : name of the file which contains solver parameters</li>
</ul>
<p>The following four parameters are only for direct solvers and are vectors.
These parameters allow the user to preprocess the matrix (see the section on <a class="reference external" href="#sparse-direct-solver">sparse direct solver</a> for more information).</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permr</span></code> : row permutation (integer vector)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permc</span></code> : column permutation or inverse row permutation (integer vector)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scaler</span></code> : row scaling (real vector)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scalec</span></code> : column scaling (real vector)</li>
</ul>
<p>There are two possibilities to control solver parameters.
The first method defines parameters with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code> in <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">edp</span></code> file.</p>
<p>The second one reads the solver parameters from a data file. The name of this file is specified by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">datafilename</span></code>.
If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">datafilename</span></code> is not provided by the user, the solver’s default values are used.</p>
<p>To use parallel solver in <strong>FreeFEM</strong>, we need to load the dynamic library corresponding to this solver.
For example to use <a class="reference external" href="http://mumps.enseeiht.fr/">MUMPS</a> solver as parallel solver in <strong>FreeFEM</strong>, write in the <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">edp</span></code> file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span> <span class="s">&quot;MUMPS_FreeFem&quot;</span></code>.</p>
<p>If the libraries are not loaded, the default sparse solver will be loaded (default sparse solver is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code>). The <a class="reference internal" href="#tabparallelizationsparsesolver"><span class="std std-numref">Table 2</span></a> gives this new value for the different libraries.</p>
<table border="1" class="docutils" id="tabparallelizationsparsesolver">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Default sparse solver for real and complex arithmetics when we load a parallel sparse solver library</span><a class="headerlink" href="#tabparallelizationsparsesolver" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="47%" />
<col width="27%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Libraries</th>
<th class="head" colspan="2">Default sparse solver</th>
</tr>
<tr class="row-even"><th class="head">&#160;</th>
<th class="head">real</th>
<th class="head">complex</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>MUMPS_FreeFem</td>
<td>mumps</td>
<td>mumps</td>
</tr>
<tr class="row-even"><td>real_SuperLU_DIST_FreeFem</td>
<td>SuperLU_DIST</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>complex_SuperLU_DIST_FreeFem</td>
<td>previous solver</td>
<td>SuperLU_DIST</td>
</tr>
<tr class="row-even"><td>real_pastix_FreeFem</td>
<td>PaStiX</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>complex_pastix_FreeFem</td>
<td>previous solver</td>
<td>PaStiX</td>
</tr>
<tr class="row-even"><td>hips_FreeFem</td>
<td>hips</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>hypre_FreeFem</td>
<td>hypre</td>
<td>previous solver</td>
</tr>
<tr class="row-even"><td>parms_FreeFem</td>
<td>parms</td>
<td>previous solver</td>
</tr>
</tbody>
</table>
<p>We also add functions (see <a class="reference internal" href="#tabparallelizationfunction"><span class="std std-numref">Table 3</span></a>) with no parameter to change the default sparse solver in the <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">edp</span></code> file.
To use these functions, we need to load the library corresponding to the solver.
An example of using different parallel sparse solvers for the same problem is given in <a class="reference internal" href="../example/parallelization.html#exampledirectsolvers"><span class="std std-ref">Direct solvers example</span></a>.</p>
<table border="1" class="docutils" id="tabparallelizationfunction">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Functions that allow to change the default sparse solver for real and complex arithmetics and the result of these functions</span><a class="headerlink" href="#tabparallelizationfunction" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="48%" />
<col width="26%" />
<col width="26%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head" colspan="2">default sparse solver</th>
</tr>
<tr class="row-even"><th class="head">&#160;</th>
<th class="head">real</th>
<th class="head">complex</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>defaulttoMUMPS()</td>
<td>mumps</td>
<td>mumps</td>
</tr>
<tr class="row-even"><td>realdefaulttoSuperLUdist()</td>
<td>SuperLU_DIST</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>complexdefaulttoSuperLUdist()</td>
<td>previous solver</td>
<td>SuperLU_DIST</td>
</tr>
<tr class="row-even"><td>realdefaultopastix()</td>
<td>pastix</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>complexdefaulttopastix()</td>
<td>previous solver</td>
<td>pastix</td>
</tr>
<tr class="row-even"><td>defaulttohips()</td>
<td>hips</td>
<td>previous solver</td>
</tr>
<tr class="row-odd"><td>defaulttohypre()</td>
<td>hypre</td>
<td>previous solver</td>
</tr>
<tr class="row-even"><td>defaulttoparms()</td>
<td>parms</td>
<td>previous solver</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Test direct solvers</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;MUMPS_FreeFem&quot;</span>
<span class="c1">//default solver: real-&gt; MUMPS, complex -&gt; MUMPS</span>
<span class="cp">load</span> <span class="s">&quot;real_SuperLU_DIST_FreeFem&quot;</span>
<span class="c1">//default solver: real-&gt; SuperLU_DIST,</span>
<span class="kt">complex</span> <span class="o">-&gt;</span> <span class="n">MUMPS</span> <span class="cp">load</span> <span class="s">&quot;real_pastix_FreeFem&quot;</span>
<span class="c1">//default solver: real-&gt; pastix, complex -&gt; MUMPS</span>

<span class="c1">// Solving with pastix</span>
<span class="p">{</span>
    <span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span>
        <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">22</span><span class="p">]];</span>

    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="kr">x</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">di</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="kp">A</span><span class="o">*</span><span class="n">xx</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span> <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xx</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">datafilename</span><span class="o">=</span><span class="s">&quot;ffpastix_iparm_dparm.txt&quot;</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="kt">solve</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">x</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="kr">x</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="n">di</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">-</span> <span class="kr">x</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x-xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Linf =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">linfty</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, L2 =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">l2</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Solving with SuperLU_DIST</span>
<span class="n">realdefaulttoSuperLUdist</span><span class="p">();</span>
<span class="c1">//default solver: real-&gt; SuperLU_DIST, complex -&gt; MUMPS</span>
<span class="p">{</span>
    <span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span>
        <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">22</span><span class="p">]];</span>

    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="kr">x</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">di</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="kp">A</span><span class="o">*</span><span class="n">xx</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xx</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">datafilename</span><span class="o">=</span><span class="s">&quot;ffsuperlu_dist_fileparam.txt&quot;</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="kt">solve</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">x</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="kr">x</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="n">di</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">-</span> <span class="kr">x</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x-xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Linf =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">linfty</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, L2 =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">l2</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Solving with MUMPS</span>
<span class="n">defaulttoMUMPS</span><span class="p">();</span>
<span class="c1">//default solver: real-&gt; MUMPS, complex -&gt; MUMPS</span>
<span class="p">{</span>
    <span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span>
        <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">22</span><span class="p">]];</span>

    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="kr">x</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">di</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
    <span class="n">b</span> <span class="o">=</span> <span class="kp">A</span><span class="o">*</span><span class="n">xx</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xx</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">datafilename</span><span class="o">=</span><span class="s">&quot;ffmumps_fileparam.txt&quot;</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;solving solution&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">x</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;b =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="kr">x</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="n">di</span> <span class="o">=</span> <span class="n">xx</span> <span class="o">-</span> <span class="kr">x</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x-xx =&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Linf =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">linfty</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, L2&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">di</span><span class="p">.</span><span class="kr">l2</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="sparse-direct-solver">
<h3>Sparse direct solver<a class="headerlink" href="#sparse-direct-solver" title="Permalink to this headline"> </a></h3>
<p>In this section, we present the sparse direct solvers interfaced with <strong>FreeFEM</strong>.</p>
<div class="section" id="mumps-solver">
<h4>MUMPS solver<a class="headerlink" href="#mumps-solver" title="Permalink to this headline"> </a></h4>
<p>MUltifrontal Massively Parallel Solver (<a class="reference external" href="http://mumps.enseeiht.fr/">MUMPS</a>) is an open-source library.</p>
<p>This package solves linear system of the form <span class="math notranslate nohighlight">\(A \: x = b\)</span> where <span class="math notranslate nohighlight">\(A\)</span> is a square sparse matrix with a direct method.
The square matrix considered in MUMPS can be either unsymmetric, symmetric positive definite or general symmetric.</p>
<p>The method implemented in MUMPS is a direct method based on a multifrontal approach.
It constructs a direct factorization <span class="math notranslate nohighlight">\(A \:= \: L\:U\)</span>, <span class="math notranslate nohighlight">\(A\: = \: L^t \: D \: L\)</span> depending of the symmetry of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<dl class="docutils">
<dt>MUMPS uses the following libraries :</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.netlib.org/blas/">BLAS</a>,</li>
<li><a class="reference external" href="http://www.netlib.org/blacs/">BLACS</a>,</li>
<li><a class="reference external" href="http://www.netlib.org/scalapack/">ScaLAPACK</a>.</li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">MUMPS does not solve linear system with a rectangular matrix.</p>
</div>
<p><strong>MUMPS parameters:</strong></p>
<p>There are four input parameters in <a class="reference external" href="http://mumps.enseeiht.fr/index.php?page=doc">MUMPS</a>.
Two integers <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">SYM</span></code> and <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">PAR</span></code>, a vector of integer of size 40 <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">INCTL</span></code> and a vector of real of size 15 <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">CNTL</span></code>.</p>
<p>The first parameter gives the type of the matrix: 0 for unsymmetric matrix, 1 for symmetric positive matrix and 2 for general symmetric.</p>
<p>The second parameter defined if the host processor work during the factorization and solves steps : <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">PAR</span><span class="p">=</span><span class="n">1</span></code> host processor working and <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">PAR</span><span class="p">=</span><span class="n">0</span></code> host processor not working.</p>
<p>The parameter <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">INCTL</span></code> and <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">CNTL</span></code> is the control parameter of MUMPS.
The vectors <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">ICNTL</span></code> and <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">CNTL</span></code> in MUMPS becomes with index 1 like vector in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Fortran</span></code>.
For more details see the <a class="reference external" href="http://mumps.enseeiht.fr/index.php?page=doc">MUMPS user’s guide</a>.</p>
<p>We describe now some elements of the main parameters of <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">ICNTL</span></code> for MUMPS.</p>
<ul>
<li><dl class="first docutils">
<dt><strong>Input matrix parameter</strong> The input matrix is controlled by parameters <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span></code>.</dt>
<dd><p class="first">The matrix format (resp. matrix pattern and matrix entries) are controlled by <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">INCTL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code> (resp. <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">INCTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span></code>).</p>
<p>The different values of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code> are 0 for assembled format and 1 for element format.
In the current release of <strong>FreeFEM</strong>, we consider that FE matrix or matrix is storage in assembled format.
Therefore, <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">INCTL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code> is treated as 0 value.</p>
<p>The main option for <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span></code>: <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">INCLTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span></code> centrally on the host processor, <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span></code> distributed the input matrix pattern and the entries (recommended option for distributed matrix by developer of MUMPS).
For other values of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span></code> see the <a class="reference external" href="http://mumps.enseeiht.fr/index.php?page=doc">MUMPS user’s guide</a>.
These values can be used also in <strong>FreeFEM</strong>.</p>
<p class="last">The default option implemented in <strong>FreeFEM</strong> are <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span></code>.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Preprocessing parameter</strong> The preprocessed matrix <span class="math notranslate nohighlight">\(A_{p}\)</span> that will be effectively factored is defined by</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[A_{p} = P \: D_r \: A \: Q_c \ D_c P^t\]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the permutation matrix, <span class="math notranslate nohighlight">\(Q_c\)</span> is the column permutation, <span class="math notranslate nohighlight">\(D_r\)</span> and <span class="math notranslate nohighlight">\(D_c\)</span> are diagonal matrix for respectively row and column scaling.</p>
<p>The ordering strategy to obtain <span class="math notranslate nohighlight">\(P\)</span> is controlled by parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span></code>.
The permutation of zero free diagonal <span class="math notranslate nohighlight">\(Q_c\)</span> is controlled by parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span></code>.
The row and column scaling is controlled by parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span></code>.
These option are connected and also strongly related with <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span></code> (see the <a class="reference external" href="http://mumps.enseeiht.fr/index.php?page=doc">MUMPS user’s guide</a> for more details).</p>
<p>The parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permr</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scaler</span></code>, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scalec</span></code> in <strong>FreeFEM</strong> allow to give permutation matrix(<span class="math notranslate nohighlight">\(P\)</span>), row scaling (<span class="math notranslate nohighlight">\(D_r\)</span>) and column scaling (<span class="math notranslate nohighlight">\(D_c\)</span>) of the user respectively.</p>
</div></blockquote>
</li>
</ul>
<p><strong>Calling MUMPS in FreeFEM</strong></p>
<p>To call MUMPS in <strong>FreeFEM</strong>, we need to load the dynamic library <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MUMPS_freefem</span><span class="p">.</span><span class="n">dylib</span></code> (MacOSX), <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MUMPS_freefem</span><span class="p">.</span><span class="n">so</span></code> (Unix) or <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MUMPS_freefem</span><span class="p">.</span><span class="n">dll</span></code> (Windows).</p>
<p>This is done in typing <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span> <span class="s">&quot;MUMPS_FreeFem&quot;</span></code> in the <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">edp</span></code> file. We give now the two methods to give the option of MUMPS solver in <strong>FreeFEM</strong>.</p>
<ul>
<li><dl class="first docutils">
<dt><strong>Solver parameters is defined in .edp file:</strong> In this method, we need to give the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code>.</dt>
<dd><p class="first">These parameters are defined for MUMPS by :</p>
<blockquote class="last">
<div><ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SYM</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">PAR</span></code>,</li>
<li><span class="math notranslate nohighlight">\(\forall i\)</span> = 1,…,40, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ICNTL</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></code></li>
<li><span class="math notranslate nohighlight">\(\forall i\)</span> = 1,…,15, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">CNTL</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></code></li>
</ul>
</div></blockquote>
</dd>
</dl>
</li>
<li><p class="first"><strong>Reading solver parameters on a file:</strong></p>
<blockquote>
<div><p>The structure of data file for MUMPS in <strong>FreeFEM</strong> is : first line parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">SYM</span></code> and second line parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">PAR</span></code> and in the following line the different value of vectors <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ICNTL</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">CNTL</span></code>.
An example of this parameter file is given in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ffmumpsfileparam</span><span class="p">.</span><span class="n">txt</span></code>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="cm">/* SYM :: 0 for non symmetric matrix, 1 for symmetric definite positive matrix and 2 general symmetric matrix*/</span>
<span class="mi">1</span> <span class="cm">/* PAR :: 0 host not working during factorization and solves steps, 1 host working during factorization and solves steps*/</span>
<span class="o">-</span><span class="mi">1</span> <span class="cm">/* ICNTL(1) :: output stream for error message */</span>
<span class="o">-</span><span class="mi">1</span> <span class="cm">/* ICNTL(2) :: output for diagnostic printing, statics and warning message */</span>
<span class="o">-</span><span class="mi">1</span> <span class="cm">/* ICNTL(3) :: for global information */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(4) :: Level of printing for error, warning and diagnostic message */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(5) :: matrix format : 0 assembled format, 1 elemental format. */</span>
<span class="mi">7</span> <span class="cm">/* ICNTL(6) :: control option for permuting and/or scaling the matrix in analysis phase */</span>
<span class="mi">3</span> <span class="cm">/* ICNTL(7) :: pivot order strategy : AMD, AMF, metis, pord scotch*/</span>
<span class="mi">77</span> <span class="cm">/* ICNTL(8) :: Row and Column scaling strategy */</span>
<span class="mi">1</span> <span class="cm">/* ICNTL(9) :: 0 solve Ax = b, 1 solve the transposed system A^t x = b : parameter is not considered in the current release of FreeFEM*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(10) :: number of steps of iterative refinement */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(11) :: statics related to linear system depending on ICNTL(9) */</span>
<span class="mi">1</span> <span class="cm">/* ICNTL(12) :: constrained ordering strategy for general symmetric matrix */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(13) :: method to control splitting of the root frontal matrix */</span>
<span class="mi">20</span> <span class="cm">/* ICNTL(14) :: percentage increase in the estimated working space (default 20\%)*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(15) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(16) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(17) :: not used in this release of MUMPS */</span>
<span class="mi">3</span> <span class="cm">/* ICNTL(18) :: method for given : matrix pattern and matrix entries : */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(19) :: method to return the Schur complement matrix */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(20) :: right hand side form ( 0 dense form, 1 sparse form) : parameter will be set to 0 for FreeFEM */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(21) :: 0, 1 kept distributed solution : parameter is not considered in the current release of FreeFEM */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(22) :: controls the in-core/out-of-core (OOC) facility */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(23) :: maximum size of the working memory in Megabyte than MUMPS can allocate per working processor */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(24) :: control the detection of null pivot */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(25) :: control the computation of a null space basis */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(26) :: This parameter is only significant with Schur option (ICNTL(19) not zero). : parameter is not considered in the current release of FreeFEM */</span>
<span class="o">-</span><span class="mi">8</span> <span class="cm">/* ICNTL(27) (Experimental parameter subject to change in next release of MUMPS) :: control the blocking factor for multiple righthand side during the solution phase : parameter is not considered in the current release of FreeFEM */</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(28) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(29) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(30) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(31) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(32) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(33) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(34) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(35) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(36) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(37) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(38) :: not used in this release of MUMPS*/</span>
<span class="mi">1</span> <span class="cm">/* ICNTL(39) :: not used in this release of MUMPS*/</span>
<span class="mi">0</span> <span class="cm">/* ICNTL(40) :: not used in this release of MUMPS*/</span>
<span class="mf">0.01</span> <span class="cm">/* CNTL(1) :: relative threshold for numerical pivoting */</span>
<span class="mf">1e-8</span> <span class="cm">/* CNTL(2) :: stopping criteria for iterative refinement */</span>
<span class="o">-</span><span class="mi">1</span> <span class="cm">/* CNTL(3) :: threshold for null pivot detection */</span>
<span class="o">-</span><span class="mi">1</span> <span class="cm">/* CNTL(4) :: determine the threshold for partial pivoting */</span>
<span class="mf">0.0</span> <span class="cm">/* CNTL(5) :: fixation for null pivots */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(6) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(7) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(8) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(9) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(10) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(11) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(12) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(13) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(14) :: not used in this release of MUMPS */</span>
<span class="mi">0</span> <span class="cm">/* CNTL(15) :: not used in this release of MUMPS */</span>
</pre></div>
</td></tr></table></div>
<p>If no solver parameter is given, we used default option of MUMPS solver.</p>
</div></blockquote>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>MUMPS example</p>
<p class="last">A simple example of calling MUMPS in <strong>FreeFEM</strong> with this two methods is given in the <a class="reference internal" href="../example/parallelization.html#examplesolvermumps"><span class="std std-ref">Test solver MUMPS example</span></a>.</p>
</div>
</div>
<div class="section" id="superlu-distributed-solver">
<h4>SuperLU distributed solver<a class="headerlink" href="#superlu-distributed-solver" title="Permalink to this headline"> </a></h4>
<p>The package <a class="reference external" href="http://crd-legacy.lbl.gov/~xiaoye/SuperLU/">SuperLU_DIST</a> solves linear systems using LU factorization.
It is a free scientific library</p>
<p>This library provides functions to handle square or rectangular matrix in real and complex arithmetics.
The method implemented in SuperLU_DIST is a supernodal method.
New release of this package includes a parallel symbolic factorization.
This scientific library is written in C and MPI for communications.</p>
<p><strong>SuperLU_DIST parameters:</strong></p>
<p>We describe now some parameters of SuperLU_DIST.
The SuperLU_DIST library use a 2D-logical process group.
This process grid is specified by <span class="math notranslate nohighlight">\(nprow\)</span> (process row) and <span class="math notranslate nohighlight">\(npcol\)</span> (process column) such that <span class="math notranslate nohighlight">\(N_{p} = nprow \: npcol\)</span> where <span class="math notranslate nohighlight">\(N_{p}\)</span> is the number of all process allocated for SuperLU_DIST.</p>
<p>The input matrix parameters is controlled by “matrix=” in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code> for internal parameter or in the third line of parameters file.
The different value are</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="o">=</span><span class="n">assembled</span></code> global matrix are available on all process</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="o">=</span><span class="n">distributedglobal</span></code> The global matrix is distributed among all the process</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="o">=</span><span class="n">distributed</span></code> The input matrix is distributed (not yet implemented)</li>
</ul>
<p>The option arguments of SuperLU_DIST are described in the section Users-callable routine of the <a class="reference external" href="http://crd-legacy.lbl.gov/~xiaoye/SuperLU/ug.pdf">SuperLU users’ guide</a>.</p>
<p>The parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Fact</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">TRANS</span></code> are specified in <strong>FreeFEM</strong> interfaces to SuperLU_DIST during the different steps.
For this reason, the value given by the user for this option is not considered.</p>
<p>The factorization LU is calculated in SuperLU_DIST on the matrix <span class="math notranslate nohighlight">\(A_p\)</span>.</p>
<div class="math notranslate nohighlight">
\[A_{p} = P_{c} \: P_r \: D_r \: A \: D_{c} \: P_{c}^{t}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_c\)</span> and <span class="math notranslate nohighlight">\(P_r\)</span> is the row and column permutation matrix respectively, <span class="math notranslate nohighlight">\(D_r\)</span> and <span class="math notranslate nohighlight">\(D_c\)</span> are diagonal matrix for respectively row and column scaling.</p>
<p>The option argument <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">RowPerm</span></code> (resp. <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ColPerm</span></code>) control the row (resp. column) permutation matrix.
<span class="math notranslate nohighlight">\(D_r\)</span> and <span class="math notranslate nohighlight">\(D_c\)</span> is controlled by the parameter <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">DiagScale</span></code>.</p>
<p>The parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permr</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permc</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scaler</span></code>, and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">scalec</span></code> in <strong>FreeFEM</strong> is provided to give row permutation, column permutation, row scaling and column scaling of the user respectively.</p>
<p>The other parameters for LU factorization are <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ParSymFact</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ReplaceTinyPivot</span></code>.
The parallel symbolic factorization works only on a power of two processes and need the <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ParMetis</span></code> ordering.
The default option argument of SuperLU_DIST are given in the file <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ffsuperlu_dist_fileparam</span><span class="p">.</span><span class="n">txt</span></code>.</p>
<p><strong>Calling SuperLU_DIST in FreeFEM</strong></p>
<p>To call SuperLU_DIST in <strong>FreeFEM</strong>, we need to load the library dynamic correspond to interface.
This done by the following line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span> <span class="s">&quot;real_superlu _DIST_FreeFem&quot;</span></code> (resp. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span> <span class="s">&quot;complex_superlu_DIST_FreeFem&quot;</span></code>) for real (resp. complex) arithmetics in the file <code class="docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">edp</span></code>.</p>
<p><strong>Solver parameters is defined in .edp file:</strong></p>
<p>To call SuperLU_DIST with internal parameter, we used the parameters <code class="docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code>.
The value of parameters of SuperLU_DIST in <code class="docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code> are defined by :</p>
<ul class="simple">
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">nprow</span><span class="o">=</span><span class="mi">1</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">npcol</span><span class="o">=</span><span class="mi">1</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span><span class="o">=</span> <span class="n">distributedgloba</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Fact</span><span class="o">=</span> <span class="n">DOFACT</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Equil</span><span class="o">=</span><span class="n">NO</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ParSymbFact</span><span class="o">=</span><span class="n">NO</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ColPerm</span><span class="o">=</span> <span class="n">MMD_AT_PLUS_A</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">RowPerm</span><span class="o">=</span> <span class="n">LargeDiag</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">DiagPivotThresh</span><span class="o">=</span><span class="mf">1.0</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">IterRefine</span><span class="o">=</span><span class="n">DOUBLE</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Trans</span><span class="o">=</span><span class="n">NOTRANS</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ReplaceTinyPivot</span><span class="o">=</span><span class="n">NO</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">SolveInitialized</span><span class="o">=</span><span class="n">NO</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">PrintStat</span><span class="o">=</span><span class="n">NO</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">DiagScale</span><span class="o">=</span><span class="n">NOEQUIL</span></code></li>
</ul>
<p>This value correspond to the parameter in the file <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ffsuperlu_dist_fileparam</span><span class="p">.</span><span class="n">txt</span></code>.
If one parameter is not specified by the user, we take the default value of SuperLU_DIST.</p>
<p><strong>Reading solver parameters on a file:</strong> The structure of data file for SuperLU_DIST in <strong>FreeFEM</strong> is given in the file <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ffsuperlu_dist_fileparam</span><span class="p">.</span><span class="n">txt</span></code> (default value of the <strong>FreeFEM</strong> interface).</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="cm">/* nprow : integer value */</span>
<span class="mi">1</span> <span class="cm">/* npcol : integer value */</span>
<span class="n">distributedglobal</span> <span class="cm">/* matrix input : assembled, distributedglobal, distributed */</span>
<span class="n">DOFACT</span> <span class="cm">/* Fact : DOFACT, SamePattern, SamePattern_SameRowPerm, FACTORED */</span>
<span class="n">NO</span> <span class="cm">/* Equil : NO, YES */</span>
<span class="n">NO</span> <span class="cm">/* ParSymbFact : NO, YES */</span>
<span class="n">MMD_AT_PLUS_A</span> <span class="cm">/* ColPerm : NATURAL, MMD_AT_PLUS_A, MMD_ATA, METIS_AT_PLUS_A, PARMETIS, MY_PERMC */</span>
<span class="n">LargeDiag</span> <span class="cm">/* RowPerm : NOROWPERM, LargeDiag, MY_PERMR */</span>
<span class="mf">1.0</span> <span class="cm">/* DiagPivotThresh : real value */</span>
<span class="n">DOUBLE</span> <span class="cm">/* IterRefine : NOREFINE, SINGLE, DOUBLE, EXTRA */</span>
<span class="n">NOTRANS</span> <span class="cm">/* Trans : NOTRANS, TRANS, CONJ*/</span>
<span class="n">NO</span> <span class="cm">/* ReplaceTinyPivot : NO, YES*/</span>
<span class="n">NO</span> <span class="cm">/* SolveInitialized : NO, YES*/</span>
<span class="n">NO</span> <span class="cm">/* RefineInitialized : NO, YES*/</span>
<span class="n">NO</span> <span class="cm">/* PrintStat : NO, YES*/</span>
<span class="n">NOEQUIL</span> <span class="cm">/* DiagScale : NOEQUIL, ROW, COL, BOTH*/</span>
</pre></div>
</td></tr></table></div>
<p>If no solver parameter is given, we used default option of SuperLU_DIST solver.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A simple example of calling SuperLU_DIST in <strong>FreeFEM</strong> with this two methods is given in the <a class="reference internal" href="../example/parallelization.html#examplesolversuperludist"><span class="std std-ref">Solver superLU_DIST example</span></a>.</p>
</div>
</div>
<div class="section" id="pastix-solver">
<h4>PaStiX solver<a class="headerlink" href="#pastix-solver" title="Permalink to this headline"> </a></h4>
<p><a class="reference external" href="http://pastix.gforge.inria.fr/files/README-txt.html">PaStiX</a> (Parallel Sparse matrix package) is a free scientific library under CECILL-C license.
This package solves sparse linear system with a direct and block ILU(k) iterative methods.
his solver can be applied to a real or complex matrix with a symmetric pattern.</p>
<p><strong>PaStiX parameters:</strong></p>
<p>The input <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code> parameter of <strong>FreeFEM</strong> depend on PaStiX interface.
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span> <span class="o">=</span> <span class="n">assembled</span></code> for non distributed matrix.
It is the same parameter for SuperLU_DIST.</p>
<p>There are four parameters in PaStiX : <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code>, <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span></code>, <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">perm</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">invp</span></code>.
These parameters are respectively the integer parameters (vector of size 64), real parameters (vector of size 64), permutation matrix and inverse permutation matrix respectively.
<code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span></code> vectors are described in <a class="reference external" href="https://gforge.inria.fr/docman/?group_id=186&amp;view=listfile&amp;dirid=246">PaStiX RefCard</a>.</p>
<p>The parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permr</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">permc</span></code> in <strong>FreeFEM</strong> are provided to give permutation matrix and inverse permutation matrix of the user respectively.</p>
<p><strong>Solver parameters defined in .edp file:</strong></p>
<p>To call PaStiX in <strong>FreeFEM</strong> in this case, we need to specify the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code>.
These parameters are defined by :</p>
<p><span class="math notranslate nohighlight">\(\forall i\)</span> = 0,… ,63, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">iparm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></code>.</p>
<p><span class="math notranslate nohighlight">\(\forall i\)</span> = 0,… ,63, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dparm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></code>.</p>
<p><strong>Reading solver parameters on a file:</strong></p>
<p>The structure of data file for PaStiX parameters in <strong>FreeFEM</strong> is: first line structure parameters of the matrix and in the following line the value of vectors <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span></code> in this order.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">assembled</span> <span class="cm">/* matrix input :: assembled, distributed global and distributed */</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">...</span>
<span class="p">...</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">63</span><span class="p">]</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">...</span>
<span class="p">...</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">63</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>An example of this file parameter is given in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">ffpastix_iparm_dparm</span><span class="p">.</span><span class="n">txt</span></code> with a description of these parameters.
This file is obtained with the example file <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">.</span><span class="n">txt</span></code> and <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">.</span><span class="n">txt</span></code> including in the PaStiX package.</p>
<p>If no solver parameter is given, we use the default option of PaStiX solver.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A simple example of calling PaStiX in <strong>FreeFEM</strong> with this two methods is given in the <a class="reference internal" href="../example/parallelization.html#examplesolverpastix"><span class="std std-ref">Solver PaStiX example</span></a>.</p>
</div>
<p>In <a class="reference internal" href="#tabparallelizationdirectsolver"><span class="std std-numref">Table 4</span></a>, we recall the different matrix considering in the different direct solvers.</p>
<table border="1" class="docutils" id="tabparallelizationdirectsolver">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Type of matrix used by the different direct sparse solver</span><a class="headerlink" href="#tabparallelizationdirectsolver" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="23%" />
<col width="8%" />
<col width="20%" />
<col width="11%" />
<col width="8%" />
<col width="20%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">direct solver</th>
<th class="head" colspan="3">square matrix</th>
<th class="head" colspan="3">rectangular matrix</th>
</tr>
<tr class="row-even"><th class="head">&#160;</th>
<th class="head">sym</th>
<th class="head">sym pattern</th>
<th class="head">unsym</th>
<th class="head">sym</th>
<th class="head">sym pattern</th>
<th class="head">unsym</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>SuperLU_DIST</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>MUMPS</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>Pastix</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="parallel-sparse-iterative-solver">
<h3>Parallel sparse iterative solver<a class="headerlink" href="#parallel-sparse-iterative-solver" title="Permalink to this headline"> </a></h3>
<p>Concerning iterative solvers, we have chosen <a class="reference external" href="https://www-users.cs.umn.edu/~saad/software/pARMS/">pARMS</a>, <a class="reference external" href="http://hips.gforge.inria.fr/">HIPS</a> and <a class="reference external" href="https://computation.llnl.gov/projects/hypre-scalable-linear-solvers-multigrid-methods">Hypre</a>.</p>
<p>Each software implements a different type of parallel preconditioner.</p>
<p>So, pARMS implements algebraic domain decomposition preconditioner type such as additive Schwartz <a class="reference internal" href="../reference.html#cai1989" id="id2">[CAI1989]</a> and interface method; while HIPS implement hierarchical incomplete factorization and finally HYPRE implements multilevel preconditioner are AMG(Algebraic MultiGrid) and parallel approximated inverse.</p>
<p>To use one of these programs in <strong>FreeFEM</strong>, you have to install it independently of <strong>FreeFEM</strong>.
It is also necessary to install the MPI communication library which is essential for communication between the processors and, in some cases, software partitioning graphs like <a class="reference external" href="http://glaros.dtc.umn.edu/gkhome/metis/metis/overview">METIS</a> or <a class="reference external" href="http://www.labri.fr/perso/pelegrin/scotch/">Scotch</a>.</p>
<p>All this preconditioners are used with Krylov subspace methods accelerators.</p>
<p>Krylov subspace methods are iterative methods which consist in finding a solution <span class="math notranslate nohighlight">\(x\)</span> of linear system <span class="math notranslate nohighlight">\(Ax=b\)</span> inside the affine space <span class="math notranslate nohighlight">\(x_0+K_m\)</span> by imposing that <span class="math notranslate nohighlight">\(b-Ax \bot \mathcal{L}_m\)</span>, where <span class="math notranslate nohighlight">\(K_m\)</span> is Krylov subspace of dimension <span class="math notranslate nohighlight">\(m\)</span> defined by <span class="math notranslate nohighlight">\(K_m=\{r_0, Ar_0, A^2r_0,...,A^{m-1}r_0\}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{L}_m\)</span> is another subspace of dimension <span class="math notranslate nohighlight">\(m\)</span> which depends on type of Krylov subspace. For example in GMRES, <span class="math notranslate nohighlight">\(\mathcal{L}_m=AK_m\)</span>.</p>
<p>We realized an interface which is easy to use, so that the call of these different softwares in <strong>FreeFEM</strong> is done in the same way.
You just have to load the solver and then specify the parameters to apply to the specific solvers.
In the rest of this chapter, when we talk about Krylov subspace methods we mean one among GMRES, CG and BICGSTAB.</p>
<div class="section" id="parms-solver">
<h4>pARMS solver<a class="headerlink" href="#parms-solver" title="Permalink to this headline"> </a></h4>
<p><a class="reference external" href="https://www-users.cs.umn.edu/~saad/software/pARMS/">pARMS</a> (parallel Algebraic Multilevel Solver) is a software developed by Youssef Saad and al at University of Minnesota.</p>
<p>This software is specialized in the resolution of large sparse non symmetric linear systems of equation.
Solvers developed in pARMS are of type “Krylov’s subspace”.</p>
<p>It consists of variants of GMRES like FGMRES (Flexible GMRES), DGMRES (Deflated GMRES) <a class="reference internal" href="../reference.html#saad2003" id="id3">[SAAD2003]</a> and BICGSTAB.
pARMS also implements parallel preconditioner like RAS (Restricted Additive Schwarz) <a class="reference internal" href="../reference.html#cai1989" id="id4">[CAI1989]</a> and Schur Complement type preconditioner.</p>
<p>All these parallel preconditioners are based on the principle of domain decomposition.
Thus, the matrix <span class="math notranslate nohighlight">\(A\)</span> is partitioned into sub matrices <span class="math notranslate nohighlight">\(A_i\)</span>(<span class="math notranslate nohighlight">\(i=1,...,p\)</span>) where p represents the number of partitions one needs.
The union of <span class="math notranslate nohighlight">\(A_i\)</span> forms the original matrix.
The solution of the overall system is obtained by solving the local systems on <span class="math notranslate nohighlight">\(A_i\)</span> (see <a class="reference internal" href="../reference.html#smith1996" id="id5">[SMITH1996]</a>).
Therefore, a distinction is made between iterations on <span class="math notranslate nohighlight">\(A\)</span> and the local iterations on <span class="math notranslate nohighlight">\(A_i\)</span>.</p>
<p>To solve the local problem on <span class="math notranslate nohighlight">\(A_i\)</span> there are several preconditioners as <strong>ilut</strong> (Incomplete LU with threshold), <strong>iluk</strong> (Incomplete LU with level of fill in) and <strong>ARMS</strong> (Algebraic Recursive Multilevel Solver).</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Default parameters</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;parms_FreeFem&quot;</span> <span class="c1">//Tell FreeFem that you will use pARMS</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="n">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span> <span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span> <span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="c1">// Function</span>
<span class="kt">func</span> <span class="n">f</span><span class="o">=</span> <span class="kr">x</span><span class="o">*</span><span class="kr">y</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="nf">Poisson</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="p">)</span>
    <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>

<span class="c1">// Solve</span>
<span class="kt">real</span> <span class="n">cpu</span> <span class="o">=</span> <span class="nf">clock</span><span class="p">();</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; CPU time = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">clock</span><span class="p">()</span><span class="o">-</span><span class="n">cpu</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>In line 1, the pARMS dynamic library is loaded with interface <strong>FreeFEM</strong>.
After this, in line 15 we specify that the bilinear form will be solved by the last sparse linear solver load in memory which, in this case, is pARMS.</p>
<p>The parameters used in pARMS in this case are the default one since the user does not have to provide any parameter.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to see the plot of a parallel script, run the command <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">FreeFem</span><span class="o">++-</span><span class="n">mpi</span> <span class="o">-</span><span class="n">glut</span> <span class="n">ffglut</span> <span class="n">script</span><span class="p">.</span><span class="n">edp</span></code></p>
</div>
</div>
<p>Here are some default parameters:</p>
<ul class="simple">
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span><span class="o">=</span><span class="n">FGMRES</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Krylov</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">30</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Maximum</span> <span class="n">of</span> <span class="n">Krylov</span><span class="o">=</span><span class="mi">1000</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Tolerance</span> <span class="k">for</span> <span class="n">convergence</span><span class="o">=</span><span class="mf">1e-08</span></code> (see book
<a class="reference internal" href="../reference.html#saad2003" id="id6">[SAAD2003]</a> to understand all this parameters),</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">preconditionner</span><span class="o">=</span><span class="n">Restricted</span> <span class="n">Additif</span> <span class="n">Schwarz</span></code>
<a class="reference internal" href="../reference.html#cai1989" id="id7">[CAI1989]</a>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Inner</span> <span class="n">Krylov</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">5</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Maximum</span> <span class="n">of</span> <span class="n">inner</span> <span class="n">Krylov</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">5</span></code>,</li>
<li><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Inner</span> <span class="n">preconditionner</span><span class="o">=</span><span class="n">ILUK</span></code>.</li>
</ul>
<p>To specify the parameters to apply to the solver, the user can either give an integer vector for <strong>integer parameters</strong> and real vectors for <strong>real parameters</strong> or provide a <strong>file</strong> which contains those parameters.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>User specifies parameters inside two vectors</p>
<p>Lets us consider Navier-Stokes example.
In this example we solve linear systems coming from discretization of Navier-Stokes equations with pARMS.
Parameters of solver is specified by user.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;parms_FreeFem&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">iparm</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">dparm</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">iparm</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">dparm</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span> <span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">wall</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">inlet</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]);</span>

<span class="c1">// Function</span>
<span class="kt">func</span> <span class="n">uc</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">varf</span> <span class="nf">Stokes</span> <span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">],</span> <span class="p">[</span><span class="n">ush</span><span class="p">,</span> <span class="n">vsh</span><span class="p">,</span> <span class="n">psh</span><span class="p">],</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">nu</span><span class="o">*</span><span class="p">(</span>
            <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">ush</span><span class="p">)</span>
            <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">ush</span><span class="p">)</span>
            <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">vsh</span><span class="p">)</span>
            <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">vsh</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">psh</span><span class="o">*</span><span class="p">(</span><span class="mf">1.e-6</span><span class="p">)</span>
        <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">ush</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">vsh</span><span class="p">))</span>
        <span class="o">-</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">psh</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">wall</span><span class="p">,</span> <span class="n">wall</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">inlet</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">uc</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="p">;</span>

<span class="kt">matrix</span> <span class="n">AA</span> <span class="o">=</span> <span class="n">Stokes</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>
<span class="nf">set</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">lparams</span><span class="o">=</span><span class="n">iparm</span><span class="p">,</span> <span class="kp">dparams</span><span class="o">=</span><span class="n">dparm</span><span class="p">);</span> <span class="c1">//set pARMS as linear solver</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">bb</span> <span class="o">=</span> <span class="n">Stokes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">sol</span><span class="p">(</span><span class="n">AA</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">AA</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="kp">bb</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>We need two vectors to specify the parameters of the linear solver.
In line 5-6 of the example, we have declared these vectors(<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">iparm</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">dparm</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span></code>).
In line 7-10 we have initialized these vectors by negative values.</p>
<p>We do this because all parameters values in pARMS are positive and if you do not change the negative values of one entry of this vector, the default value will be set.</p>
<p>In <a class="reference internal" href="#tabparallelizationlparams"><span class="std std-numref">Table 7</span></a> and <a class="reference internal" href="#tabparallelizationdparams"><span class="std std-numref">Table 8</span></a>, we have the meaning of different entries of these vectors.</p>
<p>We run this example on a cluster paradent of Grid5000 and report results in <a class="reference internal" href="#tabparallelizationconvergencetime"><span class="std std-numref">Table 5</span></a>.</p>
<table border="1" class="docutils" id="tabparallelizationconvergencetime">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Convergence and time for solving linear system</span><a class="headerlink" href="#tabparallelizationconvergencetime" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="13%" />
<col width="17%" />
<col width="27%" />
<col width="17%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5"><span class="math notranslate nohighlight">\(n=471281\)</span>
<span class="math notranslate nohighlight">\(nnz=13\times10^6\)</span>
<span class="math notranslate nohighlight">\(Te=571.29\)</span></th>
</tr>
<tr class="row-even"><th class="head">np</th>
<th class="head" colspan="2">add(iluk)</th>
<th class="head" colspan="2">shur(iluk)</th>
</tr>
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">nit</th>
<th class="head">time</th>
<th class="head">nit</th>
<th class="head">time</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4</td>
<td>230</td>
<td>637.57</td>
<td>21</td>
<td>557.8</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>240</td>
<td>364.12</td>
<td>22</td>
<td>302.25</td>
</tr>
<tr class="row-even"><td>16</td>
<td>247</td>
<td>212.07</td>
<td>24</td>
<td>167.5</td>
</tr>
<tr class="row-odd"><td>32</td>
<td>261</td>
<td>111.16</td>
<td>25</td>
<td>81.5</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationlegend">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Legend of <a class="reference internal" href="#tabparallelizationconvergencetime"><span class="std std-numref">Table 5</span></a></span><a class="headerlink" href="#tabparallelizationlegend" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span></code></th>
<th class="head">matrix size</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">nnz</span></code></td>
<td>number of non null entries inside matrix</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">nit</span></code></td>
<td>number of iteration for convergence</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">time</span></code></td>
<td>Time for convergence</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Te</span></code></td>
<td>Time for constructing finite element matrix</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">np</span></code></td>
<td>number of processor</td>
</tr>
</tbody>
</table>
<p class="last">In this example, we fix the matrix size (in term of finite element, we fix the mesh) and increase the number of processors used to solve the linear system.
We saw that, when the number of processors increases, the time for solving the linear equation decreases, even if the number of iteration increases.
This proves that, using pARMS as solver of linear systems coming from discretization of partial differential equation in <strong>FreeFEM</strong> can decrease drastically the total time of simulation.</p>
</div>
<table border="1" class="docutils" id="tabparallelizationlparams">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Meaning of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code> corresponding variables</span><a class="headerlink" href="#tabparallelizationlparams" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code></th>
<th class="head">Significations of each entries</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td><p class="first">Krylov subspace methods</p>
<p class="last">Different values for this parameters are specify on <a class="reference internal" href="#tabparallelizationparmskrylov"><span class="std std-numref">Table 9</span></a></p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td><p class="first">Preconditionner</p>
<p class="last">Different preconditionners for this parameters are  specify on <a class="reference internal" href="#tabparallelizationparmsprecon"><span class="std std-numref">Table 10</span></a></p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>Krylov subspace dimension in outer iteration: default value 30</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td>Maximum of iterations in outer iteration: default value 1000</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code></td>
<td>Number of level in arms when used</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code></td>
<td>Krylov subspace dimension in inner iteration: default value 3</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span></code></td>
<td>Maximum of iterations in inner iteration: default value 3</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td><p class="first">Symmetric(=1 for symmetric) or unsymmetric matrix:</p>
<p class="last">default value 0(unsymmetric matrix)</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td>Overlap size between different subdomain: default value 0(no overlap)</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span></code></td>
<td>Scale the input matrix or not: Default value 1 (Matrix should be scaled)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span></code></td>
<td>Block size in arms when used: default value 20</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span></code></td>
<td>lfil0 (ilut, iluk, and arms) : default value 20</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span></code></td>
<td>lfil for Schur complement const : default value 20</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span></code></td>
<td>lfil for Schur complement const : default value 20</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span></code></td>
<td>Multicoloring or not in ILU when used : default value 1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span></code></td>
<td>Inner iteration : default value 0</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span></code></td>
<td><p class="first">Print message when solving: default 0 (no message print)</p>
<ul class="last simple">
<li>0: no message is print,</li>
<li>1: Convergence informations like number of iteration and residual,</li>
<li>2: Timing for a different step like preconditioner,</li>
<li>3 : Print all informations</li>
</ul>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationdparams">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Significations of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code> corresponding variables</span><a class="headerlink" href="#tabparallelizationdparams" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span></code></th>
<th class="head">Significations of each entries</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td>precision for outer iteration : default value 1e-08</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td>precision for inner iteration: default value 1e-2</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>tolerance used for diagonal domain: : default value 0.1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td>drop tolerance droptol0 (ilut, iluk, and arms) : default value 1e-2</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code></td>
<td>droptol for Schur complement const: default value 1e-2</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code></td>
<td>droptol for Schur complement const: default value 1e-2</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationparmskrylov">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Krylov Solvers in pARMS</span><a class="headerlink" href="#tabparallelizationparmskrylov" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Values of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></th>
<th class="head">Krylov subspace methods</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>FGMRES (Flexible GMRES)</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>DGMRES (Deflated GMRES)</td>
</tr>
<tr class="row-even"><td>2</td>
<td>BICGSTAB</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationparmsprecon">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Preconditionners in pARMS</span><a class="headerlink" href="#tabparallelizationparmsprecon" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Values of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></th>
<th class="head">Preconditionners type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>additive Schwartz preconditioner with ilu0 as local preconditioner</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>additive Schwartz preconditioner with iluk as local preconditioner</td>
</tr>
<tr class="row-even"><td>2</td>
<td>additive Schwartz preconditioner with ilut as local preconditioner</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>additive Schwartz preconditioner with arms as local preconditioner</td>
</tr>
<tr class="row-even"><td>4</td>
<td>Left Schur complement preconditioner with ilu0 as local preconditioner</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>Left Schur complement preconditioner with ilut as local preconditioner</td>
</tr>
<tr class="row-even"><td>6</td>
<td>Left Schur complement preconditioner with iluk as local preconditioner</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>Left Schur complement preconditioner with arms as local preconditioner</td>
</tr>
<tr class="row-even"><td>8</td>
<td>Right Schur complement preconditioner with ilu0 as local preconditioner</td>
</tr>
<tr class="row-odd"><td>9</td>
<td>Right Schur complement preconditioner with ilut as local preconditioner</td>
</tr>
<tr class="row-even"><td>10</td>
<td>Right Schur complement preconditioner with iluk as local preconditioner</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>Right Schur complement preconditioner with arms as local preconditioner</td>
</tr>
<tr class="row-even"><td>12</td>
<td>sch_gilu0, Schur complement preconditioner with global ilu0</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>SchurSymmetric GS preconditioner</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="interfacing-with-hips">
<h4>Interfacing with HIPS<a class="headerlink" href="#interfacing-with-hips" title="Permalink to this headline"> </a></h4>
<p><a class="reference external" href="http://hips.gforge.inria.fr/">HIPS</a> (<em>Hierarchical Iterative Parallel Solver</em>) is a scientific library that provides an efficient parallel iterative solver for very large sparse linear systems.
HIPS is available as free software under the CeCILL-C licence.</p>
<p>HIPS implements two solver classes which are the iteratives class (GMRES, PCG) and the Direct class.
Concerning preconditionners, HIPS implements a type of multilevel ILU.
For further informations on those preconditionners see the <a class="reference external" href="http://hips.gforge.inria.fr/doc/hips_user.pdf">HIPS documentation</a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Laplacian 3D solved with HIPS</p>
<p>Let us consider the 3D Laplacian example inside <strong>FreeFEM</strong> package where after discretization we want to solve the linear equation with HIPS.</p>
<p>The following example is a Laplacian 3D using Hips as linear solver.
We first load Hips solver at line 2.
From line 7 to 18 we specify the parameters for the Hips solver and in line 82 we set these parameters in the linear solver.</p>
<p>In <a class="reference internal" href="#tabparallelizationconvergencetimehips"><span class="std std-numref">Table 11</span></a> results of running on Cluster Paradent of Grid5000 are reported.
We can see in this running example the efficiency of parallelism.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;hips_FreeFem&quot;</span> <span class="c1">//load Hips library</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">iparm</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">dparm</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iii</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">;</span> <span class="n">iii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">iparm</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iii</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">iii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">dparm</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//use iterative solver</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//PCG as Krylov method</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//Matrix are symmetric</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//Pattern are also symmetric</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//Scale matrix</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-13</span><span class="p">;</span> <span class="c1">//Tolerance to convergence</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="c1">//Threshold in ILUT</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="c1">//Threshold for Schur preconditionner</span>

<span class="c1">// Functions</span>
<span class="kt">func</span> <span class="n">ue</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="kr">z</span><span class="o">*</span><span class="kr">z</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="kr">x</span><span class="o">*</span><span class="kr">y</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="kr">x</span><span class="o">*</span><span class="kr">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">uex</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="kr">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="kr">y</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="kr">z</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">uey</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="kr">y</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="kr">x</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">uez</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="kr">z</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="kr">x</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mf">18.</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th2</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span><span class="p">);</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">rdown</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rmid</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

<span class="kt">mesh3</span> <span class="n">Th</span><span class="o">=</span><span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">],</span> <span class="kp">reffacemid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span>
    <span class="kp">reffaceup</span> <span class="o">=</span> <span class="n">rup</span><span class="p">,</span> <span class="kp">reffacelow</span> <span class="o">=</span> <span class="n">rdown</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh2</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Vh2</span> <span class="n">ux</span><span class="p">,</span> <span class="n">uz</span><span class="p">,</span> <span class="n">p2</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">uhe</span> <span class="o">=</span> <span class="n">ue</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;uhe min =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">uhe</span><span class="p">[].</span><span class="kr">min</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, max =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">uhe</span><span class="p">[].</span><span class="kr">max</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
<span class="n">Vh</span> <span class="n">F</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="nf">Grad3</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">//</span>

<span class="c1">// Problem</span>
<span class="kt">varf</span> <span class="n">va</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">Grad3</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">Grad3</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span>
          <span class="n">u</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">f</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">2</span><span class="p">)(</span>
          <span class="n">ue</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="n">uex</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">x</span> <span class="o">+</span> <span class="n">uey</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">y</span> <span class="o">+</span> <span class="n">uez</span><span class="o">*</span><span class="kr">N</span><span class="p">.</span><span class="kr">z</span><span class="p">)</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">ue</span><span class="p">);</span>

<span class="kt">varf</span> <span class="nf">l</span> <span class="p">(</span><span class="kr">unused</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="n">f</span><span class="o">*</span><span class="n">v</span><span class="p">);</span>

<span class="kt">real</span> <span class="n">cpu</span><span class="o">=</span><span class="nf">clock</span><span class="p">();</span>
<span class="kt">matrix</span> <span class="n">Aa</span> <span class="o">=</span> <span class="n">va</span><span class="p">(</span><span class="n">Vh</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>

<span class="n">F</span><span class="p">[]</span> <span class="o">=</span> <span class="n">va</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Vh</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Size of A =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Aa</span><span class="p">.</span><span class="kr">n</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Non zero coefficients =&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Aa</span><span class="p">.</span><span class="n">nbcoef</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;CPU TIME FOR FORMING MATRIX =&quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">clock</span><span class="p">()</span><span class="o">-</span><span class="n">cpu</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">set</span><span class="p">(</span><span class="n">Aa</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">dparams</span><span class="o">=</span><span class="n">dparm</span><span class="p">,</span> <span class="kp">lparams</span><span class="o">=</span><span class="n">iparm</span><span class="p">);</span> <span class="c1">//Set hips as linear solver</span>

<span class="c1">// Solve</span>
<span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="n">Aa</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">F</span><span class="p">[];</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<table border="1" class="last docutils" id="tabparallelizationconvergencetimehips">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">Legend of this table are give in <a class="reference internal" href="#tabparallelizationlegend"><span class="std std-numref">Table 6</span></a></span><a class="headerlink" href="#tabparallelizationconvergencetimehips" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="30%" />
<col width="33%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3"><span class="math notranslate nohighlight">\(n=4\times 10^6\)</span>
<span class="math notranslate nohighlight">\(nnz=118 \times 10^6\)</span>
<span class="math notranslate nohighlight">\(Te=221.34\)</span></th>
</tr>
<tr class="row-even"><th class="head"><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">np</span></code></th>
<th class="head"><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">nit</span></code></th>
<th class="head"><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">time</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>8</td>
<td>190</td>
<td>120.34</td>
</tr>
<tr class="row-even"><td>16</td>
<td>189</td>
<td>61.08</td>
</tr>
<tr class="row-odd"><td>32</td>
<td>186</td>
<td>31.70</td>
</tr>
<tr class="row-even"><td>64</td>
<td>183</td>
<td>23.44</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<table border="1" class="docutils" id="tabparallelizationhipsinterface">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">Significations of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code> corresponding to HIPS interface</span><a class="headerlink" href="#tabparallelizationhipsinterface" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Entries of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code></th>
<th class="head">Significations of each entries</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td><p class="first">Strategy use for solving (Iterative=0 or Hybrid=1 or Direct=2).</p>
<p class="last">Defaults values are : Iterative</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td><p class="first">Krylov methods.</p>
<p class="last">If iparm[0]=0, give type of Krylov methods: 0 for GMRES, 1 for PCG</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>Maximum of iterations in outer iteration: default value 1000</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td>Krylov subspace dimension in outer iteration: default value 40</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code></td>
<td><p class="first">Symmetric(=0 for symmetric) and 1 for unsymmetricmatrix:</p>
<p class="last">default value 1 (unsymmetric matrix)</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code></td>
<td>Pattern of matrix are symmetric or not: default value 0</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span></code></td>
<td>Partition type of input matrix: default value 0</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td><p class="first">Number of level that use the HIPS locally consistentfill-in:</p>
<p class="last">Default value 2</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td>Numbering in indices array will start at 0 or 1: Default value 0</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span></code></td>
<td>Scale matrix. Default value 1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span></code></td>
<td><p class="first">Reordering use inside subdomains for reducingfill-in:</p>
<p class="last">Only use for iterative. Default value 1</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span></code></td>
<td><p class="first">Number of unknowns per node in the matrix non-zeropattern graph:</p>
<p class="last">Default value 1</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span></code></td>
<td><p class="first">This value is used to set the number of time the</p>
<p class="last">normalization is applied to the matrix: Default 2.</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span></code></td>
<td>Level of informations printed during solving: Default 5.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span></code></td>
<td>HIPS_DOMSIZE Subdomain size</td>
</tr>
</tbody>
</table>
<table border="1" class="last docutils" id="tabparallelizationhipsdparms">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Significations of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code> corresponding to HIPS interface</span><a class="headerlink" href="#tabparallelizationhipsdparms" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td>HIPS_PREC: Relative residual norm: Default=1e-9</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td><p class="first">HIPS_DROPTOL0: Numerical threshold in ILUT for interior domain</p>
<p class="last">(important : set 0.0 in HYBRID: Default=0.005)</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td><p class="first">HIPS_DROPTOL1 : Numerical threshold in ILUT for Schur preconditioner:</p>
<p class="last">Default=0.005</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td><p class="first">HIPS_DROPTOLE : Numerical threshold for coupling between the interior</p>
<p class="last">level and Schur: Default 0.005</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code></td>
<td><p class="first">HIPS_AMALG : Numerical threshold for coupling between the interior level</p>
<p class="last">and Schur: Default=0.005</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code></td>
<td><p class="first">HIPS_DROPSCHUR : Numerical threshold for coupling between the interior</p>
<p class="last">level and Schur: Default=0.005</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="interfacing-with-hypre">
<h4>Interfacing with HYPRE<a class="headerlink" href="#interfacing-with-hypre" title="Permalink to this headline"> </a></h4>
<p><a class="reference external" href="https://computation.llnl.gov/projects/hypre-scalable-linear-solvers-multigrid-methods">Hypre</a> (High Level Preconditioner) is a suite of parallel preconditioner developed at Lawrence Livermore National Lab.</p>
<p>There are two main classes of preconditioners developed in HYPRE: AMG (Algebraic MultiGrid) and Parasails (Parallel Sparse Approximate Inverse).</p>
<p>Now, suppose we want to solve <span class="math notranslate nohighlight">\(Ax=b\)</span>.</p>
<p>At the heart of AMG there is a series of progressively coarser (smaller) representations of the matrix <span class="math notranslate nohighlight">\(A\)</span>.
Given an approximation <span class="math notranslate nohighlight">\(\hat{x}\)</span> to the solution <span class="math notranslate nohighlight">\(x\)</span>, consider solving the residual equation <span class="math notranslate nohighlight">\(Ae=r\)</span> to find the error <span class="math notranslate nohighlight">\(e\)</span>, where <span class="math notranslate nohighlight">\(r=b-A\hat{x}\)</span>.
A fundamental principle of AMG is that it is an algebraically smooth error.
To reduce the algebraically smooth errors further, they need to be represented by a smaller defect equation (coarse grid residual equation) <span class="math notranslate nohighlight">\(A_ce_c=r_c\)</span>, which is cheaper to solve.
After solving this coarse equation, the solution is then interpolated in fine grid represented here by matrix <span class="math notranslate nohighlight">\(A\)</span>.
The quality of AMG depends on the choice of coarsening and interpolating operators.</p>
<p>The <em>sparse approximate inverse</em> approximates the inverse of a matrix <span class="math notranslate nohighlight">\(A\)</span> by a sparse matrix <span class="math notranslate nohighlight">\(M\)</span>.
A technical idea to construct matrix <span class="math notranslate nohighlight">\(M\)</span> is to minimize the Frobenuis norm of the residual matrix <span class="math notranslate nohighlight">\(I-MA\)</span>.
For more details on this preconditioner technics see <a class="reference internal" href="../reference.html#chow1997" id="id8">[CHOW1997]</a>.</p>
<p>HYPRE implement three Krylov subspace solvers: GMRES, PCG and BiCGStab.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Laplacian 3D solved with HYPRE</p>
<p>Let us consider again the 3D Laplacian example inside <strong>FreeFEM</strong> package where after discretization we want to solve the linear equation with Hypre.
The following example is a Laplacian 3D using Hypre as linear solver.
This is the same example as Hips one, so we just show here the lines where we set some Hypre parameters.</p>
<p>We first load the Hypre solver at line 2.
From line 6 to 18 we specifies the parameters to set to Hypre solver and in line 22 we set parameters to Hypre solver.</p>
<p>It should be noted that the meaning of the entries of these vectors is different from those of Hips.
In the case of HYPRE, the meaning of differents entries of vectors <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparm</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparm</span></code> are given in <a class="reference internal" href="#tabparallelizationiparmsdparmshypre"><span class="std std-numref">Table 14</span></a> to <a class="reference internal" href="#tabparallelizationiparmsdparmsschwartz"><span class="std std-numref">Table 18</span></a>.</p>
<p>In <a class="reference internal" href="#tabparallelizationconvergencetimehypre"><span class="std std-numref">Table 19</span></a> the results of running on Cluster Paradent of Grid5000 are reported.
We can see in this running example the efficiency of parallelism, in particular when AMG are use as preconditioner.</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;hipre_FreeFem&quot;</span> <span class="c1">//Load Hipre librairy</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">iparm</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">dparm</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iii</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">iii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">iparm</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">iii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">iii</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">iii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">dparm</span><span class="p">[</span><span class="n">iii</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">//PCG as krylov method</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//AMG as preconditionner 2: if ParaSails</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="c1">//Interpolation</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">//AMG Coarsen type</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//Measure type</span>
<span class="n">iparm</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">//Additive schwarz as smoother</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-13</span><span class="p">;</span> <span class="c1">//Tolerance to convergence</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="c1">//Threshold</span>
<span class="n">dparm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">;</span> <span class="c1">//Truncation factor</span>

<span class="p">...</span>

<span class="nf">set</span><span class="p">(</span><span class="n">Aa</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">,</span> <span class="kp">dparams</span><span class="o">=</span><span class="n">dparm</span><span class="p">,</span> <span class="kp">lparams</span><span class="o">=</span><span class="n">iparm</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<table border="1" class="docutils" id="tabparallelizationiparmsdparmshypre">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Definitions of common entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span></code> vectors for every preconditioner in HYPRE</span><a class="headerlink" href="#tabparallelizationiparmsdparmshypre" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td><p class="first">Solver identification:</p>
<p class="last">0: BiCGStab, 1: GMRES, 2: PCG. Default=1</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td><p class="first">Preconditioner identification:</p>
<p class="last">0: BOOMER AMG, 1: PILUT, 2: Parasails, 3: Schwartz Default=0</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>Maximum of iteration: Default=1000</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td>Krylov subspace dim: Default= 40</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span></code></td>
<td>Solver print info level: Default=2</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span></code></td>
<td>Solver log: Default=1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span></code></td>
<td>Solver stopping criteria only for BiCGStab : Default=1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code></td>
<td>Tolerance for convergence: Default=:math:<cite>1.0e-11</cite></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationiparmsdparmsboomer">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">Definitions of other entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span></code> if preconditioner is BOOMER AMG</span><a class="headerlink" href="#tabparallelizationiparmsdparmsboomer" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td>AMG interpolation type: Default=6</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td><p class="first">Specifies the use of GSMG - geometrically smooth coarsening and</p>
<p class="last">interpolation: Default=1</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span></code></td>
<td>AMG coarsen type: Default=6</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span></code></td>
<td>Defines whether local or global measures are used: Default=1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span></code></td>
<td>AMG cycle type: Default=1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span></code></td>
<td>AMG Smoother type: Default=1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span></code></td>
<td>AMG number of levels for smoothers: Default=3</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span></code></td>
<td>AMG number of sweeps for smoothers: Default=2</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span></code></td>
<td>Maximum number of multigrid levels: Default=25</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span></code></td>
<td><p class="first">Defines which variant of the Schwartz method isused:</p>
<p>0: hybrid multiplicative Schwartz method (no overlap across processor boundaries)</p>
<p>1: hybrid additive Schwartz method (no overlap across processor boundaries)</p>
<p>2: additive Schwartz method</p>
<p>3: hybrid multiplicative Schwartz method (with overlap across processor boundaries)</p>
<p class="last">Default=1</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span></code></td>
<td>Size of the system of PDEs: Default=1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span></code></td>
<td>Overlap for the Schwarz method: Default=1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span></code></td>
<td><p class="first">Type of domain used for the Schwarz method</p>
<p>0: each point is a domain</p>
<p>1: each node is a domain (only of interest in “systems” AMG)</p>
<p class="last">2: each domain is generated by agglomeration (default)</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td>AMG strength threshold: Default=0.25</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>Truncation factor for the interpolation: Default=1e-2</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td><p class="first">Sets a parameter to modify the definition of strength for</p>
<p class="last">diagonal dominant portions of the matrix: Default=0.9</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></code></td>
<td>Defines a smoothing parameter for the additive Schwartz method. Default=1</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="id9">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Definitions of other entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span></code> if preconditioner is PILUT</span><a class="headerlink" href="#id9" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td>Row size in Parallel ILUT: Default=1000</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td>Set maximum number of iterations: Default=30</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td>Drop tolerance in Parallel ILUT: Default=1e-5</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="id10">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">Definitions of other entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span></code> if preconditioner is ParaSails</span><a class="headerlink" href="#id10" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td>Number of levels in Parallel Sparse Approximate inverse: Default=1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td><p class="first">Symmetric parameter for the ParaSails preconditioner:</p>
<p>0: nonsymmetric and/or indefinite problem, and nonsymmetric preconditioner</p>
<p>1: SPD problem, and SPD (factored) preconditioner</p>
<p>2: nonsymmetric, definite problem, and SPD (factored) preconditioner</p>
<p class="last">Default=0</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></td>
<td><p class="first">Filters parameters. The filter parameter is used to drop small nonzeros in the preconditioner,</p>
<p class="last">to reduce the cost of applying the preconditioner: Default=0.1</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></code></td>
<td>Threshold parameter: Default=0.1</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationiparmsdparmsschwartz">
<caption><span class="caption-number">Table 18 </span><span class="caption-text">Definitions of other entries of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dparms</span></code> if preconditionner is Schwartz</span><a class="headerlink" href="#tabparallelizationiparmsdparmsschwartz" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span></code></td>
<td><p class="first">Defines which variant of the Schwartz method isused:</p>
<p>0: hybrid multiplicative Schwartz method (no overlap across processor boundaries)</p>
<p>1: hybrid additive Schwartz method (no overlap across processor boundaries)</p>
<p>2: additive Schwartz method</p>
<p>3: hybrid multiplicative Schwartz method (with overlap across processor boundaries)</p>
<p class="last">Default=1</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span></code></td>
<td>Overlap for the Schwartz method: Default=1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal highlight highlight-freefem"><span></span><span class="n">iparms</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span></code></td>
<td><p class="first">Type of domain used for the Schwartz method</p>
<p>0: each point is a domain</p>
<p>1: each node is a domain (only of interest in “systems” AMG)</p>
<p class="last">2: each domain is generated by agglomeration (default)</p>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tabparallelizationconvergencetimehypre">
<caption><span class="caption-number">Table 19 </span><span class="caption-text">Convergence and time for solving linear system</span><a class="headerlink" href="#tabparallelizationconvergencetimehypre" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="33%" />
<col width="10%" />
<col width="26%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><span class="math notranslate nohighlight">\(n=4\times10^6\)</span></th>
<th class="head" colspan="2"><span class="math notranslate nohighlight">\(nnz=13\times10^6\)</span></th>
<th class="head"><span class="math notranslate nohighlight">\(Te = 571.29\)</span></th>
</tr>
<tr class="row-even"><th class="head">np</th>
<th class="head" colspan="3">AMG</th>
</tr>
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head"><cite>nit</cite></th>
<th class="head" colspan="2"><cite>time</cite></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>8</td>
<td>6</td>
<td colspan="2">1491.83</td>
</tr>
<tr class="row-odd"><td>16</td>
<td>5</td>
<td colspan="2">708.49</td>
</tr>
<tr class="row-even"><td>32</td>
<td>4</td>
<td colspan="2">296.22</td>
</tr>
<tr class="row-odd"><td>64</td>
<td>4</td>
<td colspan="2">145.64</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="conclusion">
<h4>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline"> </a></h4>
<p>With the different runs presented here, we wanted to illustrate the gain in time when we increase the number of processors used for the simulations.
We saw that in every case the time for the construction of the finite element matrix is constant.
This is normal because until now this phase is sequential in <strong>FreeFEM</strong>.
In contrast, phases for solving the linear system are parallel.
We saw on several examples presented here that when we increase the number of processors, in general we decrease the time used for solving the linear systems.
But this is not true in every case.
In several case, when we increase the number of processors the time to convergence also increases.
There are two main reasons for this.
First, the increase of processors can lead to the increase of volume of exchanged data across processors consequently increasing the time for solving the linear systems.</p>
<p>Furthermore, in decomposition domain type preconditioners, the number of processors generally corresponds to the number of sub domains.
In subdomain methods, generally when we increase the number of subdomains we decrease convergence quality of the preconditioner.
This can increase the time used for solving linear equations.</p>
<p>To end this, we should note that good use of the preconditioners interfaced in <strong>FreeFEM</strong> is empiric, because it is difficult to know what is a good preconditioner for some type of problems.
Although, the efficiency of preconditioners sometimes depends on how its parameters are set.
For this reason we advise the user to pay attention to the meaning of the parameters in the user guide of the iterative solvers interfaced in <strong>FreeFEM</strong>.</p>
</div>
</div>
<div class="section" id="domain-decomposition">
<h3>Domain decomposition<a class="headerlink" href="#domain-decomposition" title="Permalink to this headline"> </a></h3>
<p>In the previous section, we saw that the phases to construct a matrix are sequential.
One strategy to construct the matrix in parallel is to divide geometrically the domain into subdomains.
In every subdomain we construct a local submatrix and after that we assemble every submatrix to form the global matrix.</p>
<p>We can use this technique to solve PDE directly in domain <span class="math notranslate nohighlight">\(\Omega\)</span>.
In this case, in every subdomains you have to define artificial boundary conditions to form consistent equations in every subdomains.
After this, you solve equation in every subdomains and define a strategy to obtain the global solution.</p>
<p>In terms of parallel programming for <strong>FreeFEM</strong>, with MPI, this means that the user must be able to divide processors avaible for computation into subgroups of processors and also must be able to realize different type of communications in <strong>FreeFEM</strong> script.
Here is a wrapper of some MPI functions.</p>
<div class="section" id="communicators-and-groups">
<h4>Communicators and groups<a class="headerlink" href="#communicators-and-groups" title="Permalink to this headline"> </a></h4>
<p><strong>Groups</strong></p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mpiGroup</span> <span class="n">grpe</span><span class="p">(</span><span class="kt">mpiGroup</span> <span class="n">gp</span><span class="p">,</span> <span class="n">KN_</span><span class="o">&lt;</span><span class="kt">long</span><span class="o">&gt;</span><span class="p">)</span></code>: Create MPI_Group from existing group <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gp</span></code> by given vector.</p>
<p><strong>Communicators</strong></p>
<p>Communicators is an abstract MPI object which allows MPI user to communicate across group of processors.
Communicators can be Intra-communicators(involves a single group) or Inter-communicators (involves two groups).
When we not specify type of communicator it will be Intra-communicators</p>
<p><strong>mpiComm cc(mpiComm comm, mpiGroup gp):</strong> Creates a new communicator.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> communicator(handle), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gp</span></code> group which is a subset of the group of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> (handle).
Return new communicator</p>
<p><strong>mpiComm cc(mpiGroup gp)</strong>: Same as previous constructor but default <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> here is <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_COMM_WORLD</span></code>.</p>
<p><strong>mpiComm cc(mpiComm comm, int color, int key):</strong> Creates new communicators based on <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">colors</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">key</span></code>.
This constructor is based on MPI_Comm_split routine of MPI.</p>
<p><strong>mpiComm cc(MPIrank p, int key):</strong> Same constructor than the last one.</p>
<p>Here <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">colors</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> is defined in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIrank</span></code>.
This constructor is based on <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Comm_split</span></code> routine of MPI.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Split communicator</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mpiComm</span> <span class="nf">comm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">color</span> <span class="o">=</span> <span class="nf">mpiRank</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">mpiComm</span> <span class="nf">ccc</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">mpiComm</span> <span class="nf">qpp</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">mpiComm</span> <span class="nf">cp</span><span class="p">(</span><span class="n">ccc</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<p><strong>mpiComm cc(mpiComm comm, int high):</strong> Creates an intracommunicator from an intercommunicator. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> intercommunicator, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">high</span></code>.</p>
<p>Used to order the groups within <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">comm</span></code> (logical) when creating the new communicator.
This constructor is based on <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Intercomm_merge</span></code> routine of MPI.</p>
<p><strong>mpiComm cc(MPIrank p1, MPIrank p2, int tag):</strong> This constructor creates an intercommuncator from two intracommunicators.
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p1</span></code> defined local (intra)communicator and rank in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">local_comm</span></code> of leader (often 0) while <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p2</span></code> defined remote communicator and rank in <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">peer_comm</span></code> of remote leader (often 0).
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">tag</span></code> Message tag to use in constructing intercommunicator.
This constructor is based on <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Intercomm_create</span></code>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Merge</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mpiComm</span> <span class="n">comm</span><span class="p">,</span> <span class="n">cc</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">color</span> <span class="o">=</span> <span class="nf">mpiRank</span><span class="p">(</span><span class="n">comm</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">rk</span> <span class="o">=</span> <span class="nf">mpiRank</span><span class="p">(</span><span class="n">comm</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="nf">mpiSize</span><span class="p">(</span><span class="n">comm</span><span class="p">);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Color values: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">color</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kt">mpiComm</span> <span class="nf">ccc</span><span class="p">(</span><span class="nf">processor</span><span class="p">((</span><span class="n">rk</span><span class="o">&lt;</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">comm</span><span class="p">),</span> <span class="n">rk</span><span class="p">);</span>
<span class="kt">mpiComm</span> <span class="nf">cp</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">rleader</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">rk</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span> <span class="n">rleader</span> <span class="o">=</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="p">}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rk</span> <span class="o">==</span> <span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">){</span> <span class="n">rleader</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="k">else</span><span class="p">{</span> <span class="n">rleader</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">mpiComm</span> <span class="n">qqp</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ccc</span><span class="p">),</span> <span class="nf">processor</span><span class="p">(</span><span class="n">rleader</span><span class="p">,</span> <span class="n">comm</span><span class="p">),</span> <span class="mi">12345</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">aaa</span> <span class="o">=</span> <span class="nf">mpiSize</span><span class="p">(</span><span class="n">ccc</span><span class="p">);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of processor: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">aaa</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="process">
<h4>Process<a class="headerlink" href="#process" title="Permalink to this headline"> </a></h4>
<p>In <strong>FreeFEM</strong> we wrap MPI process by function call <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span></code> which create internal <strong>FreeFEM</strong> object call <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIrank</span></code>.
This mean that do not use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIrank</span></code> in <strong>FreeFEM</strong> script.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code>: Keep process rank inside object <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPIrank</span></code>.
Rank is inside <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_COMM_WORLD</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code> process rank inside communicator cc.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code> process rank inside communicator cc.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processorblock</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code>: This function is exactlly the same than <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code> but is use in case of blocking communication.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processorblock</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code>: This function is exactly the same as <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code> but uses a synchronization point.</p>
</div>
<div class="section" id="points-to-points-communicators">
<h4>Points to Points communicators<a class="headerlink" href="#points-to-points-communicators" title="Permalink to this headline"> </a></h4>
<p>In <strong>FreeFEM</strong> you can call MPI points to points communications functions.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Send</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code> : Blocking send of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> to processor of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rank</span> <span class="n">rk</span></code> inside communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cc</span></code>.
Note that <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Matrix</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Recv</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code>: Receive <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> from process of rank <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> in communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cc</span></code>.</p>
<p>Note that <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Matrix</span></code> and should be the same type than corresponding send.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Isend</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code> : Non blocking send of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> to processor of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rank</span> <span class="n">rk</span></code> inside communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cc</span></code>.</p>
<p>Note that <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">matrix</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">Recv</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code>: Receive corresponding to send.</p>
</div>
<div class="section" id="global-operations">
<h4>Global operations<a class="headerlink" href="#global-operations" title="Permalink to this headline"> </a></h4>
<p>In <strong>FreeFEM</strong> you can call MPI global communication functions.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">broadcast</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code>: Process <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> Broadcast <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> to all process inside <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">communicator</span> <span class="n">cc</span></code>.
Note that <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Matrix</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">broadcast</span><span class="p">(</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">),</span> <span class="n">Data</span> <span class="n">D</span><span class="p">)</span></code>: Process <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> Broadcast <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> to all process inside <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_COMM_WORLD</span></code>.
Note that <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">D</span></code> can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">complex</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mesh3</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Matrix</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiAlltoall</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">)</span></code>: Sends <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">data</span> <span class="n">a</span></code> from all to all processes.
Receive buffer is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">b</span></code>.
This is done inside communicator <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_COMM_WORLD</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiAlltoall</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code>: Sends <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">data</span> <span class="n">a</span></code> from all to all processes. Receive buffer is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">b</span></code>.
This is done inside communicator <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">cc</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiGather</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(</span><span class="kt">mpiComm</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rk</span><span class="p">)</span></code>: Gathers together values <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">a</span></code> from a group of processes.
Process of rank <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> get data on communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code>.
This function is like <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Gather</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiAllgather</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">)</span></code>: Gathers <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">a</span></code> from all processes and distribute it to all in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">b</span></code>.
This is done inside communicator <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_COMM_WORLD</span></code>.
This function is like <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Allgather</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiAllgather</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">)</span></code>: Gathers <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">a</span></code> from all processes and distribute it to all in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">b</span></code>.
This is done inside <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">communicator</span> <span class="n">cc</span></code>.
This function is like <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Allgather</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiScatter</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span><span class="n">Data</span> <span class="n">b</span><span class="p">,</span><span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">))</span></code>: Sends <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">a</span></code> from one process whith rank <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> to all other processes in group represented by communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mpiComm</span> <span class="n">cc</span></code>.</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mpiReduce</span><span class="p">(</span><span class="n">Data</span> <span class="n">a</span><span class="p">,</span> <span class="n">Data</span> <span class="n">b</span><span class="p">,</span> <span class="nf">processor</span><span class="p">(</span><span class="kt">int</span> <span class="n">rk</span><span class="p">,</span> <span class="kt">mpiComm</span> <span class="n">cc</span><span class="p">),</span> <span class="n">MPI_Op</span> <span class="kp">op</span><span class="p">)</span></code> Reduces values <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">a</span></code> on all processes to a single value <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Data</span> <span class="n">b</span></code> on process of rank <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">rk</span></code> and communicator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cc</span></code>.</p>
<p>Operation use in reduce is: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Op</span> <span class="kp">op</span></code> which can be: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiMAX</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiMIN</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiSUM</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiPROD</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLAND</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLOR</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiLXOR</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiBAND</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpiBXOR</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mpiMAXLOC</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mpiMINLOC</span></code>.</p>
<p>Note that, for all global operations, only <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> are data type take in account in <strong>FreeFEM</strong>.</p>
</div>
</div>
<div class="section" id="hpddm-solvers">
<h3>HPDDM solvers<a class="headerlink" href="#hpddm-solvers" title="Permalink to this headline"> </a></h3>
<p>Real valued problems (diffusion, heat, elasticity and Stokes) and complex valued problems (Maxwell and Helmholtz) are given in both 2D and 3D.
We detail here the 3D elasticity problem and the 3D time-dependent heat problem.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Elasticity 3D</p>
<p>A three dimensional elasticity problem is defined.
The solver is a domain decomposition method.
Domain decomposition methods are a natural framework for parallel computers.
The scripts run on multicores computers (from 2 to tens of thousands of cores).
Recall that like in any MPI code the number of MPI processes, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpisize</span></code>, is given in the command line via the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="n">np</span></code>.
We focus on the script <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Elasticity3D</span><span class="p">.</span><span class="n">edp</span></code> but the other scripts have the same structure.
The command line to run the example on four processes with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ffglut</span></code> visualization is: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ff</span><span class="o">-</span><span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="mi">4</span> <span class="n">Elasticity3D</span><span class="p">.</span><span class="n">edp</span> <span class="o">-</span><span class="n">glut</span> <span class="n">ffglut</span></code></p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;hpddm&quot;</span> <span class="c1">//load HPDDM plugin</span>
<span class="kt">macro</span> <span class="n">partitioner</span><span class="p">()</span><span class="n">metis</span><span class="c1">//metis, scotch, or parmetis</span>
<span class="kt">macro</span> <span class="n">dimension</span><span class="p">()</span><span class="mi">3</span><span class="c1">//2D or 3D</span>
<span class="kt">macro</span> <span class="n">vectorialfe</span><span class="p">()</span><span class="nc">P1</span><span class="c1">//</span>
<span class="cp">include</span> <span class="s">&quot;macro_ddm.idp&quot;</span> <span class="c1">//additional DDM functions</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="n">def</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">#</span><span class="kp">B</span><span class="p">,</span> <span class="n">i</span><span class="o">#</span><span class="n">C</span><span class="p">]</span> <span class="c1">//vector field definition</span>
<span class="kt">macro</span> <span class="kp">init</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="c1">//vector field initialization</span>

<span class="kt">real</span> <span class="n">Sqrt</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">);</span>
<span class="kt">macro</span> <span class="nf">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="kp">B</span><span class="p">),</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="n">C</span><span class="p">),</span>
    <span class="p">(</span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="kp">B</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="n">C</span><span class="p">))</span> <span class="o">/</span> <span class="n">Sqrt</span><span class="p">,</span>
    <span class="p">(</span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="n">C</span><span class="p">))</span> <span class="o">/</span> <span class="n">Sqrt</span><span class="p">,</span>
    <span class="p">(</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="kp">B</span><span class="p">))</span> <span class="o">/</span> <span class="n">Sqrt</span><span class="p">]</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="kp">B</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="o">#</span><span class="n">C</span><span class="p">))</span> <span class="c1">//</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9000.0</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">strain</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">Young</span> <span class="o">=</span> <span class="mf">2.0e11</span><span class="p">;</span> <span class="c1">// steel</span>
<span class="kt">real</span> <span class="n">poisson</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">Pk</span> <span class="o">=</span> <span class="p">[</span><span class="n">vectorialfe</span><span class="p">,</span> <span class="n">vectorialfe</span><span class="p">,</span> <span class="n">vectorialfe</span><span class="p">];</span>

<span class="kt">string</span> <span class="n">deflation</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-deflation&quot;</span><span class="p">,</span> <span class="s">&quot;geneo&quot;</span><span class="p">);</span> <span class="c1">//coarse space construction</span>
<span class="kt">int</span> <span class="n">overlap</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-overlap&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//geometric overlap between subdomains</span>
<span class="kt">int</span> <span class="n">fakeInterface</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-interface&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">//interface between subdomains</span>
<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-split&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//refinement factor</span>
<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_p&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="kt">mpiComm</span> <span class="n">comm</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">excluded</span> <span class="o">=</span> <span class="nf">splitComm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">topology</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_topology&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">usedARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_exclude&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">));</span>

<span class="c1">// Display</span>
<span class="k">if</span> <span class="p">(</span><span class="kr">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; --- &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">mpirank</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="o">/</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">mpisize</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - Elasticity3D.edp - input parameters: refinement factor = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - overlap = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">overlap</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Mesh</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">LL</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span>
<span class="n">meshN</span> <span class="n">ThBorder</span><span class="p">,</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">]);</span>
<span class="kt">fespace</span> <span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">Pk</span><span class="p">);</span> <span class="c1">//local finite element space</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">arrayIntersection</span><span class="p">;</span> <span class="c1">//ranks of neighboring subdomains</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="n">restrictionIntersection</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">//local-to-neighbors renumbering</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">D</span><span class="p">;</span> <span class="c1">//partition of unity</span>
<span class="p">{</span>
    <span class="n">meshN</span> <span class="n">ThGlobal</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">],</span> <span class="kr">label</span><span class="o">=</span><span class="n">LL</span><span class="p">);</span> <span class="c1">//global mesh</span>
    <span class="n">build</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">ThBorder</span><span class="p">,</span> <span class="n">ThGlobal</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">arrayIntersection</span><span class="p">,</span> <span class="n">restrictionIntersection</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">excluded</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Problem</span>
<span class="kt">real</span> <span class="n">tmp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">poisson</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">Young</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">tmp</span><span class="p">);</span>
<span class="kt">real</span> <span class="n">lambda</span> <span class="o">=</span> <span class="n">Young</span> <span class="o">*</span> <span class="n">poisson</span> <span class="o">/</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">poisson</span><span class="p">));</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rhs</span><span class="p">;</span> <span class="c1">//local right-hand side</span>
<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">Mat</span><span class="p">;</span> <span class="c1">//local operator</span>
<span class="p">{</span> <span class="c1">//local weak form</span>
    <span class="n">meshN</span> <span class="n">ThAugmented</span> <span class="o">=</span> <span class="n">Th</span> <span class="o">+</span> <span class="n">ThBorder</span><span class="p">;</span>
    <span class="kt">varf</span> <span class="nf">vPb</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">)(</span>
              <span class="n">lambda</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="n">intN</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">)(</span>
              <span class="n">f</span> <span class="o">*</span> <span class="n">vC</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uB</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uC</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="p">;</span>

    <span class="kt">fespace</span> <span class="nf">WhAugmented</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">,</span> <span class="n">Pk</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="o">=</span> <span class="n">vPb</span><span class="p">(</span><span class="n">WhAugmented</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rhsFull</span> <span class="o">=</span> <span class="n">vPb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">matrix</span> <span class="n">R</span> <span class="o">=</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">);</span>
    <span class="n">renumbering</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rhsFull</span><span class="p">,</span> <span class="n">rhs</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ThBorder</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">]);</span>

<span class="n">dschwarz</span> <span class="kp">A</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">arrayIntersection</span><span class="p">,</span> <span class="n">restrictionIntersection</span><span class="p">,</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">D</span><span class="p">);</span>

<span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">sparams</span> <span class="o">=</span> <span class="s">&quot;-hpddm_schwarz_method ras -hpddm_schwarz_coarse_correction balanced -hpddm_variant right -hpddm_verbosity 1 -hpddm_geneo_nu 10&quot;</span><span class="p">);</span>

<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">Opt</span><span class="p">;</span> <span class="c1">//local operator with optimized boundary conditions</span>
<span class="n">dpair</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="kp">solver</span> <span class="o">=</span> <span class="n">getOption</span><span class="p">(</span><span class="s">&quot;schwarz_method&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="kp">solver</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="kp">solver</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="kp">solver</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span> <span class="c1">//optimized Schwarz methods</span>
        <span class="kt">fespace</span> <span class="n">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
        <span class="kt">real</span> <span class="n">kZero</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-kZero&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">);</span>
        <span class="n">Ph</span> <span class="n">transmission</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">kZero</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">lambda</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">lambda</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">mu</span><span class="p">);</span>
        <span class="kt">varf</span> <span class="nf">vOptimized</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
                  <span class="n">lambda</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="n">intN1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">)(</span>
                  <span class="n">transmission</span> <span class="o">*</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uB</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uC</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="p">;</span>
        <span class="n">Opt</span> <span class="o">=</span> <span class="n">vOptimized</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">mpisize</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">isSetOption</span><span class="p">(</span><span class="s">&quot;schwarz_coarse_correction&quot;</span><span class="p">)){</span> <span class="c1">//two-level Schwarz methods</span>
        <span class="k">if</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
            <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">);</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="kt">varf</span> <span class="n">vPbNoPen</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
                      <span class="n">lambda</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uB</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">uC</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="p">;</span>
            <span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">noPen</span> <span class="o">=</span> <span class="n">vPbNoPen</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;geneo&quot;</span><span class="p">)</span> <span class="c1">//standard GenEO, no need for RHS -&gt; deduced from LHS (Neumann matrix)</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">);</span>
            <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;dtn&quot;</span><span class="p">){</span>
                <span class="kt">varf</span> <span class="n">vMass</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">=</span> <span class="n">intN1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">)(</span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span><span class="p">);</span>
                <span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">massMatrix</span> <span class="o">=</span> <span class="n">vMass</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">massMatrix</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;geneo-2&quot;</span><span class="p">)</span> <span class="c1">//GenEO-2 for optimized Schwarz methods, need for RHS (LHS is still Neumann matrix)</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// Solve</span>
<span class="n">Wh</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="c1">//local solution</span>

<span class="k">if</span><span class="p">(</span><span class="n">Opt</span><span class="p">.</span><span class="kr">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//optimized Schwarz methods</span>
    <span class="n">DDM</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">excluded</span><span class="o">=</span><span class="n">excluded</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">,</span> <span class="n">O</span><span class="o">=</span><span class="n">Opt</span><span class="p">);</span>
<span class="k">else</span>
    <span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">;</span>

<span class="c1">// Error</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">err</span><span class="p">(</span><span class="n">u</span><span class="p">[].</span><span class="kr">n</span><span class="p">);</span>
<span class="kp">err</span> <span class="o">=</span> <span class="kp">A</span> <span class="o">*</span> <span class="n">u</span><span class="p">[];</span> <span class="c1">//global matrix-vector product</span>
<span class="kp">err</span> <span class="o">-=</span> <span class="n">rhs</span><span class="p">;</span>

<span class="c1">// Plot</span>
<span class="n">plotMPI</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="s">&quot;Global solution&quot;</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">def</span><span class="p">,</span> <span class="kt">real</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotMPI</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">err</span><span class="p">,</span> <span class="s">&quot;Global residual&quot;</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">def</span><span class="p">,</span> <span class="kt">real</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="kt">real</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">2000.0</span><span class="p">;</span>
<span class="n">meshN</span> <span class="n">ThMoved</span> <span class="o">=</span> <span class="n">movemesh3</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">transfo</span> <span class="o">=</span> <span class="p">[</span><span class="kr">x</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">u</span><span class="p">,</span> <span class="kr">y</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">uB</span><span class="p">,</span> <span class="kr">z</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">uC</span><span class="p">]);</span>
<span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="kr">mpirank</span><span class="p">;</span>
<span class="n">plotMPI</span><span class="p">(</span><span class="n">ThMoved</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="s">&quot;Global moved solution&quot;</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">def</span><span class="p">,</span> <span class="kt">real</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The macro <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">build</span></code> is of particular interest since it handles the data distribution among the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpisize</span></code> MPI processes with the following steps:</p>
<blockquote>
<div><ul class="simple">
<li>The initial mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ThGlobal</span></code> is partitioned by process 0 into <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpisize</span></code> submeshes</li>
<li><dl class="first docutils">
<dt>The partition is broadcasted to every process <span class="math notranslate nohighlight">\(i\)</span> for 0 &lt; <span class="math notranslate nohighlight">\(i\)</span> &lt; <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">mpisize</span></code>.</dt>
<dd>From then on, all tasks are parallel.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Each process creates the local submesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> (if the refinement factor <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">s</span></code> defined via the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="kp">split</span></code> is larger than 1, each local edge is splitted into <span class="math notranslate nohighlight">\(s\)</span> subedges, resulting in each element being split into <span class="math notranslate nohighlight">\(s^2\)</span> element in 2D and <span class="math notranslate nohighlight">\(s^3\)</span> elements in 3D) so that the collection of these submeshes is an overlapping domain decomposition of a refined mesh.</dt>
<dd>The number of extra layers added to the initial partition is monitored by the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">overlap</span></code>.</dd>
</dl>
</li>
<li>Connectivity structures are created</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">D</span></code> is the diagonal of the local partition of unity (see <a class="reference internal" href="#paralleldistributedvectorshpddm"><span class="std std-ref">Distributed vectors in HPDDM</span></a>)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">arrayIntersection</span></code> is the list of neighbors of the current subdomain</li>
<li>For <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">j</span></code> in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">arrayIntersection</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">restrictionIntersection</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></code> is the list of the degrees of freedom that belong to the intersection of the current subdomain with its neighbor <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">j</span></code>.</li>
</ul>
</div></blockquote>
<p>Then, the variational formulation <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">vPb</span></code> of a three dimensional elasticity problem is used to assemble a local matrix <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Mat</span></code>.
This matrix along with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">D</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">arrayIntersection</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">restrictionIntersection</span></code> are arguments for the constructor of the distributed matrix <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">A</span></code>.
This is enough to solve the problem with a one-level additive Schwarz method which can be either ASM or RAS.</p>
<p>For some problems it is interesting to use optimized interface conditions.
When there are many subdomains, it is usually profitable to add a second level to the solver.
Options are set in the sequel of the script:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">sparams</span><span class="o">=</span><span class="s">&quot;-hpddm_schwarz_method ras -hpddm_schwarz_coarse_correction balanced -hpddm_variant right -hpddm_verbosity 1 -hpddm_geneo_nu 10&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>In the above line, the first option selects the one-level preconditioner <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ras</span></code> (possible choices are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ras</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">oras</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">soras</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">asm</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">osm</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">none</span></code>), the second option selects the correction formula for the second level here <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">balanced</span></code> (possible options are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">deflated</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">additive</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">balanced</span></code>), the third option selects right preconditioning, the fourth one is verbosity level of HPDDM (different from the one of <strong>FreeFEM</strong>), the fifth one prints all possible options of HPPDM and the last one specifies the number of coarse degrees of freedom per subdomain of the GENEO coarse space.
All other options of <a class="reference external" href="https://github.com/hpddm/hpddm/blob/master/doc/cheatsheet.pdf">HPDDM library</a> can be selected via the <strong>FreeFEM</strong> function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">set</span></code>.</p>
<p>In the last part of the script, the global linear system is solved by the domain decomposition method defined above.</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Solve</span>
<span class="n">Wh</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="c1">//local solution</span>

<span class="k">if</span><span class="p">(</span><span class="n">Opt</span><span class="p">.</span><span class="kr">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//optimized Schwarz methods</span>
<span class="n">DDM</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">excluded</span><span class="o">=</span><span class="n">excluded</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">,</span> <span class="n">O</span><span class="o">=</span><span class="n">Opt</span><span class="p">);</span>
<span class="k">else</span>
<span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="time-dependent-problem">
<h3>Time dependent problem<a class="headerlink" href="#time-dependent-problem" title="Permalink to this headline"> </a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Heat 3D</p>
<p>A three dimensional heat problem</p>
<div class="math notranslate nohighlight">
\[\frac{\partial u}{\partial t} - \Delta u = 1,\ \ \ u(0,\cdot) := 0 \text{ in }\Omega\,.\]</div>
<p>is discretized by an implicit Euler scheme. At each time step <span class="math notranslate nohighlight">\(n\)</span>, we shall seek <span class="math notranslate nohighlight">\(u^n(x,y,z)\)</span> satisfying for all <span class="math notranslate nohighlight">\(w\in H^1(\Omega)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \frac{u^n-u^{n-1}}{\delta t}\,w + \nabla u^n \nabla w = \int_\Omega w ,\ \ \ u^0 := 0 \text{ in }\Omega\,.\]</div>
<p>so that at each time step a linear system:</p>
<div class="math notranslate nohighlight">
\[(M+dt*K) u^n[] = M*u^{n-1}[] + \delta t*F\]</div>
<p>is solved by a domain decomposition method where <span class="math notranslate nohighlight">\(M\)</span> is the mass matrix and <span class="math notranslate nohighlight">\(K\)</span> is the rigidity matrix. In order to save computational efforts, the domain decomposition method preconditioner is built only once and then reused for all subsequent solves with matrix <span class="math notranslate nohighlight">\(A:=M+dt*K\)</span>.
The distributed matrix vector product with matrix <span class="math notranslate nohighlight">\(M\)</span> is made through the call to the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dmv</span></code> using the partition of unity associated to matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;hpddm&quot;</span> <span class="c1">//load HPDDM plugin</span>
<span class="kt">macro</span> <span class="n">partitioner</span><span class="p">()</span><span class="n">metis</span><span class="c1">//metis, scotch, or parmetis</span>
<span class="kt">macro</span> <span class="n">dimension</span><span class="p">()</span><span class="mi">3</span><span class="c1">//2D or 3D</span>
<span class="cp">include</span> <span class="s">&quot;macro_ddm.idp&quot;</span> <span class="c1">//additional DDM functions</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="n">def</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="n">i</span> <span class="c1">//scalar field definition</span>
<span class="kt">macro</span> <span class="kp">init</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="n">i</span> <span class="c1">//scalar field initialization</span>
<span class="kt">macro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">//three-dimensional gradient</span>

<span class="c1">// Parameters</span>
<span class="kt">func</span> <span class="n">Pk</span> <span class="o">=</span> <span class="nc">P2</span><span class="p">;</span> <span class="c1">//finite element space</span>

<span class="kt">string</span> <span class="n">deflation</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-deflation&quot;</span><span class="p">,</span> <span class="s">&quot;geneo&quot;</span><span class="p">);</span> <span class="c1">//coarse space construction</span>
<span class="kt">int</span> <span class="n">overlap</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-overlap&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//geometric overlap between subdomains</span>
<span class="kt">int</span> <span class="n">fakeInterface</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-interface&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">//interface between subdomains</span>
<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-split&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//refinement factor</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-dt&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span> <span class="c1">//time step</span>
<span class="kt">int</span> <span class="n">iMax</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-iMax&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">//number of iterations</span>

<span class="kt">mpiComm</span> <span class="n">comm</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_p&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">excluded</span> <span class="o">=</span> <span class="nf">splitComm</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">topology</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_topology&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span><span class="n">usedARGV</span><span class="p">(</span><span class="s">&quot;-hpddm_master_exclude&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">));</span>

<span class="c1">// Display</span>
<span class="k">if</span> <span class="p">(</span><span class="kr">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="kr">mpirank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; --- &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">mpirank</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="o">/</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">mpisize</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - Heat3D.edp - input parameters: refinement factor = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - overlap = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">overlap</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Mesh</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">LL</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="n">meshN</span> <span class="n">ThBorder</span><span class="p">,</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">]);</span>
<span class="kt">fespace</span> <span class="nf">Wh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">Pk</span><span class="p">);</span> <span class="c1">//local finite element space</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">arrayIntersection</span><span class="p">;</span> <span class="c1">//ranks of neighboring subdomains</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="n">restrictionIntersection</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">//local-to-neighbors renumbering</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">D</span><span class="p">;</span> <span class="c1">//partition of unity</span>
<span class="p">{</span>
    <span class="n">meshN</span> <span class="n">ThGlobal</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-global&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">],</span> <span class="kr">label</span><span class="o">=</span><span class="n">LL</span><span class="p">);</span> <span class="c1">//global mesh</span>
    <span class="n">build</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">ThBorder</span><span class="p">,</span> <span class="n">ThGlobal</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">arrayIntersection</span><span class="p">,</span> <span class="n">restrictionIntersection</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">excluded</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Problem</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rhs</span><span class="p">;</span> <span class="c1">// local right-hand side</span>
<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">Mat</span><span class="p">;</span> <span class="c1">//local operator</span>
<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">M</span><span class="p">;</span> <span class="c1">//local mass matrix</span>
<span class="p">{</span> <span class="c1">//local weak form</span>
    <span class="n">meshN</span> <span class="n">ThAugmented</span> <span class="o">=</span> <span class="n">Th</span> <span class="o">+</span> <span class="n">ThBorder</span><span class="p">;</span>
    <span class="kt">varf</span> <span class="nf">vPb</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">)(</span>
              <span class="n">u</span> <span class="o">*</span> <span class="n">v</span>
            <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="n">intN</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">)(</span>
              <span class="n">dt</span> <span class="o">*</span> <span class="n">v</span>
        <span class="p">)</span>
        <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="p">;</span>
    <span class="kt">fespace</span> <span class="nf">WhAugmented</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">,</span> <span class="n">Pk</span><span class="p">);</span>
    <span class="n">Mat</span> <span class="o">=</span> <span class="n">vPb</span><span class="p">(</span><span class="n">WhAugmented</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rhsFull</span> <span class="o">=</span> <span class="n">vPb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">matrix</span> <span class="n">R</span> <span class="o">=</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">);</span>
    <span class="kt">varf</span> <span class="nf">vPbM</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">ThAugmented</span><span class="p">)(</span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span><span class="p">);</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">vPbM</span><span class="p">(</span><span class="n">WhAugmented</span><span class="p">,</span> <span class="n">WhAugmented</span><span class="p">);</span>
    <span class="n">renumbering</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rhsFull</span><span class="p">,</span> <span class="n">rhs</span><span class="p">);</span>
    <span class="n">renumbering</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rhsFull</span><span class="p">,</span> <span class="n">rhs</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">ThBorder</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">]);</span>

<span class="n">dschwarz</span> <span class="kp">A</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">arrayIntersection</span><span class="p">,</span> <span class="n">restrictionIntersection</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="n">D</span><span class="p">);</span>

<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">Opt</span><span class="p">;</span> <span class="c1">//local operator with optimized boundary conditions</span>
<span class="n">dpair</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="kp">solver</span> <span class="o">=</span> <span class="n">getOption</span><span class="p">(</span><span class="s">&quot;schwarz_method&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="kp">solver</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="kp">solver</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="kp">solver</span> <span class="o">==</span> <span class="mi">4</span><span class="p">){</span> <span class="c1">//optimized Schwarz methods</span>
        <span class="kt">fespace</span> <span class="n">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
        <span class="kt">real</span> <span class="n">kZero</span> <span class="o">=</span> <span class="nf">getARGV</span><span class="p">(</span><span class="s">&quot;-kZero&quot;</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">);</span>
        <span class="n">Ph</span> <span class="n">transmission</span> <span class="o">=</span> <span class="n">kZero</span><span class="p">;</span>
        <span class="kt">varf</span> <span class="nf">vOptimized</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
                  <span class="n">u</span> <span class="o">*</span> <span class="n">v</span>
                <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="n">intN1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">)(</span>
                  <span class="n">transmission</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="p">;</span>
        <span class="n">Opt</span> <span class="o">=</span> <span class="n">vOptimized</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">mpisize</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">isSetOption</span><span class="p">(</span><span class="s">&quot;schwarz_coarse_correction&quot;</span><span class="p">)){</span> <span class="c1">//two-level Schwarz methods</span>
        <span class="k">if</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
            <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">);</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="kt">varf</span> <span class="n">vPbNoPen</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="o">=</span> <span class="n">intN</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
                      <span class="n">u</span> <span class="o">*</span> <span class="n">v</span>
                    <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="p">;</span>
            <span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">noPen</span> <span class="o">=</span> <span class="n">vPbNoPen</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;geneo&quot;</span><span class="p">)</span> <span class="c1">//standard GenEO, no need for RHS -&gt; deduced from LHS (Neumann matrix)</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="p">);</span>
            <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;dtn&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">varf</span> <span class="n">vMass</span> <span class="p">(</span><span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">def</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">=</span> <span class="n">intN1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fakeInterface</span><span class="p">)(</span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span><span class="p">);</span>
                <span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">massMatrix</span> <span class="o">=</span> <span class="n">vMass</span><span class="p">(</span><span class="n">Wh</span><span class="p">,</span> <span class="n">Wh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">);</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">massMatrix</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">deflation</span> <span class="o">==</span> <span class="s">&quot;geneo-2&quot;</span><span class="p">)</span> <span class="c1">//GenEO-2 for optimized Schwarz methods, need for RHS (LHS is still Neumann matrix)</span>
                <span class="n">attachCoarseOperator</span><span class="p">(</span><span class="kr">mpiCommWorld</span><span class="p">,</span> <span class="kp">A</span><span class="p">,</span> <span class="kp">A</span><span class="o">=</span><span class="n">noPen</span><span class="p">,</span> <span class="kp">B</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">Opt</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Solve</span>
<span class="nf">set</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="kp">sparams</span><span class="o">=</span><span class="s">&quot;-hpddm_reuse_preconditioner=1&quot;</span><span class="p">);</span>
<span class="n">Wh</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="n">def</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">=</span> <span class="kp">init</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span> <span class="c1">//local solution</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">iMax</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">newRhs</span><span class="p">(</span><span class="n">rhs</span><span class="p">.</span><span class="kr">n</span><span class="p">);</span>
    <span class="n">dmv</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">newRhs</span><span class="p">);</span> <span class="c1">//newRhs = M * u[]</span>
    <span class="n">newRhs</span> <span class="o">+=</span> <span class="n">rhs</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Opt</span><span class="p">.</span><span class="kr">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//optimized Schwarz methods</span>
    <span class="n">DDM</span><span class="p">(</span><span class="kp">A</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="n">newRhs</span><span class="p">,</span> <span class="n">excluded</span><span class="o">=</span><span class="n">excluded</span><span class="p">,</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret</span><span class="p">,</span> <span class="n">O</span><span class="o">=</span><span class="n">Opt</span><span class="p">);</span>
    <span class="k">else</span>
    <span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="kp">A</span><span class="o">^-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">newRhs</span><span class="p">;</span>

    <span class="n">plotMPI</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">[],</span> <span class="s">&quot;Global solution&quot;</span><span class="p">,</span> <span class="n">Pk</span><span class="p">,</span> <span class="n">def</span><span class="p">,</span> <span class="kt">real</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="distributed-vectors-in-hpddm">
<span id="paralleldistributedvectorshpddm"></span><h3>Distributed vectors in HPDDM<a class="headerlink" href="#distributed-vectors-in-hpddm" title="Permalink to this headline"> </a></h3>
<p>We give here some hints on the way vectors are distributed among <span class="math notranslate nohighlight">\(np\)</span> processes when using <strong>FreeFEM</strong> interfaced with HPDDM.
The set of degrees of freedom <span class="math notranslate nohighlight">\({\mathcal N}\)</span> is decomposed into <span class="math notranslate nohighlight">\(np\)</span> overlapping sets <span class="math notranslate nohighlight">\(({\mathcal N}_i)_{1\le i\le np}\)</span>.</p>
<p>A MPI-process is in charge of each subset.
Let <span class="math notranslate nohighlight">\(n:=\#{\mathcal N}\)</span> be the number of degrees of freedom of the global finite element space.
Let <span class="math notranslate nohighlight">\(R_i\)</span> denote the restriction operator from <span class="math notranslate nohighlight">\(\R^n\)</span> onto <span class="math notranslate nohighlight">\(\R^{\#{\mathcal N}_i}\)</span>.
We have also defined local diagonal matrices <span class="math notranslate nohighlight">\(D_i\in \R^{\#{\mathcal N}_i}\times \R^{\#{\mathcal N}_i}\)</span> so that we have a partition of unity at the algebraic level:</p>
<div class="math notranslate nohighlight" id="equation-eq-hpddm-14">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-hpddm-14" title="Permalink to this equation"> </a></span>\[{\mathbf U} = \sum_{i=1}^{np} R_i^T\,D_i\,R_i\,{\mathbf U}\ \ \ \ \forall\ {\mathbf U}\in\R^n\,.\]</div>
<p>A global vector <span class="math notranslate nohighlight">\({\mathbf U}\in\R^n\)</span> is actually not stored.
Rather, it is stored in a distributed way.
Each process <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(1\le i\le N\)</span>, stores the local vector <span class="math notranslate nohighlight">\({\mathbf U}_i:=R_i {\mathbf U}\in \R^{\#{\mathcal N}_i}\)</span>.</p>
<p>It is important to ensure that the result of all linear algebra operators applied to this representation are coherent.</p>
<p>As an example, consider the scalar product of two distributed vectors <span class="math notranslate nohighlight">\({\mathbf U}, {\mathbf V} \in \mathbb{R}^{n}\)</span>.
Using the partition of unity <a class="reference internal" href="#equation-eq-hpddm-14">(39)</a>, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}({\mathbf U}, {\mathbf V}) = \left({\mathbf U}, \sum_{i=1}^{np} R_i^T D_i R_i {\mathbf V}\right) &amp;= \sum_{i=1}^{np} (R_i {\mathbf U}, D_i R_i {\mathbf V})\\
&amp;=\sum_{i=1}^{np} \left({\mathbf U}_i, D_i {\mathbf V}_i\right)\,.\end{split}\]</div>
<p>Thus, the formula for the scalar product is:</p>
<div class="math notranslate nohighlight">
\[({\mathbf U}, {\mathbf V}) = \sum_{i = 1}^{np} (R_i {\mathbf U}, D_i R_i {\mathbf V})\,.\]</div>
<p>Local scalar products are performed concurrently.
Thus, the implementation is parallel except for the sum which corresponds to a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">MPI_Reduce</span></code> call across the <span class="math notranslate nohighlight">\(np\)</span> MPI processes.</p>
<p>Note also that the implementation relies on the knowledge of a partition of unity so that the <strong>FreeFEM</strong> syntax is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dscalprod</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></code>.</p>
<p>A <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">axpy</span></code> procedure <span class="math notranslate nohighlight">\(y \leftarrow \alpha\,x+y\)</span> for <span class="math notranslate nohighlight">\(x,y\in \mathbb{R}^{n}\)</span> and <span class="math notranslate nohighlight">\(\alpha\in\R\)</span> is easily implemented concurrently for distributed vectors in the form:</p>
<div class="math notranslate nohighlight">
\[y_i \leftarrow \alpha\,x_i+y_i\,, \forall\ 1\le i \le np\,.\]</div>
<p>The matrix vector product is more involved and details are given in the SIAM book <a class="reference external" href="https://www.ljll.math.upmc.fr/nataf/OT144DoleanJolivetNataf_full.pdf">An Introduction to Domain Decomposition Methods: algorithms, theory and parallel implementation</a> and even more details are given in <a class="reference external" href="http://jolivet.perso.enseeiht.fr/thesis.pdf">P. Jolivet’s PhD manuscrit</a>.</p>
</div>
</div>
</div>


		</div>
		
		<div id="toc">
	<div>
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Parallelization</a><ul>
<li><a class="reference internal" href="#mpi">MPI</a><ul>
<li><a class="reference internal" href="#mpi-keywords">MPI Keywords</a></li>
<li><a class="reference internal" href="#mpi-constants">MPI Constants</a></li>
<li><a class="reference internal" href="#mpi-constructor">MPI Constructor</a></li>
<li><a class="reference internal" href="#mpi-functions">MPI Functions</a></li>
<li><a class="reference internal" href="#mpi-communicator-operator">MPI Communicator operator</a></li>
<li><a class="reference internal" href="#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li><a class="reference internal" href="#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li><a class="reference internal" href="#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li><a class="reference internal" href="#sparse-direct-solver">Sparse direct solver</a><ul>
<li><a class="reference internal" href="#mumps-solver">MUMPS solver</a></li>
<li><a class="reference internal" href="#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li><a class="reference internal" href="#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li><a class="reference internal" href="#parms-solver">pARMS solver</a></li>
<li><a class="reference internal" href="#interfacing-with-hips">Interfacing with HIPS</a></li>
<li><a class="reference internal" href="#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li><a class="reference internal" href="#domain-decomposition">Domain decomposition</a><ul>
<li><a class="reference internal" href="#communicators-and-groups">Communicators and groups</a></li>
<li><a class="reference internal" href="#process">Process</a></li>
<li><a class="reference internal" href="#points-to-points-communicators">Points to Points communicators</a></li>
<li><a class="reference internal" href="#global-operations">Global operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hpddm-solvers">HPDDM solvers</a></li>
<li><a class="reference internal" href="#time-dependent-problem">Time dependent problem</a></li>
<li><a class="reference internal" href="#distributed-vectors-in-hpddm">Distributed vectors in HPDDM</a></li>
</ul>
</li>
</ul>
</li>
</ul>

	</div>
</div>
		<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation/" target="_blank">BibTeX</a>
	</div>
</footer>
		

		<script async src="../_static/js/common.js"></script>
	</body>
</html>
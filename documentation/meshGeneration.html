<!DOCTYPE html>

<html lang="en">
	<head>
		  <meta charset="UTF-8">
  <title>Mesh Generation</title>
  <link rel="icon" href="../_static/img/Symbol.png" />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700,900" rel="stylesheet">

  <!-- FreeFEM theme specific -->
  <link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

  <!-- css -->
  <link rel="stylesheet" href="../_static/css/pygments_custom.css" type="text/css" />

  <!-- MathJax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <script src="../_static/js/mathjax-config.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
   <a class="header-logo" href="../introduction/index.html">
      <img alt="logo" title="FreeFEM documentation" src="../_static/img/FreeFem_Documentation_Logo_bleu.svg" />
   </a>

   <a class="header-github" href="https://github.com/FreeFem/FreeFem-sources" target="_blank">
      <i class="fab fa-github"></i>
      <p class="header-github-title" >
         FreeFEM on GitHub
      </p>

      <p class="header-github-stars" id="headerGithubStarsForks">
         <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
      </p>
   </a>
</header>
<script async src="../_static/js/github.js"></script>
		
		<nav id="nav">
	<div style="display: none;">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/download.html">Download FreeFEM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#latest-binary-packages">Latest binary packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/download.html#syntax-highlighters">Syntax highlighters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/installation.html">Installation guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#easy-installation">Easy installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#windows-binary-installation">Windows binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#macos-x-binary-installation">MacOS X binary installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#arch-aur-package">Arch AUR package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#text-editor">Text-editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#gedit">Gedit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#compilation">Compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#branches-os-status">Branches / OS status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-osx-10-13">Compilation on OSX (&gt;=10.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-ubuntu">Compilation on Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-arch-linux">Compilation on Arch Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-linux-with-intel-software-tools">Compilation on Linux with Intel software tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/installation.html#compilation-on-windows">Compilation on Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/installation.html#environment-variables-and-init-file">Environment variables and init file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#bug-report">Bug report</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-documentation">Concerning the <strong>FreeFEM</strong> documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/contributing.html#concerning-the-freefem-compilation-or-usage">Concerning the <strong>FreeFEM</strong> compilation or usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/contributing.html#improve-content">Improve content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/citation.html">Citation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/citation.html#if-you-use-freefem-please-cite-the-following-reference-in-your-work">If you use <strong>FreeFEM</strong>, please cite the following reference in your work:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#apa">APA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#iso690">ISO690</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#mla">MLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../introduction/citation.html#bibtex">BibTeX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/authors.html">Authors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/poisson.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/equationsClassification.html">Classification of partial differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/membrane.html">Membrane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/heatExchanger.html">Heat Exchanger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/acoustics.html">Acoustics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/thermalConduction.html">Thermal Conduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/thermalConduction.html#axisymmetry-3d-rod-with-circular-section">Axisymmetry: 3D Rod with circular section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/thermalConduction.html#a-nonlinear-problem-radiation">A Nonlinear Problem : Radiation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/fanBlade.html">Irrotational Fan Blade Flow and Thermal effects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/fanBlade.html#heat-convection-around-the-airfoil">Heat Convection around the airfoil</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/rotatingHill.html">Pure Convection : The Rotating Hill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#solution-by-a-characteristics-galerkin-method">Solution by a Characteristics-Galerkin Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#solution-by-discontinuous-galerkin-fem">Solution by Discontinuous-Galerkin FEM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/rotatingHill.html#finite-volume-methods-can-also-be-handled-with-freefem-but-it-requires-programming"><strong>Finite Volume Methods</strong> can also be handled with <strong>FreeFEM</strong> but it requires programming.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/elasticity.html">The System of elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/stokes.html">The System of Stokes for Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/navierStokesProjection.html">A projection algorithm for the Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/navierStokesNewton.html">Newton Method for the Steady Navier-Stokes equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/aLargeFluidProblem.html">A Large Fluid Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/complexNumbers.html">An Example with Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/optimalControl.html">Optimal Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/flowWithShocks.html">A Flow with Shocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/heatEquationOptimization.html">Time dependent schema optimization for heat equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/timeDependentStokes.html">Tutorial to write a transient Stokes solver in matrix form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/wifiPropagation.html">Wifi Propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/wifiPropagation.html#coding">Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial/wifiPropagation.html#the-domain">The domain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial/wifiPropagation.html#lets-create-a-mesh">Let’s create a mesh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/matlabOctavePlot.html">Plotting in Matlab and Octave</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#d-problem">2D Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#exporting-data">Exporting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#importing-data">Importing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#d-plot-examples">2D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#id1">3D Plot Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/matlabOctavePlot.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notations.html#generalities">Generalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#sets-mappings-matrices-vectors">Sets, Mappings, Matrices, Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#numbers">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#differential-calculus">Differential Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#meshes">Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="notations.html#finite-element-spaces">Finite Element Spaces</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#square">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="#border">Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-border">Multi-Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-keyword-triangulate">The keyword “triangulate”</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#boundary-fem-spaces-built-as-empty-meshes">Boundary FEM Spaces Built as Empty Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remeshing">Remeshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#movemesh">Movemesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#regular-triangulation-htriangle">Regular Triangulation: hTriangle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adaptmesh">Adaptmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trunc">Trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="#splitmesh">Splitmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#meshing-examples">Meshing Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">How to change the label of elements and border elements of a mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mesh-in-three-dimensions">Mesh in three dimensions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer-mesh">Layer mesh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#meshing-examples-1">Meshing examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#medit">Medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mshmet">Mshmet</a></li>
<li class="toctree-l4"><a class="reference internal" href="#freeyams">FreeYams</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mmg3d">mmg3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-a-2d-mesh-from-a-isoline">Build a 2d mesh from a isoline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finiteElement.html">Finite element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#use-of-freefem-fespace-in-2d">Use of freefem fespace in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#use-of-fespace-in-3d">Use of fespace in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#lagrangian-finite-elements">Lagrangian Finite Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p0-element">P0-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p1-element">P1-element</a></li>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#p2-element">P2-element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#p1-nonconforming-element">P1 Nonconforming Element</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#other-fe-space">Other FE-space</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#vector-valued-fe-function">Vector Valued FE-function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#raviart-thomas-element">Raviart-Thomas Element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#a-fast-finite-element-interpolator">A Fast Finite Element Interpolator</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#keywords-problem-and-solve">Keywords: Problem and Solve</a><ul>
<li class="toctree-l4"><a class="reference internal" href="finiteElement.html#weak-form-and-boundary-condition">Weak Form and Boundary Condition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#parameters-affecting-solve-and-problem">Parameters affecting solve and problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#problem-definition">Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#numerical-integration">Numerical Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#variational-form-sparse-matrix-pde-data-vector">Variational Form, Sparse Matrix, PDE Data Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#interpolation-matrix">Interpolation matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="finiteElement.html#finite-elements-connectivity">Finite elements connectivity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-gnuplot">Link with gnuplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-medit">Link with medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-paraview">Link with Paraview</a></li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html#link-with-matlab-and-octave">Link with Matlab© and Octave</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="algorithmsOptimization.html">Algorithms &amp; Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#conjugate-gradient-gmres">Conjugate Gradient/GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#algorithms-for-unconstrained-optimization">Algorithms for Unconstrained Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#example-of-usage-for-bfgs-or-cmaes">Example of usage for BFGS or CMAES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#ipopt">IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#short-description-of-the-algorithm">Short description of the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#ipopt-in-freefem">IPOPT in <strong>FreeFEM</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#some-short-examples-using-ipopt">Some short examples using IPOPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#d-constrained-minimum-surface-with-ipopt">3D constrained minimum surface with IPOPT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#area-and-volume-expressions">Area and volume expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#derivatives">Derivatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithmsOptimization.html#the-problem-and-its-script">The problem and its script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#the-nlopt-optimizers">The nlOpt optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithmsOptimization.html#optimization-with-mpi">Optimization with MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#mpi">MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-keywords">MPI Keywords</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constants">MPI Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-constructor">MPI Constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-functions">MPI Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#mpi-communicator-operator">MPI Communicator operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#schwarz-example-in-parallel">Schwarz example in parallel</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#true-parallel-schwarz-example">True parallel Schwarz example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parallelization.html#parallel-sparse-solvers">Parallel sparse solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#using-parallel-sparse-solvers-in-freefem">Using parallel sparse solvers in <strong>FreeFEM</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#sparse-direct-solver">Sparse direct solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#mumps-solver">MUMPS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#superlu-distributed-solver">SuperLU distributed solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#pastix-solver">PaStiX solver</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#parallel-sparse-iterative-solver">Parallel sparse iterative solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#parms-solver">pARMS solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hips">Interfacing with HIPS</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#interfacing-with-hypre">Interfacing with HYPRE</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#domain-decomposition">Domain decomposition</a><ul>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#communicators-and-groups">Communicators and groups</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#process">Process</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#points-to-points-communicators">Points to Points communicators</a></li>
<li class="toctree-l5"><a class="reference internal" href="parallelization.html#global-operations">Global operations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#hpddm-solvers">HPDDM solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#time-dependent-problem">Time dependent problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallelization.html#distributed-vectors-in-hpddm">Distributed vectors in HPDDM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#gsl">gsl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#ffrandom">ffrandom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html#mmap-semaphore">mmap / semaphore</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="developers.html#file-formats">File formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#mesh-file-data-structure">Mesh file data structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#bb-file-type-to-store-solutions">bb file type to Store Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#id1">BB file type to store solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#metric-file">Metric file</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#list-of-am-fmt-amdba-meshes">List of AM_FMT, AMDBA Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#sol-and-solb-files">sol and solb files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#adding-a-new-finite-element">Adding a new finite element</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#some-notations">Some notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#which-class-to-add">Which class to add?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="developers.html#dynamical-link">Dynamical link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="developers.html#a-first-example-myfunction-cpp">A first example myfunction.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#example-discrete-fast-fourier-transform">Example: Discrete Fast Fourier Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#load-module-for-dervieux-p0-p1-finite-volume-method">Load Module for Dervieux P0-P1 Finite Volume Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="developers.html#more-on-adding-a-new-finite-element">More on Adding a new finite element</a><ul>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-bernardi-raugel-element">The Bernardi-Raugel Element</a></li>
<li class="toctree-l5"><a class="reference internal" href="developers.html#the-morley-element">The Morley Element</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ffddm/introddm.html">Domain Decomposition (DD)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#mesh-decomposition">Mesh Decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-linear-algebra">Distributed Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#partition-of-unity-matrices-poum">Partition of Unity Matrices (POUM)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#distributed-scalar-product">Distributed scalar product</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#update">Update</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-matrix-and-vector-resulting-from-a-variational-formulation">Distributed Matrix and Vector resulting from a variational formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/introddm.html#distributed-linear-solvers">Distributed Linear Solvers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#distributed-direct-solvers">Distributed Direct Solvers</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/introddm.html#schwarz-methods">Schwarz methods</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#restricted-additive-schwarz-ras">Restricted Additive Schwarz (RAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#optimized-restricted-additive-schwarz-oras">Optimized Restricted Additive Schwarz (ORAS)</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/introddm.html#two-level-methods">Two level methods</a><ul>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introddm.html#coarse-mesh">Coarse Mesh</a></li>
<li class="toctree-l7"><a class="reference internal" href="ffddm/introddm.html#geneo">GenEO</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/documentation.html">ffddm documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#minimal-example">Minimal example</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#overlapping-mesh-decomposition">Overlapping mesh decomposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#local-finite-element-spaces">Local finite element spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#define-the-problem-to-solve">Define the problem to solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#one-level-preconditioners">One level preconditioners</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#two-level-preconditioners">Two level preconditioners</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-geneo-coarse-space">Building the GenEO coarse space</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/documentation.html#building-the-coarse-space-from-a-coarse-mesh">Building the coarse space from a coarse mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#solving-the-linear-system">Solving the linear system</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/documentation.html#using-hpddm-within-ffddm">Using <em>HPDDM</em> within <em>ffddm</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/parameters.html">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#command-line-arguments">Command-line arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/parameters.html#global-parameters">Global parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/tutorial.html">Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#what-is-ffddm">What is <strong>ffddm</strong> ?</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#why-domain-decomposition-methods">Why Domain Decomposition Methods ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-1-decompose-the-mesh">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-2-define-your-finite-element">Step 2: Define your finite element</a><ul>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#distributed-vectors-and-restriction-operators">Distributed vectors and restriction operators</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#partition-of-unity">Partition of unity</a></li>
<li class="toctree-l6"><a class="reference internal" href="ffddm/tutorial.html#data-exchange-between-neighbors">Data exchange between neighbors</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-3-define-your-problem">Step 3: Define your problem</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#summary-so-far-translating-your-sequential-freefem-script">Summary so far: translating your sequential <em>FreeFEM</em> script</a><ul>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#id1">Step 1: Decompose the mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system">Solve the linear system</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#solve-the-linear-system-with-the-parallel-direct-solver-mumps">Solve the linear system with the parallel direct solver <em>MUMPS</em></a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-4-define-the-one-level-dd-preconditioner">Step 4: Define the one level DD preconditioner</a></li>
<li class="toctree-l5"><a class="reference internal" href="ffddm/tutorial.html#step-5-solve-the-linear-system-with-preconditioned-gmres">Step 5: Solve the linear system with preconditioned GMRES</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#define-a-two-level-dd-preconditioner">Define a two level DD preconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-geneo-coarse-space">Build the GenEO coarse space</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#build-the-coarse-space-from-a-coarse-mesh">Build the coarse space from a coarse mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#use-hpddm-within-ffddm">Use <strong>HPDDM</strong> within <strong>ffddm</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-heterogeneous-3d-elasticity-with-geneo">Some results: Heterogeneous 3D elasticity with GenEO</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#some-results-2-level-dd-for-maxwell-equations-scattering-from-the-cobra-cavity">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="ffddm/tutorial.html#id2">Some results: 2-level DD for Maxwell equations, scattering from the COBRA cavity</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ffddm/examples.html">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#standard-types">Standard types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#int">int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#bool">bool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#real">real</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#complex">complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#string">string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#mesh-design">Mesh design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#border">border</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#mesh">mesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#mesh3">mesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#finite-element-space-design">Finite element space design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#fespace">fespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#macro-design">Macro design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#macro">macro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#ifmacro">IFMACRO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#functions-design">Functions design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#func">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#elementary-functions">Elementary functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#random-functions">Random functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#fe-functions">FE-functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#problem-design">Problem design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#problem">problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#solve">solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#varf">varf</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#array">Array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-index">Array index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-size">Array size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-sort">Array sort</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#double-array">Double array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#array-of-fe-functions">Array of FE functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#map-arrays">Map arrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/types.html#matrix">matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-size">Matrix size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-resize">Matrix resize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-diagonal">Matrix diagonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-renumbering">Matrix renumbering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#complex-matrix">Complex matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#dot-product-outer-product">Dot product / Outer product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/types.html#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/globalVariables.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#area">area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#argv">ARGV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#boundaryedge">BoundaryEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#cg">CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#cholesky">Cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#crout">Crout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#edgeorientation">edgeOrientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#false">false</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#gmres">GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#htriangle">hTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#include">include</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#internaledge">InternalEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#label">label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#lenedge">lenEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#load">load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#lu">LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#n">N</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#ntonedge">nTonEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#nuedge">nuEdge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#nutriangle">nuTriangle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#p">P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#pi">pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#region">region</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#sparsesolver">sparsesolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#true">true</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#verbosity">verbosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#version">version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#volume">volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#x">x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#y">y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/globalVariables.html#z">z</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/quadratureFormulae.html">Quadrature formulae</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int1d">int1d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#notations">Notations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pe">qf1pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pe">qf2pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf3pe">qf3pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf4pe">qf4pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf5pe">qf5pE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pelump">qf1pElump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int2d">int2d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1pt">qf1pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pt">qf2pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf5pt">qf5pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf1ptlump">qf1pTlump</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf2pt4p1">qf2pT4P1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf7pt">qf7pT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qf9pt">qf9pT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/quadratureFormulae.html#int3d">int3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv1">qfV1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv2">qfV2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv5">qfV5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/quadratureFormulae.html#qfv1lump">qfV1lump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#addition-operator">Addition operator +</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#substraction-operator">Substraction operator -</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#multiplication-operator">Multiplication operator *</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#term-by-term-multiplication">Term by term multiplication .*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#division-operator">Division operator /</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#term-by-term-division">Term by term division ./</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#remainder-from-the-division">Remainder from the division %</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#power-operator">Power operator ^</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#inverse-of-a-matrix-1">Inverse of a matrix ^-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#transpose-operator">Transpose operator ‘</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#tensor-scalar-product">Tensor scalar product :</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/operators.html#c-arithmetical-if-expression">C++ arithmetical if expression ? :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/loops.html">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#for">for</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#if">if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#else">else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#while">while</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#continue">continue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#break">break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#try">try</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#catch">catch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/loops.html#implicit-loop">Implicit loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/IO.html">I/O</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#cout">cout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#cin">cin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#endl">endl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#ifstream">ifstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#ofstream">ofstream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#append">append</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#binary">binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#seekg">seekg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#tellg">tellg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#flush">flush</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#getline">getline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/IO.html#output-format">Output format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#precision">precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#scientific">scientific</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#fixed">fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#showbase">showbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#noshowbase">noshowbase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#showpos">showpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#noshowpos">noshowpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#default">default</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/IO.html#setw">setw</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#abs">abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#acos">acos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#acosh">acosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#adaptmesh">adaptmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#adj">adj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#affinecg">AffineCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#affinegmres">AffineGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#arg">arg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#asin">asin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#asinh">asinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#assert">assert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atan">atan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atan2">atan2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atanh">atanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atoi">atoi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#atof">atof</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#bfgs">BFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#buildmesh">buildmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#ceil">ceil</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#chi">chi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#checkmovemesh">checkmovemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#clock">clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#complexeigenvalue">complexEigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#conj">conj</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#convect">convect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#copysign">copysign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#cos">cos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#cosh">cosh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#diffnp">diffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#diffpos">diffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dist">dist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dumptable">dumptable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dx">dx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxx">dxx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxy">dxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dxz">dxz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dy">dy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyx">dyx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyy">dyy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dyz">dyz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dz">dz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzx">dzx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzy">dzy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#dzz">dzz</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#eigenvalue">EigenValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#emptymesh">emptymesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#erf">erf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#erfc">erfc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exec">exec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exit">exit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#exp">exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fdim">fdim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#floor">floor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmax">fmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmin">fmin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#fmod">fmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#imag">imag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int1d">int1d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int2d">int2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#int3d">int3d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#intalledges">intalledges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#intallfaces">intallfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiff">invdiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiffnp">invdiffnp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#invdiffpos">invdiffpos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#isinf">isInf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#isnan">isNaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#j0">j0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#j1">j1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#jn">jn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#jump">jump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#linearcg">LinearCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lineargmres">LinearGMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lgamma">lgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#log">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#log10">log10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lrint">lrint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#lround">lround</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#max">max</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#min">min</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#movemesh">movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#nan">NaN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#nlcg">NLCG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#on">on</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#plot">plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#polar">polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#pow">pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#projection">projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randinit">randinit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randint31">randint31</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randint32">randint32</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal1">randreal1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal2">randreal2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randreal3">randreal3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#randres53">randres53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#readmesh">readmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#readmesh3">readmesh3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#real">real</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#rint">rint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#round">round</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#savemesh">savemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#set">set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sign">sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#signbit">signbit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sin">sin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sinh">sinh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sort">sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#splitmesh">splitmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#sqrt">sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#square">square</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#swap">swap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#system">system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tan">tan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tanh">tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#tgamma">tgamma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#trunc">trunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#y0">y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#y1">y1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html#yn">yn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/externalLibraries.html">External libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#aniso">aniso</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#boundaniso">boundaniso</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#bec">BEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bectrap">BECtrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gpvortex">GPvortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxgpvortex">dxGPVortex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dygpvortex">dyGPVortex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#binary-i-o">Binary I/O</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#loadvec">LoadVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#loadflag">LoadFlag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savevec">SaveVec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#flag">flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#buildlayer">buildlayer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#buildlayers">buildlayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#closepoints">ClosePoints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#radiussearch">radiusSearch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#voisinage">Voisinage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#neighborhood">neighborhood</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoints2">ClosePoints2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoint">ClosePoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#closepoints1">ClosePoints1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#curvature">Curvature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#extractborder">extractborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id1">curvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#raxicurvature">raxicurvature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#curves">curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#setecurveabcisse">setecurveabcisse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#equiparameter">equiparameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tresca">Tresca</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vonmises">VonMises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#dfft">dfft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#plandfft">plandfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#execute">execute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#delete">delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id2">dfft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#map">map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#distance">distance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id3">distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#checkdist">checkdist</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#dxwriter">DxWriter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddmesh">Dxaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddtimeseries">Dxaddtimeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dxaddsol2ts">Dxaddsol2ts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#element-p1bl">Element_P1bl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#expert">expert</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#exactpartition">exactpartition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id4">exactpartition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-airybiry">ff-AiryBiry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#airy">airy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#biry">biry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-cmaes">ff-cmaes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cmaes">cmaes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-gsl-awk">ff_gsl_awk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianp">gslcdfugaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianq">gslcdfugaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianpinv">gslcdfugaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfugaussianqinv">gslcdfugaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianp">gslcdfgaussianP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianq">gslcdfgaussianQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianpinv">gslcdfgaussianPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgaussianqinv">gslcdfgaussianQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammap">gslcdfgammaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammaq">gslcdfgammaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammapinv">gslcdfgammaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgammaqinv">gslcdfgammaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyp">gslcdfcauchyP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyq">gslcdfcauchyQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchypinv">gslcdfcauchyPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfcauchyqinv">gslcdfcauchyQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplacep">gslcdflaplaceP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplaceq">gslcdflaplaceQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplacepinv">gslcdflaplacePinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflaplaceqinv">gslcdflaplaceQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighp">gslcdfrayleighP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighq">gslcdfrayleighQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighpinv">gslcdfrayleighPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfrayleighqinv">gslcdfrayleighQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqp">gslcdfchisqP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqq">gslcdfchisqQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqpinv">gslcdfchisqPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfchisqqinv">gslcdfchisqQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialp">gslcdfexponentialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialq">gslcdfexponentialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialpinv">gslcdfexponentialPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexponentialqinv">gslcdfexponentialQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexppowp">gslcdfexppowP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfexppowq">gslcdfexppowQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistp">gslcdftdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistq">gslcdftdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistpinv">gslcdftdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdftdistqinv">gslcdftdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistp">gslcdffdistP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistq">gslcdffdistQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistpinv">gslcdffdistPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdffdistqinv">gslcdffdistQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetap">gslcdfbetaP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetaq">gslcdfbetaQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetapinv">gslcdfbetaPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbetaqinv">gslcdfbetaQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatp">gslcdfflatP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatq">gslcdfflatQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatpinv">gslcdfflatPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfflatqinv">gslcdfflatQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalp">gslcdflognormalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalq">gslcdflognormalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalpinv">gslcdflognormalPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflognormalqinv">gslcdflognormalQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1p">gslcdfgumbel1P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1q">gslcdfgumbel1Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1pinv">gslcdfgumbel1Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel1qinv">gslcdfgumbel1Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2p">gslcdfgumbel2P</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2q">gslcdfgumbel2Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2pinv">gslcdfgumbel2Pinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgumbel2qinv">gslcdfgumbel2Qinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullp">gslcdfweibullP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullq">gslcdfweibullQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullpinv">gslcdfweibullPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfweibullqinv">gslcdfweibullQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetop">gslcdfparetoP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetoq">gslcdfparetoQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetopinv">gslcdfparetoPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfparetoqinv">gslcdfparetoQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticp">gslcdflogisticP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticq">gslcdflogisticQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticpinv">gslcdflogisticPinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdflogisticqinv">gslcdflogisticQinv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbinomialp">gslcdfbinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfbinomialq">gslcdfbinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpoissonp">gslcdfpoissonP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpoissonq">gslcdfpoissonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgeometricp">gslcdfgeometricP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfgeometricq">gslcdfgeometricQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfnegativebinomialp">gslcdfnegativebinomialP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfnegativebinomialq">gslcdfnegativebinomialQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpascalp">gslcdfpascalP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslcdfpascalq">gslcdfpascalQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbernoullipdf">gslranbernoullipdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbeta">gslranbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbetapdf">gslranbetapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranbinomialpdf">gslranbinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexponential">gslranexponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexponentialpdf">gslranexponentialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexppow">gslranexppow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranexppowpdf">gslranexppowpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrancauchy">gslrancauchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrancauchypdf">gslrancauchypdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranchisq">gslranchisq</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranchisqpdf">gslranchisqpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranerlang">gslranerlang</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranerlangpdf">gslranerlangpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranfdist">gslranfdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranfdistpdf">gslranfdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranflat">gslranflat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranflatpdf">gslranflatpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangamma">gslrangamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammaint">gslrangammaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammapdf">gslrangammapdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammamt">gslrangammamt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangammaknuth">gslrangammaknuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussian">gslrangaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianratiomethod">gslrangaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianziggurat">gslrangaussianziggurat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussianpdf">gslrangaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussian">gslranugaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussianratiomethod">gslranugaussianratiomethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussianpdf">gslranugaussianpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussiantail">gslrangaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangaussiantailpdf">gslrangaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussiantail">gslranugaussiantail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranugaussiantailpdf">gslranugaussiantailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlandau">gslranlandau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlandaupdf">gslranlandaupdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangeometricpdf">gslrangeometricpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel1">gslrangumbel1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel1pdf">gslrangumbel1pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel2">gslrangumbel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrangumbel2pdf">gslrangumbel2pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogistic">gslranlogistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogisticpdf">gslranlogisticpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlognormal">gslranlognormal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlognormalpdf">gslranlognormalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlogarithmicpdf">gslranlogarithmicpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrannegativebinomialpdf">gslrannegativebinomialpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpascalpdf">gslranpascalpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpareto">gslranpareto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranparetopdf">gslranparetopdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranpoissonpdf">gslranpoissonpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleigh">gslranrayleigh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleighpdf">gslranrayleighpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleightail">gslranrayleightail</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranrayleightailpdf">gslranrayleightailpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrantdist">gslrantdist</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrantdistpdf">gslrantdistpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlaplace">gslranlaplace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlaplacepdf">gslranlaplacepdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranlevy">gslranlevy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranweibull">gslranweibull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslranweibullpdf">gslranweibullpdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyai">gslsfairyAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybi">gslsfairyBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaiscaled">gslsfairyAiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybiscaled">gslsfairyBiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaideriv">gslsfairyAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybideriv">gslsfairyBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyaiderivscaled">gslsfairyAiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairybiderivscaled">gslsfairyBiderivscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzeroai">gslsfairyzeroAi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzerobi">gslsfairyzeroBi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzeroaideriv">gslsfairyzeroAideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfairyzerobideriv">gslsfairyzeroBideriv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj0">gslsfbesselJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj1">gslsfbesselJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljn">gslsfbesselJn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely0">gslsfbesselY0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely1">gslsfbesselY1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselyn">gslsfbesselYn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli0">gslsfbesselI0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli1">gslsfbesselI1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselin">gslsfbesselIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli0scaled">gslsfbesselI0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli1scaled">gslsfbesselI1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinscaled">gslsfbesselInscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk0">gslsfbesselK0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk1">gslsfbesselK1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselkn">gslsfbesselKn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk0scaled">gslsfbesselK0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk1scaled">gslsfbesselK1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknscaled">gslsfbesselKnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id5">gslsfbesselj0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id6">gslsfbesselj1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselj2">gslsfbesselj2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljl">gslsfbesseljl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id7">gslsfbessely0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id8">gslsfbessely1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessely2">gslsfbessely2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselyl">gslsfbesselyl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id9">gslsfbesseli0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id10">gslsfbesseli1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseli2scaled">gslsfbesseli2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselilscaled">gslsfbesselilscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id11">gslsfbesselk0scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id12">gslsfbesselk1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselk2scaled">gslsfbesselk2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselklscaled">gslsfbesselklscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesseljnu">gslsfbesselJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselynu">gslsfbesselYnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinuscaled">gslsfbesselInuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselinu">gslsfbesselInu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknuscaled">gslsfbesselKnuscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselknu">gslsfbesselKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbessellnknu">gslsfbessellnKnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzeroj0">gslsfbesselzeroJ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzeroj1">gslsfbesselzeroJ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbesselzerojnu">gslsfbesselzeroJnu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfclausen">gslsfclausen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhydrogenicr1">gslsfhydrogenicR1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdawson">gslsfdawson</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye1">gslsfdebye1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye2">gslsfdebye2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye3">gslsfdebye3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye4">gslsfdebye4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye5">gslsfdebye5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdebye6">gslsfdebye6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdilog">gslsfdilog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfmultiply">gslsfmultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintkcomp">gslsfellintKcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintecomp">gslsfellintEcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintpcomp">gslsfellintPcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintdcomp">gslsfellintDcomp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintf">gslsfellintF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellinte">gslsfellintE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfellintrc">gslsfellintRC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfc">gslsferfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflogerfc">gslsflogerfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferf">gslsferf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfz">gslsferfZ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsferfq">gslsferfQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhazard">gslsfhazard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexp">gslsfexp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpmult">gslsfexpmult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpm1">gslsfexpm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexprel">gslsfexprel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexprel2">gslsfexprel2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpreln">gslsfexpreln</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte1">gslsfexpintE1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte2">gslsfexpintE2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinten">gslsfexpintEn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte1scaled">gslsfexpintE1scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinte2scaled">gslsfexpintE2scaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpintenscaled">gslsfexpintEnscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpintei">gslsfexpintEi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpinteiscaled">gslsfexpintEiscaled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfshi">gslsfShi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfchi">gslsfChi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfexpint3">gslsfexpint3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsi">gslsfSi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfci">gslsfCi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfatanint">gslsfatanint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracm1">gslsffermidiracm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac0">gslsffermidirac0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac1">gslsffermidirac1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac2">gslsffermidirac2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracint">gslsffermidiracint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracmhalf">gslsffermidiracmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirachalf">gslsffermidirachalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidirac3half">gslsffermidirac3half</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffermidiracinc0">gslsffermidiracinc0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflngamma">gslsflngamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgamma">gslsfgamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammastar">gslsfgammastar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammainv">gslsfgammainv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftaylorcoeff">gslsftaylorcoeff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsffact">gslsffact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfdoublefact">gslsfdoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnfact">gslsflnfact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflndoublefact">gslsflndoublefact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnchoose">gslsflnchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfchoose">gslsfchoose</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnpoch">gslsflnpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpoch">gslsfpoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpochrel">gslsfpochrel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammaincq">gslsfgammaincQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammaincp">gslsfgammaincP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgammainc">gslsfgammainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnbeta">gslsflnbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbeta">gslsfbeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfbetainc">gslsfbetainc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly1">gslsfgegenpoly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly2">gslsfgegenpoly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpoly3">gslsfgegenpoly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfgegenpolyn">gslsfgegenpolyn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg0f1">gslsfhyperg0F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg1f1int">gslsfhyperg1F1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg1f1">gslsfhyperg1F1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperguint">gslsfhypergUint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhypergu">gslsfhypergU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhyperg2f0">gslsfhyperg2F0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre1">gslsflaguerre1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre2">gslsflaguerre2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerre3">gslsflaguerre3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflaguerren">gslsflaguerren</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflambertw0">gslsflambertW0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflambertwm1">gslsflambertWm1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrepl">gslsflegendrePl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep1">gslsflegendreP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep2">gslsflegendreP2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrep3">gslsflegendreP3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreq0">gslsflegendreQ0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreq1">gslsflegendreQ1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreql">gslsflegendreQl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreplm">gslsflegendrePlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendresphplm">gslsflegendresphPlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendrearraysize">gslsflegendrearraysize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalphalf">gslsfconicalPhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpmhalf">gslsfconicalPmhalf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalp0">gslsfconicalP0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalp1">gslsfconicalP1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpsphreg">gslsfconicalPsphreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfconicalpcylreg">gslsfconicalPcylreg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d0">gslsflegendreH3d0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d1">gslsflegendreH3d1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflegendreh3d">gslsflegendreH3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog">gslsflog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflogabs">gslsflogabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog1plusx">gslsflog1plusx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflog1plusxmx">gslsflog1plusxmx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpowint">gslsfpowint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsiint">gslsfpsiint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi">gslsfpsi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1piy">gslsfpsi1piy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1int">gslsfpsi1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsi1">gslsfpsi1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfpsin">gslsfpsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsynchrotron1">gslsfsynchrotron1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsynchrotron2">gslsfsynchrotron2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport2">gslsftransport2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport3">gslsftransport3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport4">gslsftransport4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsftransport5">gslsftransport5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsin">gslsfsin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfcos">gslsfcos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhypot">gslsfhypot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfsinc">gslsfsinc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflnsinh">gslsflnsinh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsflncosh">gslsflncosh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfanglerestrictsymm">gslsfanglerestrictsymm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfanglerestrictpos">gslsfanglerestrictpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetaint">gslsfzetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzeta">gslsfzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetam1">gslsfzetam1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfzetam1int">gslsfzetam1int</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfhzeta">gslsfhzeta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfetaint">gslsfetaint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslsfeta">gslsfeta</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-ipopt">ff-Ipopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ipopt">IPOPT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#fflapack">fflapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#inv">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgeev">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zgeev">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#geev">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id13">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dggev">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zggev">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dsygvd">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgesdd">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zhegv">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dsyev">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#zheev">zheev</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-mmap-semaphore">ff-mmap-semaphore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#wait">Wait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#trywait">trywait</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#post">Post</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#msync">msync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#read">Read</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#write">Write</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ffnewuoa">ffnewuoa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#newuoa">newuoa</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ff-nlopt">ff-NLopt</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirect">nloptDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectl">nloptDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlrand">nloptDIRECTLRand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectscal">nloptDIRECTScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectnoscal">nloptDIRECTNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlnoscal">nloptDIRECTLNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptdirectlrandnoscal">nloptDIRECTLRandNoScal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptorigdirect">nloptOrigDIRECT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptorigdirectl">nloptOrigDIRECTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptstogo">nloptStoGO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptstogorand">nloptStoGORand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptlbfgs">nloptLBFGS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptpraxis">nloptPRAXIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptvar1">nloptVar1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptvar2">nloptVar2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewton">nloptTNewton</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonrestart">nloptTNewtonRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonprecond">nloptTNewtonPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nlopttnewtonprecondrestart">nloptTNewtonPrecondRestart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptcrs2">nloptCRS2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmma">nloptMMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptcobyla">nloptCOBYLA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptnewuoa">nloptNEWUOA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptnewuoabound">nloptNEWUOABound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptneldermead">nloptNelderMead</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptsbplx">nloptSbplx</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptbobyqa">nloptBOBYQA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptisres">nloptISRES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptslsqp">nloptSLSQP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmlsl">nloptMLSL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptmlsllds">nloptMLSLLDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptauglag">nloptAUGLAG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#nloptauglageq">nloptAUGLAGEQ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ffrandom">ffrandom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#srandomdev">srandomdev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#srandom">srandom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#random">random</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#freefemqa">FreeFemQA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#meshgenqa">MeshGenQA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#freeyams">freeyams</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id14">freeyams</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#gmsh">gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gmshload">gmshload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gmshload3">gmshload3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savegmsh">savegmsh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#gsl">gsl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolysolvequadratic">gslpolysolvequadratic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolysolvecubic">gslpolysolvecubic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslpolycomplexsolve">gslpolycomplexsolve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrnguniform">gslrnguniform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrnguniformpos">gslrnguniformpos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslname">gslname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngget">gslrngget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngmin">gslrngmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngmax">gslrngmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngset">gslrngset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gslrngtype">gslrngtype</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#ilut">ilut</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#applyilutprecond">applyIlutPrecond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#makeilutprecond">makeIlutPrecond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#iohdf5">iohdf5</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savehdf5sol">savehdf5sol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#iovtk">iovtk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savevtk">savevtk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkload">vtkload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkload3">vtkload3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#isoline">isoline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id15">isoline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#curve">Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#area">Area</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#findallocalmin">findallocalmin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#lapack">lapack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id16">inv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id17">dgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id18">zgeev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id19">geev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id20">dggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id21">zggev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id22">dsygvd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id23">dgesdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id24">zhegv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id25">dsyev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id26">zheev</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dgelsy">dgelsy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#lgbmo">lgbmo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bmo">bmo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mat-dervieux">mat_dervieux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#matupwind1">MatUpWind1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mat-psi">mat_psi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#matupwind0">MatUpWind0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#medit">medit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id27">medit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#savesol">savesol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readsol">readsol</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metis">metis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#metisnodal">metisnodal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#metisdual">metisdual</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metrickuate">MetricKuate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id28">MetricKuate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#metricpk">MetricPk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id29">MetricPk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mmg3d">mmg3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id30">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mmg3d-v4-0">mmg3d-v4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id31">mmg3d</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#msh3">msh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#change">change</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh23">movemesh23</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh2d3dsurf">movemesh2D3Dsurf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh3">movemesh3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh">movemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#movemesh3d">movemesh3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#deplacement">deplacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#checkbemesh">checkbemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id32">buildlayers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#bcube">bcube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cube">cube</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#trunc">trunc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#gluemesh">gluemesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#extract">extract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#showborder">showborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#getborder">getborder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#addlayers">AddLayers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mshmet">mshmet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id33">mshmet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mumps">MUMPS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttomumpsseq">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#mumps-seq">MUMPS_seq</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id34">defaulttoMUMPSseq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#netgen">netgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netg">netg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netgstl">netgstl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#netgload">netgload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#newsolver">NewSolver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttoumfpack">defaulttoUMFPACK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pardiso">PARDISO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttopardiso">defaulttoPARDISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompsetnumthreads">ompsetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompgetnumthreads">ompgetnumthreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#ompgetmaxthreads">ompgetmaxthreads</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pcm2rnm">pcm2rnm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readpcm">readpcm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#pipe">pipe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#flush">flush</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#usleep">usleep</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#qf11to25">qf11to25</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf1d">QF1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf2d">QF2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#qf3d">QF3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tripleqf">tripleQF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#scotch">scotch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id35">scotch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#shell">shell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#readdir">readdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#unlink">unlink</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#rmdir">rmdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cddir">cddir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#chdir">chdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#basename">basename</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#dirname">dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#mkdir">mkdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#chmod">chmod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#cpfile">cpfile</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#stat">stat</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#isdir">isdir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#getenv">getenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#setenv">setenv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#unsetenv">unsetenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitedges">splitedges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#splitedgemesh">SplitedgeMesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh12">splitmesh12</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id36">splitmesh12</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh3">splitmesh3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id37">splitmesh3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh4">splitmesh4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#splimesh4">splimesh4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#splitmesh6">splitmesh6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id38">splitmesh6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#superlu">SuperLu</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttosuperlu">defaulttoSuperLu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#symmetrizecsr">symmetrizeCSR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id39">symmetrizeCSR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#tetgen">tetgen</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgconvexhull">tetgconvexhull</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgtransfo">tetgtransfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetg">tetg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#tetgreconstruction">tetgreconstruction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#umfpack64">UMFPACK64</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#defaulttoumfpack64">defaulttoUMFPACK64</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#vtk-writer-3d">VTK_writer_3d</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkaddmesh">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#vtkaddscalar">Vtkaddscalar</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/externalLibraries.html#vtk-writer">VTK_writer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id40">Vtkaddmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/externalLibraries.html#id41">Vtkaddscalar</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../model/staticProblems.html">Static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#soap-film">Soap Film</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#electrostatics">Electrostatics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#aerodynamics">Aerodynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#error-estimation">Error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#periodic-boundary-conditions">Periodic Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#poisson-problems-with-mixed-boundary-condition">Poisson Problems with mixed boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#poisson-with-mixed-finite-element">Poisson with mixed finite element</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#metric-adaptation-and-residual-error-indicator">Metric Adaptation and residual error indicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/staticProblems.html#adaptation-using-residual-error-indicator">Adaptation using residual error indicator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/elasticity.html">Elasticity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/elasticity.html#fracture-mechanics">Fracture Mechanics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearStaticProblems.html">Non-linear static problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/nonLinearStaticProblems.html#newton-raphson-algorithm">Newton-Raphson algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/eigenValueProblems.html">Eigen value problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/evolutionProblems.html">Evolution problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#mathematical-theory-on-time-difference-approximations">Mathematical Theory on Time Difference Approximations.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#convection">Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/evolutionProblems.html#d-black-scholes-equation-for-an-european-put-option">2D Black-Scholes equation for an European Put option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/navierStokesEquations.html">Navier-Stokes equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/navierStokesEquations.html#uzawa-algorithm-and-conjugate-gradients">Uzawa Algorithm and Conjugate Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/navierStokesEquations.html#nsuzawacahouetchabart-edp">NSUzawaCahouetChabart.edp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/variationalInequality.html">Variational Inequality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/domainDecomposition.html">Domain decomposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-overlapping">Schwarz overlapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-non-overlapping-scheme">Schwarz non overlapping Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/domainDecomposition.html#schwarz-conjuguate-gradient">Schwarz conjuguate gradient</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/fluidStructureCoupledProblem.html">Fluid-structure coupled problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/transmissionProblem.html">Transmission problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/freeBoundaryProblem.html">Free boundary problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/nonLinearElasticity.html">Non-linear elasticity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html">Compressible Neo-Hookean materials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#recommended-references">Recommended References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#a-neo-hookean-compressible-material">A Neo-Hookean Compressible Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/compressibleNeoHookeanMaterials.html#an-approach-to-implementation-in-freefem">An Approach to Implementation in FreeFEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../model/whisperingGalleryModes.html">Whispering gallery modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#wave-equation-for-the-wgms">Wave equation for the WGMs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#weak-formulation">Weak formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../model/whisperingGalleryModes.html#a-dielectric-sphere-example-with-freefem">A dielectric sphere example with FreeFEM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../example/misc.html">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation">Poisson’s Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#poisson-s-equation-3d">Poisson’s equation 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#stokes-equation-on-a-cube">Stokes Equation on a cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/misc.html#cavity">Cavity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/meshGeneration.html">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#square-mesh">Square mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation">Mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#mesh-adaptation-for-the-poisson-s-problem">Mesh adaptation for the Poisson’s problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#uniform-mesh-adaptation">Uniform mesh adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#borders">Borders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#change">Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#empty-mesh">Empty mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#points">3 points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#bezier">Bezier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#build-layer-mesh">Build layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/meshGeneration.html#sphere">Sphere</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/finiteElement.html">Finite Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#periodic-3d">Periodic 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/finiteElement.html#lagrange-multipliers">Lagrange multipliers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/visualization.html">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#plot">Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#hsv">HSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#medit">Medit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/visualization.html#paraview">Paraview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/algoOptimizations.html">Algorithms &amp; Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-variational-inequality">CMAES variational inequality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#ipopt-minimal-surface-volume">IPOPT minimal surface &amp; volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/algoOptimizations.html#cmaes-mpi-variational-inequality">CMAES MPI variational inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/parallelization.html">Parallelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-2d">MPI-GMRES 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#mpi-gmres-3d">MPI-GMRES 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#direct-solvers">Direct solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-mumps">Solver MUMPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-superlu-dist">Solver superLU_DIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/parallelization.html#solver-pastix">Solver PaStiX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../example/developers.html">Developers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fft">FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#complex">Complex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#elementary-function">Elementary function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#array">Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#block-matrix">Block matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-operations">Matrix operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#matrix-inversion">Matrix inversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#fe-array">FE array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#loop">Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#implicit-loop">Implicit loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#i-o">I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#file-stream">File stream</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#command-line-arguments">Command line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#macro">Macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#basic-error-handling">Basic error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../example/developers.html#error-handling">Error handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
</ul>

	</div>

	<div class="nav-links" id="staticNav">
	</div>

	<button class="nav-btn" onclick="openNav()"><i class="fa fa-bars"></i></button>

	<div id="sideNav" class="sidenav">
		<div class="sideNavHeader">
			<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   id="Calque_1"
   data-name="Calque 1"
   viewBox="0 0 380.98 113.39"
   version="1.1"
   sodipodi:docname="Logo.svg"
   inkscape:version="0.92.4 5da689c313, 2019-01-14">
  <metadata
     id="metadata30">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1016"
     id="namedview28"
     showgrid="false"
     inkscape:zoom="1.1312929"
     inkscape:cx="194.02578"
     inkscape:cy="53.159222"
     inkscape:window-x="0"
     inkscape:window-y="27"
     inkscape:window-maximized="1"
     inkscape:current-layer="Calque_1" />
  <defs
     id="defs4">
    <style
       id="style2">.cls-1{fill:blue;}.cls-2{fill:#00007f;}</style>
  </defs>
  <title
     id="title6">Logo</title>
  <path
     class="cls-2"
     d="M397.36,291H381.81v14.22h-11V267.42h27.75v8.44H381.74v6.67H397.3V291Z"
     transform="translate(-230.46 -229.51)"
     id="path13" />
  <path
     class="cls-2"
     d="M417.29,292.68H413v12.51H402V267.42h16.7c4.89,0,8.76,1,11.49,3a9.55,9.55,0,0,1,4.13,8.32,12.59,12.59,0,0,1-1.59,6.73,11.85,11.85,0,0,1-5.33,4.38l8.19,15v.44H423.77ZM413,284.24h5.71c3.18,0,4.76-1.4,4.76-4.25s-1.71-4.13-5.08-4.13H413Z"
     transform="translate(-230.46 -229.51)"
     id="path15" />
  <path
     class="cls-2"
     d="M465.8,289.89H450.94v6.86h17.59v8.44H440V267.42h28.76v8.44H450.94v5.59H465.8Z"
     transform="translate(-230.46 -229.51)"
     id="path17" />
  <path
     class="cls-2"
     d="M497.6,289.89H482.75v6.86h17.58v8.44H471.77V267.42h28.75v8.44H482.75v5.59H497.6Z"
     transform="translate(-230.46 -229.51)"
     id="path19" />
  <path
     class="cls-2"
     d="M530.11,291H514.55v14.22h-11V267.42h27.75v8.44H514.49v6.67h15.56V291Z"
     transform="translate(-230.46 -229.51)"
     id="path21" />
  <path
     class="cls-2"
     d="M560.58,289.89H545.73v6.86h17.58v8.44H534.74V267.42H563.5v8.44H545.73v5.59h14.85Z"
     transform="translate(-230.46 -229.51)"
     id="path23" />
  <path
     class="cls-2"
     d="M581.09,267.42,589,291.54l7.87-24.12h14.6v37.77h-11v-5.84l1.08-20.19-9,26h-7l-9-26,1.14,20.19v5.84h-11V267.42Z"
     transform="translate(-230.46 -229.51)"
     id="path25" />
  <g
     id="g833"
     transform="matrix(0.69996616,0,0,0.69996616,24.36493,-106.39712)">
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="49.328617"
       height="86.368324"
       width="21.264048"
       id="rect1411"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="181.58182"
       x="64.966545"
       height="21.592081"
       width="53.160122"
       id="rect1413"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="218.71571"
       x="72.469795"
       height="16.194061"
       width="21.264048"
       id="rect1415"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="95.834"
       height="86.368324"
       width="21.264048"
       id="rect1411-6"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="205.23866"
       x="111.47193"
       height="21.592081"
       width="53.160122"
       id="rect1413-7"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
    <rect
       transform="matrix(1,0,-0.17364818,0.98480775,0,0)"
       rx="3.1896071"
       y="242.37254"
       x="118.97518"
       height="16.194061"
       width="21.264048"
       id="rect1415-5"
       style="fill:#0000ff;fill-opacity:1;stroke:none;stroke-width:0.8504014;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
  </g>
</svg>
			<a class="closebtn" href="#" onclick="closeNav()"><i class="fas fa-times"></i></a>
		</div>
		<div id="dynamicSideNav">
		</div>
	</div>
	<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr/lunr_index.js"></script>

<div class="search-container">
	<label for="searchInput"><i class="fas fa-search"></i></label>
	<input type="search" placeholder="Search ..." id="searchInput">
	<div id="searchResults"></div>
</div>

<script src="../_static/js/search.js"></script>
<script>
   initSearch('../')
</script>
	
</nav>
<script async src="../_static/js/nav.js"></script>
		

		<div id="subnav">
	<div style="display: none">
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="notations.html">Notations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mesh Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#square">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="#border">Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-border">Multi-Border</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-keyword-triangulate">The keyword “triangulate”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#movemesh">Movemesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cube">Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer-mesh">Layer mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="finiteElement.html">Finite element</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithmsOptimization.html">Algorithms &amp; Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ffddm/index.html">ffddm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Language references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model/index.html">Mathematical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
</ul>

	</div>
</div>
<script async src="../_static/js/subnav.js"></script>
		
		<div id="content">
			
   <div class="section" id="mesh-generation">
<span id="meshgeneration"></span><h1>Mesh Generation<a class="headerlink" href="#mesh-generation" title="Permalink to this headline"> </a></h1>
<p>Let us begin with the two important keywords: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code>.</p>
<div class="section" id="square">
<span id="meshsquare"></span><h2>Square<a class="headerlink" href="#square" title="Permalink to this headline"> </a></h2>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span></code> triangulates the unit square.</p>
<p>The following generates a <span class="math notranslate nohighlight">\(4&nbsp;\times 5\)</span> grid in the unit square <span class="math notranslate nohighlight">\([0,1]^2\)</span>. The labels of the boundaries are shown in <a class="reference internal" href="#figboundarylabels"><span class="std std-numref">Fig. 57</span></a>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="figboundarylabels">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Square.png"><img alt="../_images/MeshGeneration_Square.png" src="../_images/MeshGeneration_Square.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 57 </span><span class="caption-text">Boundary labels of the mesh by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span></code></span></p>
</div>
<p>To construct a <span class="math notranslate nohighlight">\(n\times m\)</span> grid in the rectangle <span class="math notranslate nohighlight">\([x_0,x_1]\times [y_0,y_1]\)</span>, proceed as follows:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">x0</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">x1</span> <span class="o">=</span> <span class="mf">1.8</span><span class="p">;</span>
<span class="kt">real</span> <span class="nf">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">real</span> <span class="nf">y1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span> <span class="kr">m</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kr">m</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Adding the named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flags</span><span class="o">=</span><span class="n">icase</span></code> with icase:</p>
<ol class="arabic simple" start="0">
<li>will produce a mesh where all quads are split with diagonal <span class="math notranslate nohighlight">\(x-y=constant\)</span></li>
<li>will produce <em>Union Jack flag</em> type of mesh</li>
<li>will produce a mesh where all quads are split with diagonal <span class="math notranslate nohighlight">\(x+y=constant\)</span></li>
<li>same as in case 0, except two corners where the triangles are the same as case 2 to avoid having 3 vertices on the boundary</li>
<li>same as in case 2, except two corners where the triangles are the same as case 0 to avoid having 3 vertices on the boundary</li>
</ol>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kr">m</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">],</span> <span class="kp">flags</span><span class="o">=</span><span class="n">icase</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Adding the named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span><span class="n">labs</span></code> will
change the 4 default label numbers to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">labs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code>, for
example <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">labs</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span></code>, and adding the
named parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span><span class="mi">10</span></code> will change the region number
to <span class="math notranslate nohighlight">\(10\)</span>, for instance (v 3.8).</p>
<p>To see all of these flags at work, check <a class="reference internal" href="../example/meshGeneration.html#examplemeshsquare"><span class="std std-ref">Square mesh example</span></a>:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
   <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">labs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">];</span>
   <span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kp">flags</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">labs</span><span class="p">,</span> <span class="kr">region</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
   <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;square flags = &quot;</span><span class="o">+</span><span class="n">i</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="border">
<span id="meshborder"></span><h2>Border<a class="headerlink" href="#border" title="Permalink to this headline"> </a></h2>
<p>Boundaries are defined piecewise by parametrized curves. The pieces can only intersect at their endpoints, but it is possible to join more than two endpoints. This can be used to structure the mesh if an area touches a border and create new regions by dividing larger ones:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">upper</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">others</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">inner</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

<span class="kt">border</span> <span class="nf">C01</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C02</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C03</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">upper</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C04</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C05</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C06</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">others</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C11</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C12</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C13</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">inner</span><span class="p">;}</span>

<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C02</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C03</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C04</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C05</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span>
  <span class="o">+</span> <span class="n">C06</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C11</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C12</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C13</span><span class="p">(</span><span class="kr">n</span><span class="p">),</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C02</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C03</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C04</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C05</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span>
  <span class="o">+</span> <span class="n">C06</span><span class="p">(</span><span class="o">-</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C11</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C12</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C13</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Part 1 has region number &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">).</span><span class="kr">region</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Part 2 has redion number &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">).</span><span class="kr">region</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Borders and mesh are respectively shown in <a class="reference internal" href="#figmultipleborder"><span class="std std-numref">Fig. 58</span></a> and <a class="reference internal" href="#figgeneratedmesh"><span class="std std-numref">Fig. 59</span></a>.</p>
<div class="figure compound align-center" id="MeshGeneration_Border">
<div style="width: 49%" class="subfigure" id="id14">
<span id="figmultipleborder"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border1.png"><img alt="MeshGeneration_Border1" src="../_images/MeshGeneration_Border1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 58 </span><span class="caption-text">Multiple border ends intersect</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id15">
<span id="figgeneratedmesh"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border2.png"><img alt="MeshGeneration_Border2" src="../_images/MeshGeneration_Border2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 59 </span><span class="caption-text">Generated mesh</span></p>
</div>
<p class="caption"><span class="caption-text">Border</span></p>
</div><p id="MeshGeneration_Border">Triangulation keywords assume that the domain is defined as being on the <em>left</em> (resp <em>right</em>) of its oriented parameterized boundary</p>
<div class="math notranslate nohighlight">
\[\Gamma_j = \{(x,y)\left|\; x=\varphi_x(t),\, y=\varphi_y(t),\, a_j\le t\le b_j\right.\}\]</div>
<p>To check the orientation plot <span class="math notranslate nohighlight">\(t\mapsto (\varphi_x(t),\varphi_y(t)),\, t_0\le t\le t_1\)</span>. If it is as in <a class="reference internal" href="#figborder"><span class="std std-numref">Fig. 60</span></a>, then the domain lies on the shaded area, otherwise it lies on the opposite side.</p>
<div class="figure" id="figborder">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Border3.png"><img alt="../_images/MeshGeneration_Border3.png" src="../_images/MeshGeneration_Border3.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 60 </span><span class="caption-text">Orientation of the boundary defined by <span class="math notranslate nohighlight">\((\phi_x(t),\phi_y(t))\)</span></span></p>
</div>
<p>The general expression to define a triangulation with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> is</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Mesh_Name</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="o">+</span><span class="p">...</span><span class="o">+</span><span class="n">GammaJ</span><span class="p">(</span><span class="n">mj</span><span class="p">),</span> <span class="n">OptionalParameter</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>where <span class="math notranslate nohighlight">\(m_j\)</span> are positive or negative numbers to indicate how many vertices should be on <span class="math notranslate nohighlight">\(\Gamma_j,\, \Gamma=\cup_{j=1}^J \Gamma_J\)</span>, and the optional parameter (see also <a class="reference internal" href="../reference/functions.html#referencebuildmesh"><span class="std std-ref">References</span></a>), separated with a comma, can be:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbvx</span><span class="o">=</span> <span class="kt">int</span></code>, to set the maximum number of vertices in the mesh.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fixedborder</span><span class="o">=</span> <span class="kt">bool</span></code>, to say if the mesh generator can change the boundary mesh or not (by default the boundary mesh can change; beware that with periodic boundary conditions (see. <a class="reference internal" href="finiteElement.html#finiteelement"><span class="std std-ref">Finite Element</span></a>), it can be dangerous.</li>
</ul>
<p>The orientation of boundaries can be changed by changing the sign of <span class="math notranslate nohighlight">\(m_j\)</span>.</p>
<p>The following example shows how to change the orientation. The example generates the unit disk with a small circular hole, and assigns “1” to the unit disk (“2” to the circle inside). The boundary label <strong>must be non-zero</strong>, but it can also be omitted.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.3</span><span class="o">+</span><span class="mf">0.3</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.3</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span> <span class="c1">//to see a plot of the border mesh</span>
<span class="kt">mesh</span> <span class="n">Thwithouthole</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
<span class="kt">mesh</span> <span class="n">Thwithhole</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Thwithouthole</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Thwithouthole.eps&quot;</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Thwithhole</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Thwithhole.eps&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Notice that the orientation is changed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">b</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span></code> in the 5th line. In the 7th line, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ps</span><span class="o">=</span><span class="s">&quot;fileName&quot;</span></code> is used to generate a postscript file with identification shown on the figure.</p>
</div>
<div class="figure compound align-center" id="MeshWithHole">
<div style="width: 49%" class="subfigure" id="id16">
<span id="figmeswithouthhole"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border4.png"><img alt="MeshGeneration_Border4" src="../_images/MeshGeneration_Border4.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 61 </span><span class="caption-text">Mesh without hole</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id17">
<span id="figmeshwithhole"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Border5.png"><img alt="MeshGeneration_Border5" src="../_images/MeshGeneration_Border5.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 62 </span><span class="caption-text">Mesh with hole</span></p>
</div>
<p class="caption"><span class="caption-text">Mesh with a hole</span></p>
</div><div class="admonition note" id="MeshWithHole">
<p class="first admonition-title">Note</p>
<p>Borders are evaluated only at the time <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">plot</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> is called so the global variables are defined at this time. In this case, since <span class="math notranslate nohighlight">\(r\)</span> is changed between the two border calls, the following code will not work because the first border will be computed with r=0.3:</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="n">r</span><span class="o">=</span><span class="mf">0.3</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Thwithhole</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">));</span> <span class="c1">// bug (a trap) because</span>
    <span class="c1">// the two circles have the same radius = :math:`0.3`</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="multi-border">
<h2>Multi-Border<a class="headerlink" href="#multi-border" title="Permalink to this headline"> </a></h2>
<p>Sometimes it can be useful to make an array of the border, but unfortunately it is incompatible with the <strong>FreeFEM</strong> syntax. To bypass this problem, if the number of segments of the discretization <span class="math notranslate nohighlight">\(n\)</span> is an array, we make an implicit loop on all of the values of the array, and the index variable <span class="math notranslate nohighlight">\(i\)</span> of the loop is defined after the parameter definition, like in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">border</span> <span class="n">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="n">i</span><span class="p">)</span></code> …</p>
<p>A first very small example:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="n">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="n">i</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">nn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">];</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">nn</span><span class="p">));</span> <span class="c1">//plot 3 circles with 10, 20, 30 points</span>
</pre></div>
</td></tr></table></div>
<p>And a more complex example to define a square with small circles:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="c1">//radius, center of the 4 circles</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">RC</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
          <span class="n">XC</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
          <span class="n">YC</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">NC</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">];</span> <span class="c1">//list number of :math:`\pm` segments of the 4 circles borders</span>

<span class="kt">border</span> <span class="kp">bb</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// i is the index variable of the multi border loop</span>
    <span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">4</span><span class="p">;</span>
    <span class="kt">real</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span>
    <span class="kr">x</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">t1</span> <span class="o">+</span> <span class="n">xx</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
    <span class="kr">y</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">t1</span> <span class="o">+</span> <span class="n">yy</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
    <span class="kr">label</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">border</span> <span class="n">cc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kr">x</span> <span class="o">=</span> <span class="n">RC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">XC</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kr">y</span> <span class="o">=</span> <span class="n">RC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">YC</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kr">label</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">nn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">];</span> <span class="c1">//4 border, with 4, 4, 5, 7 segment respectively</span>
<span class="nf">plot</span><span class="p">(</span><span class="kp">bb</span><span class="p">(</span><span class="n">nn</span><span class="p">),</span> <span class="n">cc</span><span class="p">(</span><span class="n">NC</span><span class="p">),</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="kp">bb</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="n">cc</span><span class="p">(</span><span class="n">NC</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="data-structures-and-read-write-statements-for-a-mesh">
<span id="meshdatastructurereadwrite"></span><h2>Data Structures and Read/Write Statements for a Mesh<a class="headerlink" href="#data-structures-and-read-write-statements-for-a-mesh" title="Permalink to this headline"> </a></h2>
<p>Users who want to read a triangulation made elsewhere should see the structure of the file generated below:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="s">&quot;mesh.msh&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The mesh is shown on <a class="reference internal" href="#figbuildmesh"><span class="std std-numref">Fig. 63</span></a>.</p>
<p>The information about <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> are saved in the file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">mesh</span><span class="p">.</span><span class="n">msh</span></code> whose structure is shown on <a class="reference internal" href="#tabmeshstructure"><span class="std std-numref">Table 1</span></a>.</p>
<p>There, <span class="math notranslate nohighlight">\(n_v\)</span> denotes the number of vertices, <span class="math notranslate nohighlight">\(n_t\)</span> the number of triangles and <span class="math notranslate nohighlight">\(n_s\)</span> the number of edges on boundary.</p>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i,\, i=1,\cdots,n_v\)</span>, denoted by <span class="math notranslate nohighlight">\((q^i_x,q^i_y)\)</span> the <span class="math notranslate nohighlight">\(x\)</span>-coordinate and <span class="math notranslate nohighlight">\(y\)</span>-coordinate.</p>
<p>Each triangle <span class="math notranslate nohighlight">\(T_k, k=1,\cdots,n_t\)</span> has three vertices <span class="math notranslate nohighlight">\(q^{k_1},\, q^{k_2},\,q^{k_3}\)</span> that are oriented counter-clockwise.</p>
<p>The boundary consists of 10 lines <span class="math notranslate nohighlight">\(L_i,\, i=1,\cdots,10\)</span> whose end points are <span class="math notranslate nohighlight">\(q^{i_1},\, q^{i_2}\)</span>.</p>
<div class="figure" id="figbuildmesh">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Data.png"><img alt="../_images/MeshGeneration_Data.png" src="../_images/MeshGeneration_Data.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 63 </span><span class="caption-text">Mesh by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span></code></span></p>
</div>
<p>In the <a class="reference internal" href="#figbuildmesh"><span class="std std-numref">Fig. 63</span></a>, we have the following.</p>
<p><span class="math notranslate nohighlight">\(n_v=14, n_t=16, n_s=10\)</span></p>
<p><span class="math notranslate nohighlight">\(q^1=(-0.309016994375, 0.951056516295)\)</span></p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p><span class="math notranslate nohighlight">\(q^{14}=(-0.309016994375, -0.951056516295)\)</span></p>
<p>The vertices of <span class="math notranslate nohighlight">\(T_1\)</span> are <span class="math notranslate nohighlight">\(q^9, q^{12},\, q^{10}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p>The vertices of <span class="math notranslate nohighlight">\(T_{16}\)</span> are <span class="math notranslate nohighlight">\(q^9, q^{10}, q^{6}\)</span>.</p>
<p>The edge of the 1st side <span class="math notranslate nohighlight">\(L_1\)</span> are <span class="math notranslate nohighlight">\(q^6, q^5\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\dots\)</span></p>
<p>The edge of the 10th side <span class="math notranslate nohighlight">\(L_{10}\)</span> are <span class="math notranslate nohighlight">\(q^{10}, q^6\)</span>.</p>
<table border="1" class="docutils" id="tabmeshstructure">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">The structure of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">mesh_sample</span><span class="p">.</span><span class="n">msh</span></code></span><a class="headerlink" href="#tabmeshstructure" title="Permalink to this table"> </a></caption>
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Content of the file</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>14 16 10</td>
<td><span class="math notranslate nohighlight">\(n_v\quad n_t\quad n_e\)</span></td>
</tr>
<tr class="row-odd"><td><p class="first">-0.309016994375 0.951056516295 1</p>
<p>0.309016994375 0.951056516295 1</p>
<p>…</p>
<p class="last">-0.309016994375 -0.951056516295 1</p>
</td>
<td><p class="first"><span class="math notranslate nohighlight">\(q^1_x\quad q^1_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p><span class="math notranslate nohighlight">\(q^2_x\quad q^2_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p>…</p>
<p class="last"><span class="math notranslate nohighlight">\(q^{14}_x\quad q^{14}_y\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
</td>
</tr>
<tr class="row-even"><td><p class="first">9 12 10 0</p>
<p>5 9 6 0</p>
<p>…</p>
<p class="last">9 10 6 0</p>
</td>
<td><p class="first"><span class="math notranslate nohighlight">\(1_1\quad 1_2\quad 1_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
<p><span class="math notranslate nohighlight">\(2_1\quad 2_2\quad 2_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
<p>…</p>
<p class="last"><span class="math notranslate nohighlight">\(16_1\quad 16_2\quad 16_3\quad\)</span> region label <span class="math notranslate nohighlight">\(=0\)</span></p>
</td>
</tr>
<tr class="row-odd"><td><p class="first">6 5 1</p>
<p>5 2 1</p>
<p>…</p>
<p class="last">10 6 1</p>
</td>
<td><p class="first"><span class="math notranslate nohighlight">\(1_1\quad 1_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p><span class="math notranslate nohighlight">\(2_1\quad 2_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
<p>…</p>
<p class="last"><span class="math notranslate nohighlight">\(10_1\quad 10_2\quad\)</span> boundary label <span class="math notranslate nohighlight">\(=1\)</span></p>
</td>
</tr>
</tbody>
</table>
<p>In <strong>FreeFEM</strong> there are many mesh file formats available for communication with other tools such as <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">emc2</span></code>, <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">modulef</span></code>, … (see <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh format chapter</span></a> ).</p>
<p>The extension of a file implies its format.
More details can be found on the file format .msh in the article by F. Hecht “bamg : a bidimensional anisotropic mesh generator” <a class="reference internal" href="../reference.html#hecht1998-2" id="id1">[HECHT1998_2]</a>.</p>
<p>A mesh file can be read into <strong>FreeFEM</strong> except that the names of the borders are lost and only their reference numbers are kept.
So these borders have to be referenced by the number which corresponds to their order of appearance in the program, unless this number is overwritten by the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code>. Here are some examples:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">floor</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">ceiling</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;}</span>

<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">right</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">ceiling</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">left</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.am_fmt&quot;</span><span class="p">);</span> <span class="c1">//&quot;formatted Marrocco&quot; format</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.Th&quot;</span><span class="p">);</span> <span class="c1">//&quot;bamg&quot;-type mesh</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.msh&quot;</span><span class="p">);</span> <span class="c1">//freefem format</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.nopo&quot;</span><span class="p">);</span> <span class="c1">//modulef format</span>
<span class="kt">mesh</span> <span class="n">th2</span> <span class="o">=</span> <span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;toto.msh&quot;</span><span class="p">);</span> <span class="c1">//read the mesh</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">floor</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">ceiling</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>

<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">right</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">ceiling</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">left</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>

<span class="c1">//save mesh in different formats</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.am_fmt&quot;</span><span class="p">);</span> <span class="c1">// format &quot;formated Marrocco&quot;</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.Th&quot;</span><span class="p">);</span> <span class="c1">// format database db mesh &quot;bamg&quot;</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.msh&quot;</span><span class="p">);</span> <span class="c1">// format freefem</span>
<span class="nf">savemesh</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="s">&quot;toto.nopo&quot;</span><span class="p">);</span> <span class="c1">// modulef format</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">femp1</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">femp1</span> <span class="n">f</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="n">femp1</span> <span class="n">g</span><span class="p">;</span>

<span class="c1">//save the fespace function in a file</span>
<span class="p">{</span>
  <span class="kt">ofstream</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;f.txt&quot;</span><span class="p">);</span>
  <span class="kp">file</span> <span class="o">&lt;&lt;</span> <span class="n">f</span><span class="p">[]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">//the file is automatically closed at the end of the block</span>
<span class="c1">//read a file and put it in a fespace function</span>
<span class="p">{</span>
  <span class="kt">ifstream</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;f.txt&quot;</span><span class="p">);</span>
  <span class="kp">file</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">[]</span> <span class="p">;</span>
<span class="p">}</span><span class="c1">//the file is equally automatically closed</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>

<span class="c1">// Mesh 2</span>
<span class="c1">//read the mesh for freefem format saved mesh</span>
<span class="kt">mesh</span> <span class="n">th2</span> <span class="o">=</span> <span class="nf">readmesh</span><span class="p">(</span><span class="s">&quot;toto.msh&quot;</span><span class="p">);</span>

<span class="c1">// Fespace 2</span>
<span class="kt">fespace</span> <span class="nf">Vh2</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh2</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="c1">//solve:</span>
<span class="c1">//  $u + \Delta u = g$ in $\Omega $</span>
<span class="c1">//  $u=0$ on $\Gamma_1$</span>
<span class="c1">//  $\frac{\partial u }{\partial n} = g$ on $\Gamma_2$</span>
<span class="kt">solve</span> <span class="nf">Problem</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
  <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th2</span><span class="p">)(</span>
      <span class="n">u</span><span class="o">*</span><span class="n">v</span>
    <span class="o">-</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="o">-</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  <span class="p">)</span>
  <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th2</span><span class="p">)(</span>
    <span class="o">-</span> <span class="n">g</span><span class="o">*</span><span class="n">v</span>
  <span class="p">)</span>
  <span class="o">+</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)(</span>
      <span class="n">g</span><span class="o">*</span><span class="n">v</span>
  <span class="p">)</span>
  <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="p">;</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">th2</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="mesh-connectivity-and-data">
<h2>Mesh Connectivity and data<a class="headerlink" href="#mesh-connectivity-and-data" title="Permalink to this headline"> </a></h2>
<p>The following example explains methods to obtain mesh information.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Get data of the mesh&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">NbTriangles</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span>
    <span class="kt">real</span> <span class="n">MeshArea</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">measure</span><span class="p">;</span>
    <span class="kt">real</span> <span class="n">BorderLenght</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">bordermeasure</span><span class="p">;</span>

    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of triangle(s) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">NbTriangles</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Mesh area = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">MeshArea</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Border length = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">BorderLenght</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="c1">// Th(i) return the vextex i of Th</span>
    <span class="c1">// Th[k] return the triangle k of Th</span>
    <span class="c1">// Th[k][i] return the vertex i of the triangle k of Th</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NbTriangles</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">j</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; - Th[i][j] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                 <span class="o">&lt;&lt;</span> <span class="s">&quot;, x = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">x</span>
                 <span class="o">&lt;&lt;</span> <span class="s">&quot;, y= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">y</span>
                 <span class="o">&lt;&lt;</span> <span class="s">&quot;, label=&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="kr">label</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Hack to get vertex coordinates&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">fespace</span> <span class="n">femp1</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
    <span class="n">femp1</span> <span class="n">Thx</span><span class="o">=</span><span class="kr">x</span><span class="p">,</span><span class="n">Thy</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">NbVertices</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of vertices = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">NbVertices</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NbVertices</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Th(&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;) : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">x</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">y</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="kr">label</span>
             <span class="o">&lt;&lt;</span> <span class="kr">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">old method: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Thx</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Thy</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Method to find information of point (0.55,0.6)&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">TNumber</span> <span class="o">=</span> <span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">).</span><span class="kr">nuTriangle</span><span class="p">;</span> <span class="c1">//the triangle number</span>
    <span class="kt">int</span> <span class="n">RLabel</span> <span class="o">=</span> <span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">).</span><span class="kr">region</span><span class="p">;</span> <span class="c1">//the region label</span>

    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Triangle number in point (0.55, 0.6): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TNumber</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Region label in point (0.55, 0.6): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">RLabel</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Information of triangle&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">TNumber</span> <span class="o">=</span> <span class="n">Th</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">).</span><span class="kr">nuTriangle</span><span class="p">;</span>
    <span class="kt">real</span> <span class="n">TArea</span> <span class="o">=</span> <span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">area</span><span class="p">;</span> <span class="c1">//triangle area</span>
    <span class="kt">real</span> <span class="n">TRegion</span> <span class="o">=</span> <span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">region</span><span class="p">;</span> <span class="c1">//triangle region</span>
    <span class="kt">real</span> <span class="n">TLabel</span> <span class="o">=</span> <span class="n">Th</span><span class="p">[</span><span class="n">TNumber</span><span class="p">].</span><span class="kr">label</span><span class="p">;</span> <span class="c1">//triangle label, same as region for triangles</span>

    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Area of triangle &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TNumber</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TArea</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Region of triangle &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TNumber</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TRegion</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Label of triangle &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TNumber</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TLabel</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Hack to get a triangle containing point x, y or region number (old method)&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">fespace</span> <span class="n">femp0</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
    <span class="n">femp0</span> <span class="n">TNumbers</span><span class="p">;</span> <span class="c1">//a P0 function to get triangle numbering</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">TNumbers</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">femp0</span> <span class="n">RNumbers</span> <span class="o">=</span> <span class="kr">region</span><span class="p">;</span> <span class="c1">//a P0 function to get the region number</span>

    <span class="kt">int</span> <span class="n">TNumber</span> <span class="o">=</span> <span class="n">TNumbers</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">);</span> <span class="c1">// Number of the triangle containing (0.55, 0,6)</span>
    <span class="kt">int</span> <span class="n">RNumber</span> <span class="o">=</span> <span class="n">RNumbers</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">);</span> <span class="c1">// Number of the region containing (0.55, 0,6)</span>

    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Point (0.55,0,6) :&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">Triangle number = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">TNumber</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">Region number = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">RNumber</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// New method to get boundary information and mesh adjacent&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">e</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Number of boundary elements</span>
    <span class="kt">int</span> <span class="n">NbBoundaryElements</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of boundary element = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">NbBoundaryElements</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// Boundary element k in {0, ..., Th.nbe}</span>
    <span class="kt">int</span> <span class="n">BoundaryElement</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Boundary element &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">BoundaryElement</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// Vertice l in {0, 1} of boundary element k</span>
    <span class="kt">int</span> <span class="n">Vertex</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="n">l</span><span class="p">];</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Vertex &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">l</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; of boundary element &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Vertex</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// Triangle containg the boundary element k</span>
    <span class="kt">int</span> <span class="n">Triangle</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">Element</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Triangle containing the boundary element &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Triangle</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// Triangle egde nubmer containing the boundary element k</span>
    <span class="kt">int</span> <span class="n">Edge</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">whoinElement</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Triangle edge number containing the boundary element &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Edge</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// Adjacent triangle of the triangle k by edge e</span>
    <span class="kt">int</span> <span class="n">Adjacent</span> <span class="o">=</span> <span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="c1">//The value of e is changed to the corresponding edge in the adjacent triangle</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Adjacent triangle of the triangle &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; by edge &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Adjacent</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">Corresponding edge = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="c1">// If there is no adjacent triangle by edge e, the same triangle is returned</span>
    <span class="c1">//Th[k] == Th[k].adj(e)</span>
    <span class="c1">// Else a different triangle is returned</span>
    <span class="c1">//Th[k] != Th[k].adj(e)</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;// Print mesh connectivity &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">NbTriangles</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">NbTriangles</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
             <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
             <span class="o">&lt;&lt;</span> <span class="s">&quot;, label &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">label</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">NbTriangles</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ee</span><span class="p">;</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">e</span><span class="o">++</span><span class="p">)</span>
            <span class="c1">//set ee to e, and ee is change by method adj,</span>
            <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &lt;=&gt; &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">((</span><span class="n">ee</span><span class="o">=</span><span class="n">e</span><span class="p">)))</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ee</span>
                 <span class="o">&lt;&lt;</span> <span class="s">&quot;, adj: &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="kr">adj</span><span class="p">((</span><span class="n">ee</span><span class="o">=</span><span class="n">e</span><span class="p">))</span> <span class="o">!=</span> <span class="n">Th</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">NbBoundaryElements</span> <span class="o">=</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nbe</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">NbBoundaryElements</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">k</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
             <span class="o">&lt;&lt;</span> <span class="s">&quot; , label &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">label</span>
             <span class="o">&lt;&lt;</span> <span class="s">&quot;, triangle &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="n">Element</span><span class="p">)</span>
             <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">be</span><span class="p">(</span><span class="n">k</span><span class="p">).</span><span class="kr">whoinElement</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">bb</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="n">boundingbox</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">bb</span><span class="p">);</span>
    <span class="c1">// bb[0] = xmin, bb[1] = xmax, bb[2] = ymin, bb[3] =ymax</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;boundingbox:&quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;xmin = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
         <span class="o">&lt;&lt;</span> <span class="s">&quot;, xmax = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
         <span class="o">&lt;&lt;</span> <span class="s">&quot;, ymin = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">bb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
         <span class="o">&lt;&lt;</span> <span class="s">&quot;, ymax = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">bb</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The output is:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110</pre></div></td><td class="code"><div class="highlight"><pre><span></span>// Get data of the mesh
Number of <span class="nv">triangle</span> <span class="o">=</span> <span class="m">8</span>
Mesh <span class="nv">area</span> <span class="o">=</span> <span class="m">1</span>
Border <span class="nv">length</span> <span class="o">=</span> <span class="m">4</span>
<span class="m">0</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">0</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="m">0</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">1</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">1</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">1</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">3</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">2</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="m">2</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">2</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="m">2</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">5</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="m">3</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>, <span class="nv">label</span><span class="o">=</span><span class="m">1</span>
<span class="m">3</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">5</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="m">3</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">4</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">3</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">4</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">4</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">7</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="m">5</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">3</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">5</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">7</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="m">5</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">6</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">4</span>
<span class="m">6</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">6</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">5</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">2</span>
<span class="m">6</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">8</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="m">7</span> <span class="m">0</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">4</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">0</span>.5, <span class="nv">label</span><span class="o">=</span><span class="m">0</span>
<span class="m">7</span> <span class="m">1</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">8</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">3</span>
<span class="m">7</span> <span class="m">2</span> - Th<span class="o">[</span>i<span class="o">][</span>j<span class="o">]</span> <span class="o">=</span> <span class="m">7</span>, <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>.5, <span class="nv">y</span><span class="o">=</span> <span class="m">1</span>, <span class="nv">label</span><span class="o">=</span><span class="m">3</span>
// Hack to get vertex coordinates
Number of <span class="nv">vertices</span> <span class="o">=</span> <span class="m">9</span>
Th<span class="o">(</span><span class="m">0</span><span class="o">)</span> : <span class="m">0</span> <span class="m">0</span> <span class="m">4</span>
   old method: <span class="m">0</span> <span class="m">0</span>
Th<span class="o">(</span><span class="m">1</span><span class="o">)</span> : <span class="m">0</span>.5 <span class="m">0</span> <span class="m">1</span>
   old method: <span class="m">0</span>.5 <span class="m">0</span>
Th<span class="o">(</span><span class="m">2</span><span class="o">)</span> : <span class="m">1</span> <span class="m">0</span> <span class="m">2</span>
   old method: <span class="m">1</span> <span class="m">0</span>
Th<span class="o">(</span><span class="m">3</span><span class="o">)</span> : <span class="m">0</span> <span class="m">0</span>.5 <span class="m">4</span>
   old method: <span class="m">0</span> <span class="m">0</span>.5
Th<span class="o">(</span><span class="m">4</span><span class="o">)</span> : <span class="m">0</span>.5 <span class="m">0</span>.5 <span class="m">0</span>
   old method: <span class="m">0</span>.5 <span class="m">0</span>.5
Th<span class="o">(</span><span class="m">5</span><span class="o">)</span> : <span class="m">1</span> <span class="m">0</span>.5 <span class="m">2</span>
   old method: <span class="m">1</span> <span class="m">0</span>.5
Th<span class="o">(</span><span class="m">6</span><span class="o">)</span> : <span class="m">0</span> <span class="m">1</span> <span class="m">4</span>
   old method: <span class="m">0</span> <span class="m">1</span>
Th<span class="o">(</span><span class="m">7</span><span class="o">)</span> : <span class="m">0</span>.5 <span class="m">1</span> <span class="m">3</span>
   old method: <span class="m">0</span>.5 <span class="m">1</span>
Th<span class="o">(</span><span class="m">8</span><span class="o">)</span> : <span class="m">1</span> <span class="m">1</span> <span class="m">3</span>
   old method: <span class="m">1</span> <span class="m">1</span>
// Method to find the information of point <span class="o">(</span><span class="m">0</span>.55,0.6<span class="o">)</span>
Triangle number in point <span class="o">(</span><span class="m">0</span>.55, <span class="m">0</span>.6<span class="o">)</span>: <span class="m">7</span>
Region label in point <span class="o">(</span><span class="m">0</span>.55, <span class="m">0</span>.6<span class="o">)</span>: <span class="m">0</span>
// Information of a triangle
Area of triangle <span class="m">7</span>: <span class="m">0</span>.125
Region of triangle <span class="m">7</span>: <span class="m">0</span>
Label of triangle <span class="m">7</span>: <span class="m">0</span>
// Hack to get a triangle containing point x, y or region number <span class="o">(</span>old method<span class="o">)</span>
Point <span class="o">(</span><span class="m">0</span>.55,0,6<span class="o">)</span> :
   Triangle <span class="nv">number</span> <span class="o">=</span> <span class="m">7</span>
   Region <span class="nv">number</span> <span class="o">=</span> <span class="m">0</span>
// New method to get boundary information and mesh adjacent
Number of boundary <span class="nv">element</span> <span class="o">=</span> <span class="m">8</span>
Boundary element <span class="nv">0</span> <span class="o">=</span> <span class="m">0</span>
Vertex <span class="m">1</span> of boundary element <span class="nv">0</span> <span class="o">=</span> <span class="m">1</span>
Triangle containing the boundary element <span class="nv">0</span> <span class="o">=</span> <span class="m">0</span>
Triangle edge number containing the boundary element <span class="nv">0</span> <span class="o">=</span> <span class="m">2</span>
Adjacent triangle of the triangle <span class="m">0</span> by edge <span class="nv">1</span> <span class="o">=</span> <span class="m">1</span>
   Corresponding <span class="nv">edge</span> <span class="o">=</span> <span class="m">2</span>
// Print mesh connectivity
<span class="m">0</span> : <span class="m">0</span> <span class="m">1</span> <span class="m">4</span>, label <span class="m">0</span>
<span class="m">1</span> : <span class="m">0</span> <span class="m">4</span> <span class="m">3</span>, label <span class="m">0</span>
<span class="m">2</span> : <span class="m">1</span> <span class="m">2</span> <span class="m">5</span>, label <span class="m">0</span>
<span class="m">3</span> : <span class="m">1</span> <span class="m">5</span> <span class="m">4</span>, label <span class="m">0</span>
<span class="m">4</span> : <span class="m">3</span> <span class="m">4</span> <span class="m">7</span>, label <span class="m">0</span>
<span class="m">5</span> : <span class="m">3</span> <span class="m">7</span> <span class="m">6</span>, label <span class="m">0</span>
<span class="m">6</span> : <span class="m">4</span> <span class="m">5</span> <span class="m">8</span>, label <span class="m">0</span>
<span class="m">7</span> : <span class="m">4</span> <span class="m">8</span> <span class="m">7</span>, label <span class="m">0</span>
<span class="m">0</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">3</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">0</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">1</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">0</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">0</span> <span class="m">2</span>, adj: <span class="m">0</span>
<span class="m">1</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">4</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">1</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">1</span> <span class="m">1</span>, adj: <span class="m">0</span>
<span class="m">1</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">0</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">2</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">2</span> <span class="m">0</span>, adj: <span class="m">0</span>
<span class="m">2</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">3</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">2</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">2</span> <span class="m">2</span>, adj: <span class="m">0</span>
<span class="m">3</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">6</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">3</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">0</span> <span class="m">0</span>, adj: <span class="m">1</span>
<span class="m">3</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">2</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">4</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">7</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">4</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">5</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">4</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">1</span> <span class="m">0</span>, adj: <span class="m">1</span>
<span class="m">5</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">5</span> <span class="m">0</span>, adj: <span class="m">0</span>
<span class="m">5</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">5</span> <span class="m">1</span>, adj: <span class="m">0</span>
<span class="m">5</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">4</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">6</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">6</span> <span class="m">0</span>, adj: <span class="m">0</span>
<span class="m">6</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">7</span> <span class="m">2</span>, adj: <span class="m">1</span>
<span class="m">6</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">3</span> <span class="m">0</span>, adj: <span class="m">1</span>
<span class="m">7</span> <span class="m">0</span> &lt;<span class="o">=</span>&gt; <span class="m">7</span> <span class="m">0</span>, adj: <span class="m">0</span>
<span class="m">7</span> <span class="m">1</span> &lt;<span class="o">=</span>&gt; <span class="m">4</span> <span class="m">0</span>, adj: <span class="m">1</span>
<span class="m">7</span> <span class="m">2</span> &lt;<span class="o">=</span>&gt; <span class="m">6</span> <span class="m">1</span>, adj: <span class="m">1</span>
<span class="m">0</span> : <span class="m">0</span> <span class="m">1</span> , label <span class="m">1</span>, triangle <span class="m">0</span> <span class="m">2</span>
<span class="m">1</span> : <span class="m">1</span> <span class="m">2</span> , label <span class="m">1</span>, triangle <span class="m">2</span> <span class="m">2</span>
<span class="m">2</span> : <span class="m">2</span> <span class="m">5</span> , label <span class="m">2</span>, triangle <span class="m">2</span> <span class="m">0</span>
<span class="m">3</span> : <span class="m">5</span> <span class="m">8</span> , label <span class="m">2</span>, triangle <span class="m">6</span> <span class="m">0</span>
<span class="m">4</span> : <span class="m">6</span> <span class="m">7</span> , label <span class="m">3</span>, triangle <span class="m">5</span> <span class="m">0</span>
<span class="m">5</span> : <span class="m">7</span> <span class="m">8</span> , label <span class="m">3</span>, triangle <span class="m">7</span> <span class="m">0</span>
<span class="m">6</span> : <span class="m">0</span> <span class="m">3</span> , label <span class="m">4</span>, triangle <span class="m">1</span> <span class="m">1</span>
<span class="m">7</span> : <span class="m">3</span> <span class="m">6</span> , label <span class="m">4</span>, triangle <span class="m">5</span> <span class="m">1</span>
boundingbox:
<span class="nv">xmin</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">xmax</span> <span class="o">=</span> <span class="m">1</span>, <span class="nv">ymin</span> <span class="o">=</span> <span class="m">0</span>, <span class="nv">ymax</span> <span class="o">=</span> <span class="m">1</span>
</pre></div>
</td></tr></table></div>
<p>The real characteristic function of a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)</span></code> in 2D and 3D where:</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="kr">P</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span></code> if <span class="math notranslate nohighlight">\(P\in Th\)</span></p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">chi</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span><span class="kr">P</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span></code> if <span class="math notranslate nohighlight">\(P\not\in Th\)</span></p>
</div>
<div class="section" id="the-keyword-triangulate">
<h2>The keyword “triangulate”<a class="headerlink" href="#the-keyword-triangulate" title="Permalink to this headline"> </a></h2>
<p><strong>FreeFEM</strong> is able to build a triangulation from a set of points.
This triangulation is a Delaunay mesh of the convex hull of the set of points.
It can be useful to build a mesh from a table function.</p>
<p>The coordinates of the points and the value of the table function are defined separately with rows of the form: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">x</span> <span class="kr">y</span> <span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span></code> in a file such as:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="mf">0.51387</span> <span class="mf">0.175741</span> <span class="mf">0.636237</span>
<span class="mf">0.308652</span> <span class="mf">0.534534</span> <span class="mf">0.746765</span>
<span class="mf">0.947628</span> <span class="mf">0.171736</span> <span class="mf">0.899823</span>
<span class="mf">0.702231</span> <span class="mf">0.226431</span> <span class="mf">0.800819</span>
<span class="mf">0.494773</span> <span class="mf">0.12472</span> <span class="mf">0.580623</span>
<span class="mf">0.0838988</span> <span class="mf">0.389647</span> <span class="mf">0.456045</span>
<span class="p">...............</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="Triangulate">
<div style="width: 49%" class="subfigure" id="id18">
<span id="figdelaunaymesh"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Triangulate1.png"><img alt="MeshGeneration_Triangulate1" src="../_images/MeshGeneration_Triangulate1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 64 </span><span class="caption-text">Delaunay mesh of the convex hull of point set in file xy</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id19">
<span id="figisovalue"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Triangulate2.png"><img alt="MeshGeneration_Triangulate2" src="../_images/MeshGeneration_Triangulate2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 65 </span><span class="caption-text">Isolvalue of table function</span></p>
</div>
<p class="caption"><span class="caption-text">Triangulate</span></p>
</div><p id="Triangulate">The third column of each line is left untouched by the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">triangulate</span></code> command.
But you can use this third value to define a table function with rows of the form: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">x</span> <span class="kr">y</span> <span class="n">f</span><span class="p">(</span><span class="kr">x</span><span class="p">,</span><span class="kr">y</span><span class="p">)</span></code>.</p>
<p>The following example shows how to make a mesh from the file <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">xyf</span></code> with the format stated just above.
The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">triangulate</span></code> only uses the 1st and 2nd columns.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Build the Delaunay mesh of the convex hull</span>
<span class="kt">mesh</span> <span class="n">Thxy</span><span class="o">=</span><span class="nf">triangulate</span><span class="p">(</span><span class="s">&quot;xyf&quot;</span><span class="p">);</span> <span class="c1">//points are defined by the first 2 columns of file `xyf`</span>

<span class="c1">// Plot the created mesh</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Thxy</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vhxy</span><span class="p">(</span><span class="n">Thxy</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vhxy</span> <span class="n">fxy</span><span class="p">;</span>

<span class="c1">// Reading the 3rd column to define the function fxy</span>
<span class="p">{</span>
    <span class="kt">ifstream</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;xyf&quot;</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">fxy</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="kp">file</span> <span class="o">&gt;&gt;</span> <span class="n">xx</span> <span class="o">&gt;&gt;</span> <span class="n">yy</span> <span class="o">&gt;&gt;</span> <span class="n">fxy</span><span class="p">[][</span><span class="n">i</span><span class="p">];</span> <span class="c1">//to read third row only.</span>
                                      <span class="c1">//xx and yy are just skipped</span>
<span class="p">}</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fxy</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>One new way to build a mesh is to have two arrays: one for the <span class="math notranslate nohighlight">\(x\)</span> values and the other for the <span class="math notranslate nohighlight">\(y\)</span> values.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//set two arrays for the x&#39;s and y&#39;s</span>
<span class="n">Vhxy</span> <span class="n">xx</span><span class="o">=</span><span class="kr">x</span><span class="p">,</span> <span class="n">yy</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>
<span class="c1">//build the mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">triangulate</span><span class="p">(</span><span class="n">xx</span><span class="p">[],</span> <span class="n">yy</span><span class="p">[]);</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="boundary-fem-spaces-built-as-empty-meshes">
<h3>Boundary FEM Spaces Built as Empty Meshes<a class="headerlink" href="#boundary-fem-spaces-built-as-empty-meshes" title="Permalink to this headline"> </a></h3>
<p>To define a Finite Element space on a boundary, we came up with the idea of a mesh with no internal points (called empty mesh).
It can be useful to handle Lagrange multipliers in mixed and mortar methods.</p>
<p>So the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">emptymesh</span></code> removes all the internal points of a mesh except points on internal boundaries.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="kt">border</span> <span class="n">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
    <span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>It is also possible to build an empty mesh of a pseudo subregion with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">ssd</span><span class="p">)</span></code> using the set of edges from the mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>; an edge <span class="math notranslate nohighlight">\(e\)</span> is in this set when, with the two adjacent triangles <span class="math notranslate nohighlight">\(e =t1\cap t2\)</span> and <span class="math notranslate nohighlight">\(ssd[T1] \neq ssd[T2]\)</span> where <span class="math notranslate nohighlight">\(ssd\)</span> refers to the pseudo region numbering of triangles, they are stored in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> array of size “the number of triangles”.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ssd</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nt</span><span class="p">);</span>
    <span class="c1">//build the pseudo region numbering</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ssd</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">iq</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="c1">//because 2 triangles per quad</span>
        <span class="kt">int</span> <span class="n">ix</span> <span class="o">=</span> <span class="n">iq</span><span class="o">%</span><span class="mi">10</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">iy</span> <span class="o">=</span> <span class="n">iq</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">ssd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ix</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">iy</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//build emtpy with all edges $e=T1 \cap T2$ and $ssd[T1] \neq ssd[T2]$</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">emptymesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">ssd</span><span class="p">);</span>
    <span class="c1">//plot</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>
    <span class="nf">savemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="s">&quot;emptymesh.msh&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="EmptyMesh">
<div style="width: 49%" class="subfigure" id="id20">
<span id="figemptymesh1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_EmptyMesh1.png"><img alt="MeshGeneration_EmptyMesh1" src="../_images/MeshGeneration_EmptyMesh1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 66 </span><span class="caption-text">The empty mesh with boundary</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id21">
<span id="figemptymesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_EmptyMesh2.png"><img alt="MeshGeneration_EmptyMesh2" src="../_images/MeshGeneration_EmptyMesh2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 67 </span><span class="caption-text">An empty mesh defined from a pseudo region numbering of triangle</span></p>
</div>
<p class="caption"><span class="caption-text">Empty mesh</span></p>
</div></div>
<div class="section" id="remeshing">
<span id="EmptyMesh"></span><h3>Remeshing<a class="headerlink" href="#remeshing" title="Permalink to this headline"> </a></h3>
</div>
</div>
<div class="section" id="movemesh">
<span id="meshgenerationmovemesh"></span><h2>Movemesh<a class="headerlink" href="#movemesh" title="Permalink to this headline"> </a></h2>
<p>Meshes can be translated, rotated, and deformed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code>; this is useful for elasticity to watch the deformation due to the displacement <span class="math notranslate nohighlight">\(\mathbf{\Phi}(x,y)=(\Phi_1(x,y),\Phi_2(x,y))\)</span> of shape.</p>
<p>It is also useful to handle free boundary problems or optimal shape problems.</p>
<p>If <span class="math notranslate nohighlight">\(\Omega\)</span> is triangulated as <span class="math notranslate nohighlight">\(T_h(\Omega)\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{\Phi}\)</span> is a displacement vector then <span class="math notranslate nohighlight">\(\mathbf{\Phi}(T_h)\)</span> is obtained by:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,[</span><span class="n">Phi1</span><span class="p">,</span> <span class="n">Phi2</span><span class="p">]);</span>
</pre></div>
</td></tr></table></div>
<p>Sometimes the transformed mesh is invalid because some triangles have flipped over (meaning it now has a negative area).
To spot such problems, one may check the minimum triangle area in the transformed mesh with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">checkmovemesh</span></code> before any real transformation.</p>
<p>For example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    \Phi_1(x,y) &amp;=&amp; x+k*\sin(y*\pi)/10)\\
    \Phi_2(x,y) &amp;=&amp; y+k*\cos(y\pi)/10)
\end{array}\end{split}\]</div>
<p>for a big number <span class="math notranslate nohighlight">\(k&gt;1\)</span>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">verbosity</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="kp">coef</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="nf">d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Lshape.eps&quot;</span><span class="p">);</span>

<span class="c1">// Function</span>
<span class="kt">func</span> <span class="n">uu</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">vv</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>

<span class="c1">// Checkmovemesh</span>
<span class="kt">real</span> <span class="n">minT0</span> <span class="o">=</span> <span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">]);</span> <span class="c1">//return the min triangle area</span>
<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span> <span class="c1">// find a correct move mesh</span>
    <span class="kt">real</span> <span class="n">minT</span> <span class="o">=</span> <span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">uu</span><span class="p">,</span> <span class="kr">y</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">vv</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">minT</span> <span class="o">&gt;</span> <span class="n">minT0</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span> <span class="c1">//if big enough</span>
    <span class="kp">coef</span> <span class="o">/=</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Movemesh</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">uu</span><span class="p">,</span> <span class="kr">y</span><span class="o">+</span><span class="kp">coef</span><span class="o">*</span><span class="n">vv</span><span class="p">]);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;MovedMesh.eps&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="MoveMesh">
<div style="width: 49%" class="subfigure" id="id22">
<span id="figlshape"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_MoveMesh1.png"><img alt="MeshGeneration_MoveMesh1" src="../_images/MeshGeneration_MoveMesh1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 68 </span><span class="caption-text">L-shape</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id23">
<span id="figmovedlshape"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_MoveMesh2.png"><img alt="MeshGeneration_MoveMesh2" src="../_images/MeshGeneration_MoveMesh2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 69 </span><span class="caption-text">Moved L-shape</span></p>
</div>
<p class="caption"><span class="caption-text">Move mesh</span></p>
</div><div class="admonition note" id="MoveMesh">
<p class="first admonition-title">Note</p>
<p class="last">Consider a function <span class="math notranslate nohighlight">\(u\)</span> defined on a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>.
A statement like <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span><span class="o">=</span><span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">...)</span></code> does not change <span class="math notranslate nohighlight">\(u\)</span> and so the old mesh still exists.
It will be destroyed when no function uses it.
A statement like <span class="math notranslate nohighlight">\(u=u\)</span> redefines <span class="math notranslate nohighlight">\(u\)</span> on the new mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> with interpolation and therefore destroys the old <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code>, if <span class="math notranslate nohighlight">\(u\)</span> was the only function using it.</p>
</div>
<p>Now, we give an example of moving a mesh with a Lagrangian function <span class="math notranslate nohighlight">\(u\)</span> defined on the moving mesh.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="o">=</span><span class="kr">y</span><span class="p">;</span>

<span class="c1">// Loop</span>
<span class="kt">real</span> <span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kp">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>
    <span class="n">Vh</span> <span class="n">f</span><span class="o">=</span><span class="kr">x</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span>
    <span class="kt">real</span> <span class="n">minarea</span> <span class="o">=</span> <span class="nf">checkmovemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="o">+</span><span class="n">f</span><span class="p">]);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">minarea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">//movemesh will be ok</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="o">+</span><span class="n">f</span><span class="p">]);</span>

    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Min area = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">minarea</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">tmp</span><span class="p">(</span><span class="n">u</span><span class="p">[].</span><span class="kr">n</span><span class="p">);</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">u</span><span class="p">[];</span> <span class="c1">//save the value</span>
    <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="c1">//to change the FEspace and mesh associated with u</span>
    <span class="n">u</span><span class="p">[]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span><span class="c1">//set the value of u without any mesh update</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// In this program, since u is only defined on the last mesh, all the</span>
<span class="c1">// previous meshes are deleted from memory.</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="regular-triangulation-htriangle">
<span id="meshregulartriangulation"></span><h3>Regular Triangulation: hTriangle<a class="headerlink" href="#regular-triangulation-htriangle" title="Permalink to this headline"> </a></h3>
<p>For a set <span class="math notranslate nohighlight">\(S\)</span>, we define the diameter of <span class="math notranslate nohighlight">\(S\)</span> by</p>
<div class="math notranslate nohighlight">
\[\textrm{diam}(S)=\sup\{|\mathbf{x}-\mathbf{y}|; \; \mathbf{x},\, \mathbf{y}\in S\}\]</div>
<p>The sequence <span class="math notranslate nohighlight">\(\{\mathcal{T}_h\}_{h\rightarrow 0}\)</span> of
<span class="math notranslate nohighlight">\(\Omega\)</span> is called <em>regular</em> if they satisfy the following:</p>
<ol class="arabic simple">
<li><span class="math notranslate nohighlight">\(\lim_{h\rightarrow 0}\max\{\textrm{diam}(T_k)|\; T_k\in \mathcal{T}_h\}=0\)</span></li>
<li>There is a number <span class="math notranslate nohighlight">\(\sigma&gt;0\)</span> independent of <span class="math notranslate nohighlight">\(h\)</span> such that <span class="math notranslate nohighlight">\(\frac{\rho(T_k)}{\textrm{diam}(T_k)}\ge \sigma\quad \textrm{for all }T_k\in \mathcal{T}_h\)</span> where <span class="math notranslate nohighlight">\(\rho(T_k)\)</span> are the diameter of the inscribed circle of <span class="math notranslate nohighlight">\(T_k\)</span>.</li>
</ol>
<p>We put <span class="math notranslate nohighlight">\(h(\mathcal{T}_h)=\max\{\textrm{diam}(T_k)|\; T_k\in \mathcal{T}_h\}\)</span>, which is obtained by</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="p">......;</span>
<span class="kt">fespace</span> <span class="nf">Ph</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span>
<span class="n">Ph</span> <span class="n">h</span> <span class="o">=</span> <span class="kr">hTriangle</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;size of mesh = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">h</span><span class="p">[].</span><span class="kr">max</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="adaptmesh">
<h3>Adaptmesh<a class="headerlink" href="#adaptmesh" title="Permalink to this headline"> </a></h3>
<p>The function:</p>
<div class="math notranslate nohighlight">
\[f(x,y) = 10.0x^3+y^3+\tan^{-1}[\varepsilon/(\sin(5.0y)-2.0x)],\ \varepsilon = 0.0001\]</div>
<p>sharply varies in value and the initial mesh given by one of the commands in the <a class="reference internal" href="#meshgeneration"><span class="std std-ref">Mesh Generation part</span></a> cannot reflect its sharp variations.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="kp">eps</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">real</span> <span class="kp">hmin</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">*</span><span class="kr">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="nf">atan2</span><span class="p">(</span><span class="kp">eps</span><span class="p">,</span> <span class="nf">sin</span><span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="kr">y</span><span class="p">)</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="kr">x</span><span class="p">);</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">fh</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fh</span><span class="p">);</span>

<span class="c1">// Adaptmesh</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fh</span><span class="p">);</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span> <span class="c1">//old mesh is deleted</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fh</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="figmeshadaptation">
<a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh1.png"><img alt="../_images/MeshGeneration_AdaptMesh1.png" src="../_images/MeshGeneration_AdaptMesh1.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 70 </span><span class="caption-text">3D graphs for the initial mesh and 1st and 2nd mesh adaptations</span></p>
</div>
<p><strong>FreeFEM</strong> uses a variable metric/Delaunay automatic meshing algorithm.</p>
<p>The command:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">ATh</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>create the new mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ATh</span></code> adapted to the Hessian</p>
<div class="math notranslate nohighlight">
\[D^2f=(\partial^2 f/\partial x^2,\, \partial^2 f/\partial x\partial y, \partial^2 f/\partial y^2)\]</div>
<p>of a function (formula or FE-function).</p>
<p>Mesh adaptation is a very powerful tool when the solution of a problem varies locally and sharply.</p>
<p>Here we solve the <a class="reference internal" href="../tutorial/poisson.html#tutorialpoisson"><span class="std std-ref">Poisson’s problem</span></a>, when <span class="math notranslate nohighlight">\(f=1\)</span> and <span class="math notranslate nohighlight">\(\Omega\)</span> is a L-shape domain.</p>
<div class="figure compound align-center" id="AdaptMesh">
<div style="width: 49%" class="subfigure" id="id24">
<span id="adaptmesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh2.png"><img alt="MeshGeneration_AdaptMesh2" src="../_images/MeshGeneration_AdaptMesh2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 71 </span><span class="caption-text">L-shape domain and its boundary name</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id25">
<span id="adaptmesh3"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh3.png"><img alt="MeshGeneration_AdaptMesh3" src="../_images/MeshGeneration_AdaptMesh3.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 72 </span><span class="caption-text">Final solution after 4-times adaptation</span></p>
</div>
<p class="caption"><span class="caption-text">Mesh adaptation</span></p>
</div><div class="admonition tip" id="AdaptMesh">
<p class="first admonition-title">Tip</p>
<p class="last">The solution has the singularity <span class="math notranslate nohighlight">\(r^{3/2},\, r=|x-\gamma|\)</span> at the point <span class="math notranslate nohighlight">\(\gamma\)</span> of the intersection of two lines <span class="math notranslate nohighlight">\(bc\)</span> and <span class="math notranslate nohighlight">\(bd\)</span> (see <a class="reference internal" href="#adaptmesh2"><span class="std std-numref">Fig. 71</span></a>).</p>
</div>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">error</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">ba</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="kp">bb</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">bc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">bd</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="kr">be</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">bf</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">ba</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="kp">bb</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">bc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">bd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="kr">be</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">bf</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="c1">// Function</span>
<span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="nf">Poisson</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span> <span class="kp">eps</span><span class="o">=</span><span class="mf">1.e-6</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">f</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Adaptmesh loop</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">Poisson</span><span class="p">;</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span><span class="n">error</span><span class="p">);</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">error</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>To speed up the adaptation, the default parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span></code> of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> is changed by hand; it specifies the required precision, so as to make the new mesh finer or coarser.</p>
<p>The problem is coercive and symmetric, so the linear system can be solved with the conjugate gradient method (parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span></code>) with the stopping criteria on the residual, here <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span><span class="mf">1.e-6</span></code>).</p>
<p>By <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code>, the slope of the final solution is correctly computed near the point of intersection of <span class="math notranslate nohighlight">\(bc\)</span> and <span class="math notranslate nohighlight">\(bd\)</span> as in <a class="reference internal" href="#adaptmesh3"><span class="std std-numref">Fig. 72</span></a>.</p>
<p>This method is described in detail in <a class="reference internal" href="../reference.html#hecht1998" id="id2">[HECHT1998]</a>.
It has a number of default parameters which can be modified.</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span></code> are functions and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">thold</span><span class="p">,</span> <span class="n">Thnew</span></code> are meshes:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>   <span class="n">Thnew</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span> <span class="n">f1</span> <span class="p">...</span> <span class="p">);</span>
   <span class="n">Thnew</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span> <span class="p">...</span> <span class="p">]);</span>
   <span class="n">Thnew</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Thold</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">]</span> <span class="p">...</span> <span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The additional parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> are:</p>
<p>See <a class="reference internal" href="../reference/functions.html#referenceadaptmesh"><span class="std std-ref">Reference part</span></a> for more inforamtions</p>
<ul>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span><span class="o">=</span></code> Minimum edge size.</dt>
<dd><p class="first last">Its default is related to the size of the domain to be meshed and the precision of the mesh generator.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span><span class="o">=</span></code> Maximum edge size.</dt>
<dd><p class="first last">It defaults to the diameter of the domain to be meshed.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\(P_1\)</span> interpolation error level (0.01 is the default).</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">errg</span><span class="o">=</span></code> Relative geometrical error.</dt>
<dd><p class="first last">By default this error is 0.01, and in any case it must be lower than <span class="math notranslate nohighlight">\(1/\sqrt{2}\)</span>.
Meshes created with this option may have some edges smaller than the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">-</span><span class="kp">hmin</span></code> due to geometrical constraints.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbvx</span><span class="o">=</span></code> Maximum number of vertices generated by the mesh generator (9000 is the default).</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbsmooth</span><span class="o">=</span></code> number of iterations of the smoothing procedure (5 is the default).</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbjacoby</span><span class="o">=</span></code> number of iterations in a smoothing procedure during the metric construction, 0 means no smoothing, 6 is the default.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span><span class="o">=</span></code> ratio for a prescribed smoothing on the metric.</dt>
<dd><p class="first">If the value is 0 or less than 1.1 no smoothing is done on the metric. 1.8 is the default.
If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span> <span class="o">&gt;</span> <span class="mf">1.1</span></code>, the speed of mesh size variations is bounded by <span class="math notranslate nohighlight">\(log(\mathtt{ratio})\)</span>.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span></code> gets closer to 1, the number of generated vertices increases.
This may be useful to control the thickness of refined regions near shocks or boundary layers.</p>
</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">omega</span><span class="o">=</span></code> relaxation parameter for the smoothing procedure. 1.0 is the default.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">iso</span><span class="o">=</span></code> If true, forces the metric to be isotropic. <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">abserror</span><span class="o">=</span></code> If false, the metric is evaluated using the criteria of equi-repartion of relative error.</dt>
<dd><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.
In this case the metric is defined by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} = \left({1\over\mathtt{err}\,\, \mathtt{coef}^2} \quad {
|\mathcal{H}| \over max(\mathtt{CutOff},|\eta|)}\right)^p\]</div>
<p>Otherwise, the metric is evaluated using the criteria of equi-distribution of errors.
In this case the metric is defined by:</p>
<div class="last math notranslate nohighlight">
\[\mathcal{M} = \left({1\over \mathtt{err}\,\,\mathtt{coef}^2} \quad
{|{\mathcal{H}|} \over
{\sup(\eta)-\inf(\eta)}}\right)^p.\label{eq err abs}\]</div>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">cutoff</span><span class="o">=</span></code> lower limit for the relative error evaluation.
1.0e-6 is the default.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span><span class="o">=</span></code> informational messages level (can be chosen between 0 and <span class="math notranslate nohighlight">\(\infty\)</span>).</dt>
<dd><p class="first last">Also changes the value of the global variable verbosity (obsolete).</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">inquire</span><span class="o">=</span></code> To inquire graphically about the mesh.
<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">splitpbedge</span><span class="o">=</span></code> If true, splits all internal edges in half with two boundary vertices.</dt>
<dd><p class="first last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">maxsubdiv</span><span class="o">=</span></code> Changes the metric such that the maximum subdivision of a background edge is bound by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">val</span></code>.</dt>
<dd><p class="first last">Always limited by 10, and 10 is also the default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">rescaling</span><span class="o">=</span></code> if true, the function, with respect to which the mesh is adapted, is rescaled to be between 0 and 1.</dt>
<dd><p class="first last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">keepbackvertices</span><span class="o">=</span></code> if true, tries to keep as many vertices from the original mesh as possible.</dt>
<dd><p class="first last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code> is the default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">IsMetric</span><span class="o">=</span></code> if true, the metric is defined explicitly.</dt>
<dd><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> is the default.
If the 3 functions <span class="math notranslate nohighlight">\(m_{11}, m_{12}, m_{22}\)</span> are given, they directly define a symmetric matrix field whose Hessian is computed to define a metric.
If only one function is given, then it represents the isotropic mesh size at every point.</p>
<p class="last">For example, if the partial derivatives <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fxx</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial x^2\)</span>), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fxy</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial x\partial y\)</span>), <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fyy</span></code> (<span class="math notranslate nohighlight">\(=\partial^2 f/\partial y^2\)</span>) are given, we can set <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">fxx</span><span class="p">,</span> <span class="n">fxy</span><span class="p">,</span> <span class="n">fyy</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="kp">hmin</span><span class="o">=</span><span class="kp">hmin</span><span class="p">);</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">power</span><span class="o">=</span></code> exponent power of the Hessian used to compute the metric.</dt>
<dd><p class="first last">1 is the default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">thetamax</span><span class="o">=</span></code> minimum corner angle in degrees.</dt>
<dd><p class="first last">Default is <span class="math notranslate nohighlight">\(10^\circ\)</span> where the corner is <span class="math notranslate nohighlight">\(ABC\)</span> and the angle is the angle of the two vectors <span class="math notranslate nohighlight">\({AB}, {BC}\)</span>, (<span class="math notranslate nohighlight">\(0\)</span> imply no corner, <span class="math notranslate nohighlight">\(90\)</span> imply perpendicular corner, …).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">splitin2</span><span class="o">=</span></code> boolean value.</dt>
<dd><p class="first last">If true, splits all triangles of the final mesh into 4 sub-triangles.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> an array of 3 real arrays to set or get metric data information.</dt>
<dd><p class="first last">The size of these three arrays must be the number of vertices.
So if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">m11</span><span class="p">,</span><span class="n">m12</span><span class="p">,</span><span class="n">m22</span></code> are three P1 finite elements related to the mesh to adapt, you can write: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span><span class="p">[</span><span class="n">m11</span><span class="p">[],</span><span class="n">m12</span><span class="p">[],</span><span class="n">m22</span><span class="p">[]]</span></code> (see file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">convect</span><span class="o">-</span><span class="n">apt</span><span class="p">.</span><span class="n">edp</span></code> for a full example)</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nomeshgeneration</span><span class="o">=</span></code> If true, no adapted mesh is generated (useful to compute only a metric).</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">periodic</span><span class="o">=</span></code> Writing <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">periodic</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="kr">y</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="kr">x</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="kr">x</span><span class="p">]];</span></code> builds an adapted periodic mesh.</dt>
<dd><p class="first last">The sample builds a biperiodic mesh of a square.
(see <a class="reference internal" href="finiteElement.html#finiteelement"><span class="std std-ref">periodic finite element spaces</span></a>, and see <a class="reference internal" href="../example/meshGeneration.html#examplesphere"><span class="std std-ref">the Sphere example</span></a> for a full example)</p>
</dd>
</dl>
</li>
</ul>
<p>We can use the command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">adaptmesh</span></code> to build a uniform mesh with a constant mesh size.
To build a mesh with a constant mesh size equal to <span class="math notranslate nohighlight">\(\frac{1}{30}\)</span> try:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">//the initial mesh</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-0.eps&quot;</span><span class="p">);</span>

<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-1.eps&quot;</span><span class="p">);</span>

<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span> <span class="c1">//More the one time du to</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">30.</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">nbvx</span><span class="o">=</span><span class="mi">10000</span><span class="p">);</span> <span class="c1">//Adaptation bound `maxsubdiv=`</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;square-2.eps&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="AdaptMesh2">
<div style="width: 49%" class="subfigure" id="id26">
<span id="adaptmesh4"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh4.png"><img alt="MeshGeneration_AdaptMesh4" src="../_images/MeshGeneration_AdaptMesh4.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 73 </span><span class="caption-text">Initial mesh</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id27">
<span id="adaptmesh5"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh5.png"><img alt="MeshGeneration_AdaptMesh5" src="../_images/MeshGeneration_AdaptMesh5.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 74 </span><span class="caption-text">First iteration</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id28">
<span id="adaptmesh6"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_AdaptMesh6.png"><img alt="MeshGeneration_AdaptMesh6" src="../_images/MeshGeneration_AdaptMesh6.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 75 </span><span class="caption-text">Last iteration</span></p>
</div>
<p class="caption"><span class="caption-text">Mesh adaptation</span></p>
</div></div>
<div class="section" id="trunc">
<span id="AdaptMesh2"></span><h3>Trunc<a class="headerlink" href="#trunc" title="Permalink to this headline"> </a></h3>
<p>Two operators have been introduced to remove triangles from a mesh or to divide them.
Operator <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">trunc</span></code> has two parameters:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets the label number of new boundary item, one by default.</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">split</span><span class="o">=</span></code> sets the level <span class="math notranslate nohighlight">\(n\)</span> of triangle splitting.</dt>
<dd>Each triangle is split in <span class="math notranslate nohighlight">\(n\times n\)</span>, one by default.</dd>
</dl>
</li>
</ul>
<p>To create the mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th3</span></code> where all triangles of a mesh <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> are split in <span class="math notranslate nohighlight">\(3{\times}3\)</span>, just write:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kp">split</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The following example construct all “trunced” meshes to the support of the basic function of the space <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Vh</span></code> (cf.&nbsp;<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span></code>), split all the triangles in <span class="math notranslate nohighlight">\(5{\times} 5\)</span>, and put a label number to <span class="math notranslate nohighlight">\(2\)</span> on a new boundary.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="c1">// Loop on all degrees of freedom</span>
<span class="kt">int</span> <span class="kr">n</span><span class="o">=</span><span class="n">u</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">u</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// The basis function i</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
    <span class="kt">mesh</span> <span class="n">Sh1</span> <span class="o">=</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nf">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1.e-10</span><span class="p">,</span> <span class="kp">split</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">Sh1</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;</span><span class="nf">trunc</span><span class="s">&quot;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&quot;.eps&quot;</span><span class="p">);</span>
    <span class="n">u</span><span class="p">[][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// reset</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="Trunc">
<div style="width: 49%" class="subfigure" id="id29">
<span id="trunc1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Trunc1.png"><img alt="MeshGeneration_Trunc1" src="../_images/MeshGeneration_Trunc1.png" style="width: 49%;" /></a>
<p class="caption"><span class="caption-number">Fig. 76 </span><span class="caption-text">Mesh of support the function P1 number 0, split in <span class="math notranslate nohighlight">\(5{\times}5\)</span></span></p>
</div>
<div style="width: 49%" class="subfigure" id="id30">
<span id="trunc6"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Trunc1.png"><img alt="MeshGeneration_Trunc1" src="../_images/MeshGeneration_Trunc1.png" style="width: 49%;" /></a>
<p class="caption"><span class="caption-number">Fig. 77 </span><span class="caption-text">Mesh of support the function P1 number 6, split in <span class="math notranslate nohighlight">\(5{\times}5\)</span></span></p>
</div>
<p class="caption"><span class="caption-text">Trunc</span></p>
</div></div>
<div class="section" id="splitmesh">
<span id="Trunc"></span><h3>Splitmesh<a class="headerlink" href="#splitmesh" title="Permalink to this headline"> </a></h3>
<p>Another way to split mesh triangles is to use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">splitmesh</span></code>, for example:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;NotSplittedMesh.eps&quot;</span><span class="p">);</span>

<span class="c1">// Splitmesh</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">splitmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;SplittedMesh.eps&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="SplitMesh">
<div style="width: 49%" class="subfigure" id="id31">
<span id="splitmesh1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_SplitMesh1.png"><img alt="MeshGeneration_SplitMesh1" src="../_images/MeshGeneration_SplitMesh1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 78 </span><span class="caption-text">Initial mesh</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id32">
<span id="splitmesh2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_SplitMesh2.png"><img alt="MeshGeneration_SplitMesh2" src="../_images/MeshGeneration_SplitMesh2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 79 </span><span class="caption-text">All left mesh triangle is split conformaly in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span></code> triangles</span></p>
</div>
<p class="caption"><span class="caption-text">Split mesh</span></p>
</div></div>
<div class="section" id="meshing-examples">
<span id="meshexamples"></span><span id="SplitMesh"></span><h3>Meshing Examples<a class="headerlink" href="#meshing-examples" title="Permalink to this headline"> </a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Two rectangles touching by a side</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">c1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">1.2</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">g</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">int</span> <span class="kr">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="nf">d</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>
<span class="kt">mesh</span> <span class="n">TH</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">c1</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="kr">n</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">TH</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;TouchSide.esp&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="naca00121">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_NACA0012_1.png"><img alt="../_images/MeshGeneration_Example_NACA0012_1.png" src="../_images/MeshGeneration_Example_NACA0012_1.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 80 </span><span class="caption-text">Two rectangles touching by a side</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>NACA0012 Airfoil</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">upper</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.17735</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.075597</span><span class="o">*</span><span class="kp">t</span> <span class="o">-</span> <span class="mf">0.212836</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.17363</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.06254</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">4</span><span class="p">);}</span>
<span class="kt">border</span> <span class="nf">lower</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span> <span class="o">=</span> <span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="p">(</span><span class="mf">0.17735</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.075597</span><span class="o">*</span><span class="kp">t</span> <span class="o">-</span> <span class="mf">0.212836</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.17363</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.06254</span><span class="o">*</span><span class="p">(</span><span class="kp">t</span><span class="o">^</span><span class="mi">4</span><span class="p">));}</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.8</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.8</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="n">upper</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="o">+</span> <span class="n">lower</span><span class="p">(</span><span class="mi">35</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;NACA0012.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="naca00122">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_NACA0012_2.png"><img alt="../_images/MeshGeneration_Example_NACA0012_2.png" src="../_images/MeshGeneration_Example_NACA0012_2.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 81 </span><span class="caption-text">NACA0012 Airfoil</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Cardioid</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="nf">cos</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">/</span><span class="n">b</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="nf">sin</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">/</span><span class="n">b</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Cardioid.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="cardioid1">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Cardioid1.png"><img alt="../_images/MeshGeneration_Example_Cardioid1.png" src="../_images/MeshGeneration_Example_Cardioid1.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 82 </span><span class="caption-text">Domain with Cardioid curve boundary</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Cassini Egg</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">)</span> <span class="p">{</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Cassini.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="cardioid2">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Cardioid2.png"><img alt="../_images/MeshGeneration_Example_Cardioid2.png" src="../_images/MeshGeneration_Example_Cardioid2.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 83 </span><span class="caption-text">Domain with Cassini egg curve boundary</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>By cubic Bezier curve</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// A cubic Bezier curve connecting two points with two control points</span>
<span class="kt">func</span> <span class="kt">real</span> <span class="nf">bzi</span><span class="p">(</span><span class="kt">real</span> <span class="n">p0</span><span class="p">,</span> <span class="kt">real</span> <span class="n">p1</span><span class="p">,</span> <span class="kt">real</span> <span class="n">q1</span><span class="p">,</span> <span class="kt">real</span> <span class="n">q2</span><span class="p">,</span> <span class="kt">real</span> <span class="kp">t</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">q1</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="kp">t</span> <span class="o">+</span> <span class="n">q2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="kp">t</span><span class="o">^</span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">p00</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">p01</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q00</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">q01</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">p11</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.9</span><span class="p">],</span> <span class="n">q10</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">],</span> <span class="n">q11</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">p21</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">q20</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span> <span class="n">q21</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">q30</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="n">q31</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">];</span>
<span class="kt">border</span> <span class="nf">G1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
    <span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">border</span> <span class="nf">G2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p01</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q10</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
    <span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p01</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q10</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">border</span> <span class="nf">G3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p11</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q20</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
    <span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p11</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q20</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">border</span> <span class="nf">G4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kr">x</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p21</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p00</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q30</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q31</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
    <span class="kr">y</span><span class="o">=</span><span class="n">bzi</span><span class="p">(</span><span class="n">p21</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p00</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q30</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q31</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kp">t</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="kr">m</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">G1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">G2</span><span class="p">(</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">G3</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">G4</span><span class="p">(</span><span class="kr">m</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Bezier.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="bezier">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Bezier.png"><img alt="../_images/MeshGeneration_Example_Bezier.png" src="../_images/MeshGeneration_Example_Bezier.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 84 </span><span class="caption-text">Boundary drawn by Bezier curves</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Section of Engine</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">6.</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>

<span class="kt">border</span> <span class="nf">L1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">a</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span> <span class="p">);}</span>
<span class="kt">border</span> <span class="nf">L3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">-</span><span class="n">b</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">border</span> <span class="nf">L4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L5</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L6</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L7</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L8</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">);}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">L1</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">L2</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">+</span> <span class="n">L3</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">L4</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">L5</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">L6</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">+</span> <span class="n">L7</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">L8</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;Engine.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="engine">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_Engine.png"><img alt="../_images/MeshGeneration_Example_Engine.png" src="../_images/MeshGeneration_Example_Engine.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 85 </span><span class="caption-text">Section of Engine</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Domain with U-shape channel</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="nf">d</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="c1">//width of U-shape</span>
<span class="kt">border</span> <span class="nf">L1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="nf">d</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">L2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="kp">B</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="nf">d</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nf">d</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="nf">d</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="nf">d</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">R</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">T</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">L1</span><span class="p">(</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">L2</span><span class="p">(</span><span class="kr">n</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="kp">B</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C3</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">T</span><span class="p">(</span><span class="kr">n</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;U-shape.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="ushape">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_UShape.png"><img alt="../_images/MeshGeneration_Example_UShape.png" src="../_images/MeshGeneration_Example_UShape.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 86 </span><span class="caption-text">Domain with U-shape channel changed by :freefem`d`</span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Domain with V-shape cut</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">dAg</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">;</span> <span class="c1">//angle of V-shape</span>
<span class="kt">border</span> <span class="nf">C</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="n">dAg</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);};</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">pa</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">pb</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">pc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">pa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="n">dAg</span><span class="p">);</span>
<span class="n">pa</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="n">dAg</span><span class="p">);</span>
<span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">);</span>
<span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="n">dAg</span><span class="p">);</span>
<span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">seg1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">];};</span>
<span class="kt">border</span> <span class="nf">seg2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pa</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">pc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="kp">t</span><span class="o">*</span><span class="n">pa</span><span class="p">[</span><span class="mi">1</span><span class="p">];};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">seg1</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">C</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="n">seg2</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;V-shape.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="vshape">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_VShape.png"><img alt="../_images/MeshGeneration_Example_VShape.png" src="../_images/MeshGeneration_Example_VShape.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 87 </span><span class="caption-text">Domain with V-shape cut changed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">dAg</span></code></span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Smiling face</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="nf">d</span><span class="o">=</span><span class="mf">0.1</span><span class="p">;</span> <span class="kt">int</span> <span class="kr">m</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="kt">real</span> <span class="n">a</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>

<span class="kt">border</span> <span class="nf">F</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>
<span class="kt">border</span> <span class="nf">E1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">E2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">;}</span>
<span class="kt">func</span> <span class="kt">real</span> <span class="nf">st</span><span class="p">(</span><span class="kt">real</span> <span class="kp">t</span><span class="p">){</span>
    <span class="k">return</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span> <span class="o">-</span> <span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">border</span> <span class="nf">C1</span><span class="p">(</span><span class="kp">t</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));}</span>
<span class="kt">border</span> <span class="nf">C2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">+</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));</span> <span class="kr">y</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="p">)</span><span class="o">+</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));}</span>
<span class="kt">border</span> <span class="nf">C3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));</span> <span class="kr">y</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="kp">t</span><span class="p">));}</span>
<span class="kt">border</span> <span class="nf">C4</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">));</span> <span class="kr">y</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nf">d</span><span class="o">*</span><span class="kp">t</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="n">st</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">));}</span>
<span class="kt">border</span> <span class="nf">C0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);}</span>

<span class="kt">mesh</span> <span class="n">Th</span><span class="o">=</span><span class="nf">buildmesh</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">C3</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">C0</span><span class="p">(</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">E1</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">E2</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="kr">m</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;SmileFace.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="smilingface">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_SmilingFace.png"><img alt="../_images/MeshGeneration_Example_SmilingFace.png" src="../_images/MeshGeneration_Example_SmilingFace.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 88 </span><span class="caption-text">Smiling face (Mouth is changeable)</span></p>
</div>
</div>
<p>. tip:: 3 points bending</p>
<blockquote>
<div><div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Square for Three-Point Bend Specimens fixed on Fix1, Fix2</span>
<span class="c1">// It will be loaded on Load.</span>
<span class="kt">real</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="kr">m</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">Left</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Bot1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Fix1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Bot2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Fix2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Bot3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Right</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="p">;</span> <span class="kr">y</span><span class="o">=-</span><span class="n">a</span><span class="o">+</span><span class="kp">t</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Top1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Load</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">c</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Top2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">-</span><span class="n">c</span><span class="p">){</span><span class="kr">x</span><span class="o">=-</span><span class="n">c</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">a</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Left</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">Bot1</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fix1</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Bot2</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Fix2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">Bot3</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">Right</span><span class="p">(</span><span class="kr">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">Top1</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Load</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Top2</span><span class="p">(</span><span class="kr">m</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;ThreePoint.eps&quot;</span><span class="p">,</span> <span class="kp">bw</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="threepoints">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Example_ThreePoints.png"><img alt="../_images/MeshGeneration_Example_ThreePoints.png" src="../_images/MeshGeneration_Example_ThreePoints.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 89 </span><span class="caption-text">Domain for three-point bending test</span></p>
</div>
</div></blockquote>
</div>
<div class="section" id="how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">
<span id="meshgenerationchangelabel"></span><h3>How to change the label of elements and border elements of a mesh<a class="headerlink" href="#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh" title="Permalink to this headline"> </a></h3>
<p>Changing the label of elements and border elements will be done using the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.
The parameters for this command line are for two dimensional and three dimensional cases:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span> <span class="o">=</span></code> is a vector of integer that contains successive pairs of the old label number to the new label number.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span> <span class="o">=</span></code> is a vector of integer that contains successive pairs of the old region number to new region number.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">flabel</span> <span class="o">=</span></code> is an integer function given the new value of the label.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">fregion</span><span class="o">=</span></code> is an integer function given the new value of the region.</li>
</ul>
<p>These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of numbers <span class="math notranslate nohighlight">\(O,N\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to change.
For example, we have :</p>
<div class="math notranslate nohighlight" id="equation-eq-org-vector-change-label">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-org-vector-change-label" title="Permalink to this equation"> </a></span>\[\begin{split}\mathtt{label} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ] \\
\mathtt{region} &amp;= [ O_{1}, N_{1}, ..., O_{n_{l}},N_{n_{l}} ]\end{split}\]</div>
<p>An example of using this function is given here:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kr">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th1</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="kt">mesh</span> <span class="n">Th2</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="kr">y</span><span class="p">]);</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r1</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="n">Th1</span> <span class="o">=</span> <span class="nf">change</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">r1</span><span class="p">);</span> <span class="c1">//change the label of Edges 2 in 0.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r2</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
<span class="n">Th2</span> <span class="o">=</span> <span class="nf">change</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">r2</span><span class="p">);</span> <span class="c1">//change the label of Edges 4 in 0.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="n">Th1</span> <span class="o">+</span> <span class="n">Th2</span><span class="p">;</span> <span class="c1">//&#39;gluing together&#39; of meshes Th1 and Th2</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;nb lab = &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mf">1.</span><span class="o">/</span><span class="kr">lenEdge</span><span class="p">)</span><span class="o">+</span><span class="nf">int1d</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="mf">1.</span><span class="o">/</span><span class="kr">lenEdge</span><span class="p">)</span>
     <span class="o">&lt;&lt;</span> <span class="s">&quot; == &quot;</span> <span class="o">&lt;&lt;</span> <span class="nf">int1d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)(</span><span class="mf">1.</span><span class="o">/</span><span class="kr">lenEdge</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; == &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="mi">10</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="kt">macro</span> <span class="nf">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">// Definition of a macro</span>

<span class="kt">solve</span> <span class="kr">P</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;*</span><span class="n">Grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span><span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><strong>“gluing” different mesh</strong> In line 17 of the previous file, the method to “gluing” different meshes of the same dimension in <strong>FreeFEM</strong> is using.
This function is the operator “+” between meshes.
The method implemented needs the point in adjacent meshes to be the same.</p>
</div>
<div class="section" id="mesh-in-three-dimensions">
<h3>Mesh in three dimensions<a class="headerlink" href="#mesh-in-three-dimensions" title="Permalink to this headline"> </a></h3>
</div>
</div>
<div class="section" id="cube">
<h2>Cube<a class="headerlink" href="#cube" title="Permalink to this headline"> </a></h2>
<p>A new function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span></code> like the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">square</span></code> in 2d is the simple way to a build cubic object, in plugin <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">msh3</span></code> (need <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span></code>).</p>
<p>The following code generates a <span class="math notranslate nohighlight">\(3\times 4 \times 5\)</span> grid in the unit cube <span class="math notranslate nohighlight">\([0, 1]^3\)</span>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>By default the labels are :</p>
<ol class="arabic simple">
<li>face <span class="math notranslate nohighlight">\(y=0\)</span>,</li>
<li>face <span class="math notranslate nohighlight">\(x=1\)</span>,</li>
<li>face <span class="math notranslate nohighlight">\(y=1\)</span>,</li>
<li>face <span class="math notranslate nohighlight">\(x=0\)</span>,</li>
<li>face <span class="math notranslate nohighlight">\(z=0\)</span>,</li>
<li>face <span class="math notranslate nohighlight">\(z=1\)</span></li>
</ol>
<p>and the region number is <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>A full example of this function to build a mesh of cube <span class="math notranslate nohighlight">\(]-1,1[^3\)</span> with face label given by <span class="math notranslate nohighlight">\((ix + 4*(iy+1) + 16*(iz+1))\)</span> where <span class="math notranslate nohighlight">\((ix, iy, iz)\)</span> are the coordinates of the barycenter of the current face, is given below.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">l6</span> <span class="o">=</span> <span class="p">[</span><span class="mi">37</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">57</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">r11</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">cube</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kr">y</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kr">z</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="kr">label</span><span class="o">=</span><span class="n">l6</span><span class="p">,</span> <span class="kp">flags</span> <span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="kr">region</span><span class="o">=</span><span class="n">r11</span><span class="p">);</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Volume = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">measure</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, border area = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">bordermeasure</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

<span class="kt">int</span> <span class="kp">err</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
    <span class="kt">real</span> <span class="n">s</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="mf">1.</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">sx</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">x</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">sy</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">sz</span> <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">i</span><span class="p">)(</span><span class="kr">z</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">ix</span> <span class="o">=</span> <span class="p">(</span><span class="n">sx</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">iy</span> <span class="o">=</span> <span class="p">(</span><span class="n">sy</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">iz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sz</span><span class="o">/</span><span class="n">s</span><span class="o">+</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">iy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
        <span class="c1">//value of ix,iy,iz =&gt; face min 0, face max 2, no face 1</span>
        <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Label = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, s = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ix</span> <span class="o">&lt;&lt;</span> <span class="n">iy</span> <span class="o">&lt;&lt;</span> <span class="n">iz</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; : &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ii</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">ii</span> <span class="p">)</span> <span class="kp">err</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">real</span> <span class="n">volr11</span> <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span><span class="n">r11</span><span class="p">)(</span><span class="mf">1.</span><span class="p">);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Volume region = &quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">volr11</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="k">if</span><span class="p">((</span><span class="n">volr11</span> <span class="o">-</span> <span class="n">Th</span><span class="p">.</span><span class="kr">measure</span> <span class="p">)</span><span class="o">&gt;</span><span class="mf">1e-8</span><span class="p">)</span> <span class="kp">err</span><span class="o">++</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">false</span><span class="p">);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Nb err = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">err</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="nf">assert</span><span class="p">(</span><span class="kp">err</span><span class="o">==</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The output of this script is:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nl">Enter</span><span class="o">:</span> <span class="nl">BuildCube</span><span class="o">:</span> <span class="mi">3</span>
  <span class="n">kind</span> <span class="o">=</span> <span class="mi">3</span> <span class="kr">n</span> <span class="n">tet</span> <span class="n">Cube</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">/</span> <span class="kr">n</span> <span class="n">slip</span> <span class="mi">6</span> <span class="mi">19</span>
<span class="n">Cube</span>  <span class="kr">nv</span><span class="o">=</span><span class="mi">210</span> <span class="kr">nt</span><span class="o">=</span><span class="mi">720</span> <span class="kr">nbe</span><span class="o">=</span><span class="mi">296</span>
<span class="nl">Out</span><span class="o">:</span>  <span class="n">BuildCube</span>
<span class="n">Volume</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="kt">border</span> <span class="kr">area</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">110</span> <span class="o">:</span> <span class="mi">25</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">101</span> <span class="o">:</span> <span class="mi">37</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mo">011</span> <span class="o">:</span> <span class="mi">40</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">211</span> <span class="o">:</span> <span class="mi">42</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">121</span> <span class="o">:</span> <span class="mi">45</span>
<span class="n">Label</span> <span class="o">=</span> <span class="mi">57</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span> <span class="mi">112</span> <span class="o">:</span> <span class="mi">57</span>
<span class="n">Volume</span> <span class="kr">region</span> <span class="o">=</span> <span class="mi">11</span><span class="o">:</span> <span class="mi">8</span>
<span class="n">Nb</span> <span class="kp">err</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</td></tr></table></div>
<div class="figure" id="meshgeneration-cube">
<a class="reference internal image-reference" href="../_images/MeshGeneration_Cube.jpg"><img alt="../_images/MeshGeneration_Cube.jpg" src="../_images/MeshGeneration_Cube.jpg" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 90 </span><span class="caption-text">The mesh 3d of function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kp">flags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code></span></p>
</div>
</div>
<div class="section" id="read-write-statements-for-a-mesh-in-3d">
<span id="meshreadwrite3d"></span><h2>Read/Write Statements for a Mesh in 3D<a class="headerlink" href="#read-write-statements-for-a-mesh-in-3d" title="Permalink to this headline"> </a></h2>
<p>In three dimensions, the file mesh format supported for input and output files by <strong>FreeFEM</strong> are the extension .msh and .mesh.
These formats are described in the <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
<p><strong>Extension file .msh</strong> The structure of the files with extension .msh in 3D is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cccccc}
    n_v &amp; n_{tet} &amp; n_{tri} &amp; &amp; \\
    q^1_x &amp; q^1_y &amp; q^1_z &amp; Vertex label &amp; \\
    q^2_x &amp; q^2_y &amp; q^2_z &amp; Vertex label &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\
    q^{n_v}_x &amp; q^{n_v}_y &amp; q^{n_v}_z &amp; Vertex label &amp; \\
    1_1 &amp; 1_2 &amp; 1_3 &amp; 1_4 &amp; region label \\
    2_1 &amp; 2_2 &amp; 2_3 &amp; 2_4 &amp; region label \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    (n_{tet})_1 &amp; (n_{tet})_2 &amp; (n_{tet})_3 &amp; (n_{tet})_4 &amp; region label \\
    1_1 &amp; 1_2 &amp; 1_3 &amp; boundary label &amp; \\
    2_1 &amp; 2_2 &amp; 2_3 &amp; boundary label &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \\
    (n_tri)_{1} &amp; (n_{tri})_2 &amp; (n_{tri})_3 &amp; boundary label &amp; \\
\end{array}\end{split}\]</div>
<p>In this structure, <span class="math notranslate nohighlight">\(n_v\)</span> denotes the number of vertices, <span class="math notranslate nohighlight">\(n_{tet}\)</span> the number of tetrahedra and <span class="math notranslate nohighlight">\(n_{tri}\)</span> the number of triangles.</p>
<p>For each vertex <span class="math notranslate nohighlight">\(q^i,\, i=1,\cdots,n_v\)</span>, we denote by <span class="math notranslate nohighlight">\((q^i_x,q^i_y,q^i_z)\)</span> the <span class="math notranslate nohighlight">\(x\)</span>-coordinate, the <span class="math notranslate nohighlight">\(y\)</span>-coordinate and the <span class="math notranslate nohighlight">\(z\)</span>-coordinate.</p>
<p>Each tetrahedra <span class="math notranslate nohighlight">\(T_k, k=1,\cdots,n_{tet}\)</span> has four vertices <span class="math notranslate nohighlight">\(q^{k_1},\, q^{k_2},\,q^{k_3}, \,q^{k_4}\)</span>.</p>
<p>The boundary consists of a union of triangles.
Each triangle <span class="math notranslate nohighlight">\(be_j, j=1,\cdots,n_{tri}\)</span> has three vertices <span class="math notranslate nohighlight">\(q^{j_1},\, q^{j_2},\,q^{j_3}\)</span>.</p>
<p><strong>extension file .mesh</strong> The data structure for a three dimensional mesh is composed of the data structure presented in <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a> and a data structure for the tetrahedra. The tetrahedra of a three dimensional mesh are referred using the following field:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>Tetrahedra
NbTetrahedra
Vertex1 Vertex2 Vertex3 Vertex4 Label
...
Vertex1 Vertex2 Vertex3 Vertex4 Label
</pre></div>
</td></tr></table></div>
<p>This field is express with the notation of <a class="reference internal" href="developers.html#meshfiledatastructure"><span class="std std-ref">Mesh Format section</span></a>.</p>
</div>
<div class="section" id="tetgen-a-tetrahedral-mesh-generator">
<h2>TetGen: A tetrahedral mesh generator<a class="headerlink" href="#tetgen-a-tetrahedral-mesh-generator" title="Permalink to this headline"> </a></h2>
<p><strong>TetGen</strong></p>
<p>TetGen is a software developed by Dr.&nbsp;Hang Si of Weierstrass Institute for Applied Analysis and Stochastics in Berlin, Germany <a class="reference internal" href="../reference.html#hang2006" id="id3">[HANG2006]</a>.
TetGen is free for research and non-commercial use.
For any commercial license utilization, a commercial license is available upon request to Hang Si.</p>
<p>This software is a tetrahedral mesh generator of a three dimensional domain defined by its boundary.
The input domain takes into account a polyhedral or a piecewise linear complex.
This tetrahedralization is a constrained Delaunay tetrahedralization.</p>
<p>The method used in TetGen to control the quality of the mesh is a Delaunay refinement due to Shewchuk <a class="reference internal" href="../reference.html#shewchuk1998" id="id4">[SHEWCHUK1998]</a>.
The quality measure of this algorithm is the Radius-Edge Ratio (see Section 1.3.1 <a class="reference internal" href="../reference.html#hang2006" id="id5">[HANG2006]</a> for more details).
A theoretical bound of this ratio of the Shewchuk algorithm is obtained for a given complex of vertices, constrained segments and facets of surface mesh, with no input angle less than 90 degrees.
This theoretical bound is 2.0.</p>
<p>The launch of TetGen is done with the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code>.
The parameters of this command line is:</p>
<ul>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span><span class="o">=</span></code> sets the label of tetrahedra.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> is a vector of integers that contains the old labels number at index <span class="math notranslate nohighlight">\(2i\)</span> and the new labels number at index <span class="math notranslate nohighlight">\(2i+1\)</span> of Triangles.</dt>
<dd><p class="first last">This parameter is initialized as a label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code> A string expression.</dt>
<dd><p class="first last">This string corresponds to the command line switch of TetGen see Section 3.2 of <a class="reference internal" href="../reference.html#hang2006" id="id6">[HANG2006]</a>.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofholes</span><span class="o">=</span></code> Number of holes (default value: “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span></code> / 3”).</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">holelist</span></code> of TetGenio data structure <a class="reference internal" href="../reference.html#hang2006" id="id7">[HANG2006]</a>.</dt>
<dd><p class="first last">A real vector of size <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">3</span> <span class="o">*</span> <span class="kp">nbofholes</span></code>.
In TetGen, each hole is associated with a point inside this domain.
This vector is <span class="math notranslate nohighlight">\(x_{1}^{h}, y_{1}^{h}, z_{1}^{h}, x_{2}^{h}, y_{2}^{h}, z_{2}^{h}, \cdots,\)</span> where <span class="math notranslate nohighlight">\(x_{i}^{h},y_{i}^{h},z_{i}^{h}\)</span> is the associated point with the <span class="math notranslate nohighlight">\(i^{\mathrm{th}}\)</span> hole.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span><span class="o">=</span></code> Number of regions (default value: “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> / 5”).</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> of TetGenio data structure <a class="reference internal" href="../reference.html#hang2006" id="id8">[HANG2006]</a>.</p>
<p>The attribute and the volume constraint of region are given in this real vector of size <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">5</span> <span class="o">*</span> <span class="kp">nbofregions</span></code>.
The <span class="math notranslate nohighlight">\(i^{\mathrm{th}}\)</span> region is described by five elements: <span class="math notranslate nohighlight">\(x-\)</span>coordinate, <span class="math notranslate nohighlight">\(y-\)</span>coordinate and <span class="math notranslate nohighlight">\(z-\)</span>coordinate of a point inside this domain (<span class="math notranslate nohighlight">\(x_{i},y_{i},z_{i}\)</span>); the attribute (<span class="math notranslate nohighlight">\(at_{i}\)</span>) and the maximum volume for tetrahedra (<span class="math notranslate nohighlight">\(mvol_{i}\)</span>) for this region.</p>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> vector is: <span class="math notranslate nohighlight">\(x_{1}, y_{1}, z_{1}, at_{1}, mvol_{1}, x_{2}, y_{2}, z_{2}, at_{2}, mvol_{2}, \cdots\)</span>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span><span class="o">=</span></code> Number of facets constraints “size of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> / 2”).</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span><span class="o">=</span></code> This array corresponds to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">facetconstraintlist</span></code> of TetGenio data structure <a class="reference internal" href="../reference.html#hang2006" id="id9">[HANG2006]</a>.</p>
<p>The <span class="math notranslate nohighlight">\(i^{th}\)</span> facet constraint is defined by the facet marker <span class="math notranslate nohighlight">\(Ref_{i}^{fc}\)</span> and the maximum area for faces <span class="math notranslate nohighlight">\(marea_{i}^{fc}\)</span>.
The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> array is: <span class="math notranslate nohighlight">\(Ref_{1}^{fc}, marea_{1}^{fc}, Ref_{2}^{fc}, marea_{2}^{fc}, \cdots\)</span>.</p>
<p>This parameters has no effect if switch <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> is not selected.</p>
</li>
</ul>
<p>Principal switch parameters in TetGen:</p>
<ul>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> Tetrahedralization of boundary.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> Quality mesh generation.</dt>
<dd><p class="first last">The bound of Radius-Edge Ratio will be given after the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code>.
By default, this value is 2.0.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span></code> Constructs with the volume constraints on tetrahedra.</dt>
<dd><p class="first last">These volumes constraints are defined with the bound of the previous switch <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> or in the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">A</span></code> Attributes reference to region given in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>.</dt>
<dd><p class="first last">The other regions have label 0.</p>
</dd>
</dl>
<p>The option <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">AA</span></code> gives a different label at each region.
This switch works with the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code>.
If option :freefem`r` is used, this switch has no effect.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> Reconstructs and Refines a previously generated mesh.</dt>
<dd><p class="first last">This character is only used with the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgreconstruction</span></code>.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Y</span></code> This switch preserves the mesh on the exterior boundary.</p>
<p>This switch must be used to ensure a conformal mesh between two adjacent meshes.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">YY</span></code> This switch preserves the mesh on the exterior and interior boundary.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">C</span></code> The consistency of the result’s mesh is testing by TetGen.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">CC</span></code> The consistency of the result’s mesh is testing by TetGen and also constrained checks of Delaunay mesh (if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> switch is selected) or the consistency of Conformal Delaunay (if <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> switch is selected).</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">V</span></code> Give information of the work of TetGen.</dt>
<dd><p class="first last">More information can be obtained in specified <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">VV</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">VVV</span></code>.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Q</span></code> Quiet: No terminal output except errors</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">M</span></code> The coplanar facets are not merging.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">T</span></code> Sets a tolerance for coplanar test.</dt>
<dd><p class="first last">The default value is <span class="math notranslate nohighlight">\(1e-8\)</span>.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">d</span></code> Intersections of facets are detected.</p>
</li>
</ul>
<p>To obtain a tetrahedral mesh with TetGen, we need the surface mesh of a three dimensional domain.
We now give the command line in <strong>FreeFEM</strong> to construct these meshes.</p>
<p><strong>keyword: movemesh23</strong></p>
<p>A simple method to construct a surface is to place a two dimensional domain in a three dimensional space.
This corresponds to moving the domain by a displacement vector of this form <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = (\Phi1(x,y), \Phi2(x,y), \Phi3(x,y))\)</span>.</p>
<p>The result of moving a two dimensional mesh Th2 by this three dimensional displacement is obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)]);</span>
</pre></div>
</td></tr></table></div>
<p>The parameters of this command line are:</p>
<ul>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span><span class="o">=</span></code> [<span class="math notranslate nohighlight">\(\Phi 1\)</span>, <span class="math notranslate nohighlight">\(\Phi 2\)</span>, <span class="math notranslate nohighlight">\(\Phi 3\)</span>] sets the displacement vector of transformation <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = [\Phi1(x,y), \Phi2(x,y), \Phi3(x,y)]\)</span>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets an integer label of triangles.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span><span class="o">=</span></code> sets an integer orientation of mesh.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span><span class="o">=</span></code> A real expression.</dt>
<dd><p class="first">When you transform a mesh, some points can be merged.
This parameter is the criteria to define two merging points.
By default, we use</p>
<div class="last math notranslate nohighlight">
\[ptmerge \: = \: 1e-7 \: \:Vol( B ),\]</div>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the smallest axis, parallel boxes containing the discretized domain of <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Vol(B)\)</span> is the volume of this box.</p>
</li>
</ul>
<p>We can do a “gluing” of surface meshes using the process given in <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">Change section</span></a>.
An example to obtain a three dimensional mesh using the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> is given below.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;tetgen&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">x10</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">x11</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y10</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y11</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">ZZ1min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">ZZ1max</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">XX1</span> <span class="o">=</span> <span class="kr">x</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">YY1</span> <span class="o">=</span> <span class="kr">y</span><span class="p">;</span>

<span class="kt">real</span> <span class="n">x20</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">x21</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y20</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y21</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">ZZ2</span> <span class="o">=</span> <span class="kr">y</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">XX2</span> <span class="o">=</span> <span class="kr">x</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">YY2min</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">YY2max</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>

<span class="kt">real</span> <span class="n">x30</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">x31</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y30</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">y31</span><span class="o">=</span><span class="mf">1.5</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">XX3min</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">XX3max</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">YY3</span> <span class="o">=</span> <span class="kr">x</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">ZZ3</span> <span class="o">=</span> <span class="kr">y</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Thsq1</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="p">[</span><span class="n">x10</span><span class="o">+</span><span class="p">(</span><span class="n">x11</span><span class="o">-</span><span class="n">x10</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="n">y10</span><span class="o">+</span><span class="p">(</span><span class="n">y11</span><span class="o">-</span><span class="n">y10</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="kt">mesh</span> <span class="n">Thsq2</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="n">x20</span><span class="o">+</span><span class="p">(</span><span class="n">x21</span><span class="o">-</span><span class="n">x20</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="n">y20</span><span class="o">+</span><span class="p">(</span><span class="n">y21</span><span class="o">-</span><span class="n">y20</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
<span class="kt">mesh</span> <span class="n">Thsq3</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="n">x30</span><span class="o">+</span><span class="p">(</span><span class="n">x31</span><span class="o">-</span><span class="n">x30</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="n">y30</span><span class="o">+</span><span class="p">(</span><span class="n">y31</span><span class="o">-</span><span class="n">y30</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

<span class="c1">// Mesh 2D to 3D surface</span>
<span class="kt">mesh3</span> <span class="n">Th31h</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq1</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span> <span class="n">YY1</span><span class="p">,</span> <span class="n">ZZ1max</span><span class="p">]);</span>
<span class="kt">mesh3</span> <span class="n">Th31b</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq1</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span> <span class="n">YY1</span><span class="p">,</span> <span class="n">ZZ1min</span><span class="p">]);</span>

<span class="kt">mesh3</span> <span class="n">Th32h</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq2</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX2</span><span class="p">,</span> <span class="n">YY2max</span><span class="p">,</span> <span class="n">ZZ2</span><span class="p">]);</span>
<span class="kt">mesh3</span> <span class="n">Th32b</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq2</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX2</span><span class="p">,</span> <span class="n">YY2min</span><span class="p">,</span> <span class="n">ZZ2</span><span class="p">]);</span>

<span class="kt">mesh3</span> <span class="n">Th33h</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq3</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX3max</span><span class="p">,</span> <span class="n">YY3</span><span class="p">,</span> <span class="n">ZZ3</span><span class="p">]);</span>
<span class="kt">mesh3</span> <span class="n">Th33b</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thsq3</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX3min</span><span class="p">,</span> <span class="n">YY3</span><span class="p">,</span> <span class="n">ZZ3</span><span class="p">]);</span>

<span class="c1">// Gluing surfaces</span>
<span class="kt">mesh3</span> <span class="n">Th33</span> <span class="o">=</span> <span class="n">Th31h</span> <span class="o">+</span> <span class="n">Th31b</span> <span class="o">+</span> <span class="n">Th32h</span> <span class="o">+</span> <span class="n">Th32b</span> <span class="o">+</span> <span class="n">Th33h</span> <span class="o">+</span> <span class="n">Th33b</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th33</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Th33&quot;</span><span class="p">);</span>

<span class="c1">// Tetrahelize the interior of the cube with TetGen</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="kr">pi</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mf">0.0025</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Thfinal</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">Th33</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQY&quot;</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Thfinal</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Thfinal&quot;</span><span class="p">);</span>

<span class="c1">// Build a mesh of a half cylindrical shell of interior radius 1, and exterior radius 2 and a height of 1.5</span>
<span class="kt">func</span> <span class="n">mv2x</span> <span class="o">=</span> <span class="kr">x</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">mv2y</span> <span class="o">=</span> <span class="kr">x</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">mv2z</span> <span class="o">=</span> <span class="kr">z</span><span class="p">;</span>
<span class="kt">mesh3</span> <span class="n">Thmv2</span> <span class="o">=</span> <span class="n">movemesh3</span><span class="p">(</span><span class="n">Thfinal</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">mv2x</span><span class="p">,</span> <span class="n">mv2y</span><span class="p">,</span> <span class="n">mv2z</span><span class="p">]);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Thmv2</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot;Thmv2&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The command <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">movemesh3</span></code> is described in the following section.</p>
<p><strong>The keyword tetgtransfo</strong></p>
<p>This keyword corresponds to a composition of command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">tetgtransfo</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)]),</span> <span class="p">...)</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">Th3surf</span><span class="p">,</span> <span class="p">...),</span>
</pre></div>
</td></tr></table></div>
<p>where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th3surf</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">Phi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th2</span></code> is the input two dimensional mesh of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgtransfo</span></code>.</p>
<p>The parameters of this command line are, on one hand, the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> of keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code> and on the other hand, the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span></code> of keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgtransfo</span></code>, the result’s mesh of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh23</span></code> must be a closed surface and define one region only. Therefore, the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> is defined for one region.</p>
<p class="last">An example of this keyword can be found in line 61 of the <a class="reference internal" href="../example/meshGeneration.html#examplebuildlayermesh"><span class="std std-ref">Build layer mesh example</span></a>.</p>
</div>
<p><strong>The keyword tetgconvexhull</strong></p>
<p><strong>FreeFEM</strong>, using TetGen, is able to build a tetrahedralization from a set of points.
This tetrahedralization is a Delaunay mesh of the convex hull of the set of points.</p>
<p>The coordinates of the points can be initialized in two ways.
The first is a file that contains the coordinate of points <span class="math notranslate nohighlight">\(X_{i}=(x_{i}, y_{i}, z_{i})\)</span>.
This file is organized as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccc}
n_{v} &amp; &amp; \\
x_{1} &amp; y_{1} &amp; z_{1} \\
x_{2} &amp; y_{2} &amp; z_{2} \\
\vdots &amp;\vdots &amp; \vdots \\
x_{n_v} &amp; y_{n_v} &amp; z_{n_v}
\end{array}\end{split}\]</div>
<p>The second way is to give three arrays that correspond respectively to the <span class="math notranslate nohighlight">\(x-\)</span>coordinates, <span class="math notranslate nohighlight">\(y-\)</span>coordinates and <span class="math notranslate nohighlight">\(z-\)</span>coordinates.</p>
<p>The parameters of this command line are :</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code> A string expression.</dt>
<dd>This string corresponds to the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code> of TetGen see Section 3.2 of <a class="reference internal" href="../reference.html#hang2006" id="id10">[HANG2006]</a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span><span class="o">=</span></code> An integer expression.</dt>
<dd>Set the label of tetrahedra.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> An integer expression.</dt>
<dd>Set the label of triangles.</dd>
</dl>
</li>
</ul>
<p>In the string <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, we can’t used the option <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">q</span></code> of TetGen.</p>
</div>
<div class="section" id="reconstruct-refine-a-three-dimensional-mesh-with-tetgen">
<h2>Reconstruct/Refine a three dimensional mesh with TetGen<a class="headerlink" href="#reconstruct-refine-a-three-dimensional-mesh-with-tetgen" title="Permalink to this headline"> </a></h2>
<p>Meshes in three dimension can be refined using TetGen with the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetgreconstruction</span></code>.</p>
<p>The parameter of this keyword are</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> an integer array that changes the region number of tetrahedra.</dt>
<dd>This array is defined as the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">reftet</span></code> in the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> an integer array that changes the label of boundary triangles.</dt>
<dd>This array is defined as the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span></code> in the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">change</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sizeofvolume</span><span class="o">=</span></code> a reel function.</dt>
<dd>This function constraints the volume size of the tetrahedra in the domain (see <a class="reference internal" href="#meshfirstisotropemeshadaptation"><span class="std std-ref">Isotrope mesh adaption section</span></a> to build a 3d adapted mesh).</dd>
</dl>
</li>
</ul>
<p>The parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nboffacetcl</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facetcl</span></code> of the command line which call TetGen (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">tetg</span></code>) is used for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">tetgrefine</span></code>.</p>
<p>In the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">switch</span><span class="o">=</span></code>, the character <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> should be used without the character <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">p</span></code>.</p>
<p>For instance, see the manual of TetGen <a class="reference internal" href="../reference.html#hang2006" id="id11">[HANG2006]</a> for effect of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">r</span></code> to other character.</p>
<p>The parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> defines a new volume constraint in the region.
The label in the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">regionlist</span></code> will be the previous label of region.</p>
<p>This parameter and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbofregions</span></code> can’t be used with the parameter <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sizeofvolume</span></code>.</p>
<p><strong>Example refinesphere.edp</strong></p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span> <span class="c1">// $]-pi/2, pi/2[X]0, 2pi[ $</span>

<span class="c1">// A parametrization of a sphere</span>
<span class="kt">func</span> <span class="n">f1</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="c1">// Partial derivative of the parametrization DF</span>
<span class="kt">func</span> <span class="n">f1x</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f1y</span> <span class="o">=</span> <span class="o">-</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2x</span> <span class="o">=</span> <span class="o">-</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2y</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3x</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">// M = DF^t DF</span>
<span class="kt">func</span> <span class="n">m11</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">m21</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">m22</span> <span class="o">=</span> <span class="n">f1y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>

<span class="c1">// Mesh adaptation</span>
<span class="kt">func</span> <span class="n">perio</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kr">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="kr">x</span><span class="p">]];</span>
<span class="kt">real</span> <span class="n">hh</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">vv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
<span class="kr">verbosity</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="c1">// Construction of the surface of spheres</span>
<span class="kt">real</span> <span class="n">Rmin</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f1min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f2min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f3min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>

<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1min</span><span class="p">,</span> <span class="n">f2min</span><span class="p">,</span> <span class="n">f3min</span><span class="p">]);</span>

<span class="c1">// Contruct the volume</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th3sph</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>

<span class="c1">// Refine</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">newlabel</span> <span class="o">=</span> <span class="p">[</span><span class="mi">145</span><span class="p">,</span> <span class="mi">18</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domainrefine</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th3sphrefine</span> <span class="o">=</span> <span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3sph</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span> <span class="kp">reftet</span><span class="o">=</span><span class="n">newlabel</span><span class="p">,</span>
    <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> <span class="kp">sizeofvolume</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">);</span>

<span class="c1">// Re-Refine</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">newlabel2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">145</span><span class="p">,</span> <span class="mi">53</span><span class="p">];</span>
<span class="kt">func</span> <span class="n">fsize</span> <span class="o">=</span> <span class="mf">0.01</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">((</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">z</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">Th3sphrefine2</span> <span class="o">=</span> <span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3sph</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span> <span class="kp">reftet</span><span class="o">=</span><span class="n">newlabel2</span><span class="p">,</span>
    <span class="kp">sizeofvolume</span><span class="o">=</span><span class="n">fsize</span><span class="p">);</span>

<span class="c1">// Medit</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphere&quot;</span><span class="p">,</span> <span class="n">Th3sph</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;isotroperefine&quot;</span><span class="p">,</span> <span class="n">Th3sphrefine</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;anisotroperefine&quot;</span><span class="p">,</span> <span class="n">Th3sphrefine2</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="moving-mesh-in-three-dimensions">
<h2>Moving mesh in three dimensions<a class="headerlink" href="#moving-mesh-in-three-dimensions" title="Permalink to this headline"> </a></h2>
<p>Meshes in three dimensions can be translated, rotated, and deformed using the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code> as in the 2D case (see <a class="reference internal" href="#meshgenerationmovemesh"><span class="std std-ref">section movemesh</span></a>).
If <span class="math notranslate nohighlight">\(\Omega\)</span> is tetrahedrized as <span class="math notranslate nohighlight">\(T_{h}(\Omega)\)</span>, and <span class="math notranslate nohighlight">\(\Phi(x,y)=(\Phi1(x,y,z), \Phi2(x,y,z), \Phi3(x,y,z))\)</span> is a displacement vector then <span class="math notranslate nohighlight">\(\Phi(T_{h})\)</span> is obtained by:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="n">Phi1</span><span class="p">,</span> <span class="n">Phi2</span><span class="p">,</span> <span class="n">Phi3</span><span class="p">],</span> <span class="p">...);</span>
</pre></div>
</td></tr></table></div>
<p>The parameters of movemesh in three dimensions are:</p>
<ul>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> sets the integer labels of the tetrahedra.</dt>
<dd><p class="first last">0 by default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">label</span><span class="o">=</span></code> sets the labels of the border faces.</dt>
<dd><p class="first last">This parameter is initialized as the label for the keyword <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facemerge</span><span class="o">=</span></code> An integer expression.</dt>
<dd><p class="first last">When you transform a mesh, some faces can be merged.
This parameter equals to one if the merges’ faces is considered.
Otherwise it equals to zero.
By default, this parameter is equal to 1.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span> <span class="o">=</span></code> A real expression.</dt>
<dd><p class="first">When you transform a mesh, some points can be merged.
This parameter is the criteria to define two merging points.
By default, we use</p>
<div class="last math notranslate nohighlight">
\[ptmerge \: = \: 1e-7 \: \:Vol( B ),\]</div>
</dd>
</dl>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the smallest axis parallel boxes containing the discretion domain of <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Vol(B)\)</span> is the volume of this box.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">orientation</span> <span class="o">=</span></code> An integer expression (1 by default), to reverse or not to reverse the orientation of the tetrahedra if it is not positive.</p>
</li>
</ul>
<p>An example of this command can be found in the <a class="reference internal" href="../example/misc.html#examplepoissonequation3d"><span class="std std-ref">Poisson’s equation 3D example</span></a>.</p>
</div>
<div class="section" id="layer-mesh">
<h2>Layer mesh<a class="headerlink" href="#layer-mesh" title="Permalink to this headline"> </a></h2>
<p>In this section, we present the command line to obtain a Layer mesh: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildlayers</span></code>.
This mesh is obtained by extending a two dimensional mesh in the <span class="math notranslate nohighlight">\(z\)</span>-axis.</p>
<p>The domain <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span> defined by the layer mesh is equal to <span class="math notranslate nohighlight">\(\Omega_{3d} = \Omega_{2d} \times [zmin, zmax]\)</span> where <span class="math notranslate nohighlight">\(\Omega_{2d}\)</span> is the domain defined by the two dimensional meshes.
<span class="math notranslate nohighlight">\(zmin\)</span> and <span class="math notranslate nohighlight">\(zmax\)</span> are functions of <span class="math notranslate nohighlight">\(\Omega_{2d}\)</span> in <span class="math notranslate nohighlight">\(\R\)</span> that defines respectively the lower surface and upper surface of <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span>.</p>
<div class="figure" id="meshgenerationlayermesh">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh.png"><img alt="../_images/MeshGeneration_LayerMesh.png" src="../_images/MeshGeneration_LayerMesh.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 91 </span><span class="caption-text">Example of Layer mesh in three dimensions.</span></p>
</div>
<p>For a vertex of a two dimensional mesh <span class="math notranslate nohighlight">\(V_{i}^{2d} = (x_{i},y_{i})\)</span>, we introduce the number of associated vertices in the <span class="math notranslate nohighlight">\(z-\)</span>axis <span class="math notranslate nohighlight">\(M_{i}+1\)</span>.</p>
<p>We denote by <span class="math notranslate nohighlight">\(M\)</span> the maximum of <span class="math notranslate nohighlight">\(M_{i}\)</span> over the vertices of the two dimensional mesh.
This value is called the number of layers (if <span class="math notranslate nohighlight">\(\forall i, \; M_{i}=M\)</span> then there are <span class="math notranslate nohighlight">\(M\)</span> layers in the mesh of <span class="math notranslate nohighlight">\(\Omega_{3d}\)</span>).
<span class="math notranslate nohighlight">\(V_{i}^{2d}\)</span> generated <span class="math notranslate nohighlight">\(M+1\)</span> vertices which are defined by:</p>
<div class="math notranslate nohighlight">
\[\forall j=0, \ldots, M, \quad V_{i,j}^{3d} = ( x_{i}, y_{i}, \theta_{i}(z_{i,j}) ),\]</div>
<p>where <span class="math notranslate nohighlight">\((z_{i,j})_{j=0,\ldots,M}\)</span> are the <span class="math notranslate nohighlight">\(M+1\)</span> equidistant points on the interval <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d})]\)</span>:</p>
<div class="math notranslate nohighlight">
\[z_{i,j} = j \: \delta \alpha + zmin(V_{i}^{2d}), \quad \delta \alpha= \frac{ zmax( V_{i}^{2d} ) - zmin( V_{i}^{2d}) }{M}.\]</div>
<p>The function <span class="math notranslate nohighlight">\(\theta_{i}\)</span>, defined on <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d} )]\)</span>, is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta_{i}(z) = \left \{
\begin{array}{cl}
\theta_{i,0} &amp; \mbox{if} \: z=zmin(V_{i}^{2d}), \\
\theta_{i,j} &amp; \mbox{if} \: z \in ] \theta_{i,j-1}, \theta_{i,j}],\\
\end{array}
\right.\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\((\theta_{i,j})_{j=0,\ldots,M_{i}}\)</span> are the <span class="math notranslate nohighlight">\(M_{i}+1\)</span> equidistant points on the interval <span class="math notranslate nohighlight">\([zmin( V_{i}^{2d} ), zmax( V_{i}^{2d} )]\)</span>.</p>
<p>Set a triangle <span class="math notranslate nohighlight">\(K=(V_{i1}^{2d}\)</span>, <span class="math notranslate nohighlight">\(V_{i2}^{2d}\)</span>, <span class="math notranslate nohighlight">\(V_{i3}^{2d})\)</span> of the two dimensional mesh.
<span class="math notranslate nohighlight">\(K\)</span> is associated with a triangle on the upper surface (resp. on the lower surface) of layer mesh:</p>
<p><span class="math notranslate nohighlight">\(( V_{i1,M}^{3d}, V_{i2,M}^{3d}, V_{i3,M}^{3d} )\)</span> (resp. <span class="math notranslate nohighlight">\(( V_{i1,0}^{3d}, V_{i2,0}^{3d}, V_{i3,0}^{3d})\)</span>).</p>
<p>Also <span class="math notranslate nohighlight">\(K\)</span> is associated with <span class="math notranslate nohighlight">\(M\)</span> volume prismatic elements which are defined by:</p>
<div class="math notranslate nohighlight">
\[\forall j=0,\ldots,M, \quad H_{j} = ( V_{i1,j}^{3d}, V_{i2,j}^{3d}, V_{i3,j}^{3d}, V_{i1,j+1}^{3d}, V_{i2,j+1}^{3d}, V_{i3,j+1}^{3d} ).\]</div>
<p>Theses volume elements can have some merged point:</p>
<ul class="simple">
<li>0 merged point : prism</li>
<li>1 merged points : pyramid</li>
<li>2 merged points : tetrahedra</li>
<li>3 merged points : no elements</li>
</ul>
<p>The elements with merged points are called degenerate elements.
To obtain a mesh with tetrahedra, we decompose the pyramid into two tetrahedra and the prism into three tetrahedra.
These tetrahedra are obtained by cutting the quadrilateral face of pyramid and prism with the diagonal which have the vertex with the maximum index (see <a class="reference internal" href="../reference.html#hecht1992" id="id12">[HECHT1992]</a> for the reason of this choice).</p>
<p>The triangles on the middle surface obtained with the decomposition of the volume prismatic elements are the triangles generated by the edges on the border of the two dimensional mesh.
The label of triangles on the border elements and tetrahedra are defined with the label of these associated elements.</p>
<p>The arguments of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildlayers</span></code> is a two dimensional mesh and the number of layers <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The parameters of this command are:</p>
<ul>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">zbound</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\([zmin,zmax]\)</span> where <span class="math notranslate nohighlight">\(zmin\)</span> and <span class="math notranslate nohighlight">\(zmax\)</span> are functions expression.</dt>
<dd><p class="first last">Theses functions define the lower surface mesh and upper mesh of surface mesh.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">coef</span><span class="o">=</span></code> A function expression between [0,1].</dt>
<dd><p class="first last">This parameter is used to introduce degenerate element in mesh.</p>
</dd>
</dl>
<p>The number of associated points or vertex <span class="math notranslate nohighlight">\(V_{i}^{2d}\)</span> is the integer part of <span class="math notranslate nohighlight">\(coef(V_{i}^{2d}) M\)</span>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span><span class="o">=</span></code> This vector is used to initialize the region of tetrahedra.</p>
<p>This vector contains successive pairs of the 2d region number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d region number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelmid</span><span class="o">=</span></code> This vector is used to initialize the 3d labels number of the vertical face or mid face from the 2d label number.</p>
<p>This vector contains successive pairs of the 2d label number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d label number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelup</span><span class="o">=</span></code> This vector is used to initialize the 3d label numbers of the upper/top face from the 2d region number.</p>
<p>This vector contains successive pairs of the 2d region number at index <span class="math notranslate nohighlight">\(2i\)</span> and the corresponding 3d label number at index <span class="math notranslate nohighlight">\(2i+1\)</span>, like <a class="reference internal" href="#meshgenerationchangelabel"><span class="std std-ref">change</span></a>.</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labeldown</span><span class="o">=</span></code> Same as the previous case but for the lower/down face label.</p>
</li>
</ul>
<p>Moreover, we also add post processing parameters that allow to moving the mesh.
These parameters correspond to parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">transfo</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">facemerge</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ptmerge</span></code> of the command line <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">movemesh</span></code>.</p>
<p>The vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelmid</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labelup</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">labeldown</span></code> These vectors are composed of <span class="math notranslate nohighlight">\(n_{l}\)</span> successive pairs of number <span class="math notranslate nohighlight">\(O_i,N_l\)</span> where <span class="math notranslate nohighlight">\(n_{l}\)</span> is the number (label or region) that we want to get.</p>
<p>An example of this command is given in the <a class="reference internal" href="../example/meshGeneration.html#examplebuildlayermesh"><span class="std std-ref">Build layer mesh example</span></a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Cube</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//Cube.idp</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>

<span class="kt">func</span> <span class="kt">mesh3</span> <span class="n">Cube</span> <span class="p">(</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">NN</span><span class="p">,</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">BB</span><span class="p">,</span> <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">L</span><span class="p">){</span>
    <span class="kt">real</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span> <span class="nf">y0</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="nf">y1</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">NN</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">NN</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span> <span class="o">=</span> <span class="n">NN</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

    <span class="c1">// 2D mesh</span>
    <span class="kt">mesh</span> <span class="n">Thx</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

    <span class="c1">// 3D mesh</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rdown</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)];</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rmid</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)];</span>
    <span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">z0</span><span class="p">,</span><span class="n">z1</span><span class="p">],</span>
    <span class="kp">labelmid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span> <span class="kp">labelup</span> <span class="o">=</span> <span class="n">rup</span><span class="p">,</span> <span class="kp">labeldown</span> <span class="o">=</span> <span class="n">rdown</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">Th</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Unit cube</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">include</span> <span class="s">&quot;Cube.idp&quot;</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">NN</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">];</span> <span class="c1">//the number of step in each direction</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">BB</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]];</span> <span class="c1">//the bounding box</span>
<span class="kt">int</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]];</span> <span class="c1">//the label of the 6 face left,right, front, back, down, right</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span> <span class="n">BB</span><span class="p">,</span> <span class="n">L</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Th&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="meshgenerationlayermeshexample1">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh_Example1.png"><img alt="../_images/MeshGeneration_LayerMesh_Example1.png" src="../_images/MeshGeneration_LayerMesh_Example1.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 92 </span><span class="caption-text">The mesh of a cube made with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">cube</span><span class="p">.</span><span class="n">edp</span></code></span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Cone</p>
<p>An axisymtric mesh on a triangle with degenerateness</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">RR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">HH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">nn</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>

<span class="c1">// 2D mesh</span>
<span class="kt">border</span> <span class="nf">Taxe</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">HH</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">0</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Hypo</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">HH</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="n">RR</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">Vert</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">RR</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">HH</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th2</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Taxe</span><span class="p">(</span><span class="n">HH</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hypo</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">HH</span><span class="o">*</span><span class="n">HH</span><span class="o">+</span><span class="n">RR</span><span class="o">*</span><span class="n">RR</span><span class="p">)</span><span class="o">*</span><span class="n">nn</span><span class="p">)</span> <span class="o">+</span> <span class="n">Vert</span><span class="p">(</span><span class="n">RR</span><span class="o">*</span><span class="n">nn</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="c1">// 3D mesh</span>
<span class="kt">real</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">nn</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">MaxLayersT</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="n">RR</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">;</span><span class="c1">//number of layers</span>
<span class="kt">real</span> <span class="n">zminT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">zmaxT</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="c1">//height 2*pi</span>
<span class="kt">func</span> <span class="n">fx</span> <span class="o">=</span> <span class="kr">y</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">z</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">fy</span> <span class="o">=</span> <span class="kr">y</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">z</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">fz</span> <span class="o">=</span> <span class="kr">x</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r1T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r2T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">r4T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//trick function:</span>
<span class="c1">//The function defined the proportion</span>
<span class="c1">//of number layer close to axis with reference MaxLayersT</span>
<span class="kt">func</span> <span class="n">deg</span> <span class="o">=</span> <span class="kr">max</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span> <span class="kr">y</span><span class="o">/</span><span class="kr">max</span><span class="p">(</span><span class="kr">x</span><span class="o">/</span><span class="n">HH</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span><span class="o">/</span><span class="n">RR</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">Th3T</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="kp">coef</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">MaxLayersT</span><span class="p">,</span>
    <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zminT</span><span class="p">,</span> <span class="n">zmaxT</span><span class="p">],</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">fz</span><span class="p">],</span>
    <span class="kp">facemerge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">region</span><span class="o">=</span><span class="n">r1T</span><span class="p">,</span> <span class="kp">labelmid</span><span class="o">=</span><span class="n">r2T</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;cone&quot;</span><span class="p">,</span> <span class="n">Th3T</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure" id="meshgenerationlayermeshexample2">
<a class="reference internal image-reference" href="../_images/MeshGeneration_LayerMesh_Example2.png"><img alt="../_images/MeshGeneration_LayerMesh_Example2.png" src="../_images/MeshGeneration_LayerMesh_Example2.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 93 </span><span class="caption-text">The mesh of a cone made with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">cone</span><span class="p">.</span><span class="n">edp</span></code></span></p>
</div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Buildlayer mesh</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">C1</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">C2</span> <span class="o">=</span> <span class="mi">98</span><span class="p">;</span>

<span class="c1">// 2D mesh</span>
<span class="kt">border</span> <span class="nf">C01</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C02</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kr">pi</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C03</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">pi</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="kr">pi</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C04</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span> <span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>

<span class="kt">border</span> <span class="nf">C11</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C12</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C13</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">1.2</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C14</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C1</span><span class="p">;}</span>

<span class="kt">border</span> <span class="nf">C21</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">2.3</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C22</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">2.5</span><span class="o">+</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C23</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">3</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>
<span class="kt">border</span> <span class="nf">C24</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">2.3</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">4.5</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="n">C2</span><span class="p">;}</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C02</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C03</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C04</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">C11</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C12</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C13</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C14</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">C21</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C22</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C23</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C24</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">));</span>

<span class="kt">mesh</span> <span class="n">Ths</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">C01</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C02</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C03</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">C04</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">C11</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C12</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C13</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">C14</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>

<span class="c1">// Construction of a box with one hole and two regions</span>
<span class="kt">func</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">MaxLayer</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">XX</span> <span class="o">=</span> <span class="kr">x</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">YY</span> <span class="o">=</span> <span class="kr">x</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">ZZ</span> <span class="o">=</span> <span class="kr">z</span><span class="p">;</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">],</span> <span class="n">r2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">98</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">56</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">];</span>  <span class="c1">//the triangles of uppper surface mesh</span>
                        <span class="c1">//generated by the triangle in the 2D region</span>
                        <span class="c1">//of mesh Th of label 4 as label 12</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">r4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">45</span><span class="p">];</span>  <span class="c1">//the triangles of lower surface mesh</span>
                        <span class="c1">//generated by the triangle in the 2D region</span>
                        <span class="c1">//of mesh Th of label 4 as label 45.</span>

<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">MaxLayer</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">],</span> <span class="kr">region</span><span class="o">=</span><span class="n">r1</span><span class="p">,</span>
    <span class="kp">labelmid</span><span class="o">=</span><span class="n">r2</span><span class="p">,</span> <span class="kp">labelup</span><span class="o">=</span><span class="n">r3</span><span class="p">,</span> <span class="kp">labeldown</span><span class="o">=</span><span class="n">r4</span><span class="p">);</span>
    <span class="nf">medit</span><span class="p">(</span><span class="s">&quot;box 2 regions 1 hole&quot;</span><span class="p">,</span> <span class="n">Th3</span><span class="p">);</span>

<span class="c1">// Construction of a sphere with TetGen</span>
<span class="kt">func</span> <span class="n">XX1</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">YY1</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">ZZ1</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">];</span>
<span class="kt">string</span> <span class="n">test</span> <span class="o">=</span> <span class="s">&quot;paACQ&quot;</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;test = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">test</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kt">mesh3</span> <span class="n">Th3sph</span> <span class="o">=</span> <span class="nf">tetgtransfo</span><span class="p">(</span><span class="n">Ths</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">XX1</span><span class="p">,</span> <span class="n">YY1</span><span class="p">,</span> <span class="n">ZZ1</span><span class="p">],</span>
    <span class="kp">switch</span><span class="o">=</span><span class="n">test</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sphere 2 regions&quot;</span><span class="p">,</span> <span class="n">Th3sph</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="meshing-examples-1">
<span id="id13"></span><h3>Meshing examples<a class="headerlink" href="#meshing-examples-1" title="Permalink to this headline"> </a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Lake</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="c1">// 2D mesh</span>
<span class="kt">border</span> <span class="nf">cc</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
<span class="kt">mesh</span> <span class="n">Th2</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">cc</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span>

<span class="c1">// 3D mesh</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">rlow</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rmid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">func</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">));</span>
<span class="kt">func</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="nf">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">);</span>

<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span>
    <span class="kp">coef</span><span class="o">=</span><span class="kr">max</span><span class="p">((</span><span class="n">zmax</span><span class="o">-</span><span class="n">zmin</span><span class="p">)</span><span class="o">/</span><span class="n">zmax</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">nn</span><span class="p">),</span>
    <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span>
    <span class="kp">labelmid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span>
    <span class="kp">labelup</span><span class="o">=</span><span class="n">rup</span><span class="p">,</span>
    <span class="kp">labeldown</span><span class="o">=</span><span class="n">rlow</span><span class="p">);</span>

<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Th&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Hole region</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// 2D mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span> <span class="c1">// ]-pi/2, pi/2[X]0,2pi[</span>

<span class="c1">// 3D mesh</span>
<span class="c1">//parametrization of a sphere</span>
<span class="kt">func</span> <span class="n">f1</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="c1">//partial derivative of the parametrization</span>
<span class="kt">func</span> <span class="n">f1x</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f1y</span> <span class="o">=</span> <span class="o">-</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2x</span> <span class="o">=</span> <span class="o">-</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f2y</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3x</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f3y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="c1">//M = DF^t DF</span>
<span class="kt">func</span> <span class="n">m11</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">m21</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">m22</span> <span class="o">=</span> <span class="n">f1y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>

<span class="kt">func</span> <span class="n">perio</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kr">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="kr">x</span><span class="p">]];</span>
<span class="kt">real</span> <span class="n">hh</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">vv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
<span class="kr">verbosity</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="c1">//construction of the surface of spheres</span>
<span class="kt">real</span> <span class="n">Rmin</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f1min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f2min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f3min</span> <span class="o">=</span> <span class="n">Rmin</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>

<span class="kt">mesh3</span> <span class="n">Th3sph</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1min</span><span class="p">,</span> <span class="n">f2min</span><span class="p">,</span> <span class="n">f3min</span><span class="p">]);</span>

<span class="kt">real</span> <span class="n">Rmax</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f1max</span> <span class="o">=</span> <span class="n">Rmax</span><span class="o">*</span><span class="n">f1</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f2max</span> <span class="o">=</span> <span class="n">Rmax</span><span class="o">*</span><span class="n">f2</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">f3max</span> <span class="o">=</span> <span class="n">Rmax</span><span class="o">*</span><span class="n">f3</span><span class="p">;</span>

<span class="kt">mesh3</span> <span class="n">Th3sph2</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1max</span><span class="p">,</span> <span class="n">f2max</span><span class="p">,</span> <span class="n">f3max</span><span class="p">]);</span>

<span class="c1">//gluing meshse</span>
<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="n">Th3sph</span> <span class="o">+</span> <span class="n">Th3sph2</span><span class="p">;</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; TetGen call without hole &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th3fin</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain2</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sphere with two regions&quot;</span><span class="p">,</span> <span class="n">Th3fin</span><span class="p">);</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; TetGen call with hole &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">hole</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th3finhole</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;paAAQYY&quot;</span><span class="p">,</span>
    <span class="kp">nbofholes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">holelist</span><span class="o">=</span><span class="n">hole</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sphere with a hole&quot;</span><span class="p">,</span> <span class="n">Th3finhole</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="build-a-3d-mesh-of-a-cube-with-a-balloon">
<h2>Build a 3d mesh of a cube with a balloon<a class="headerlink" href="#build-a-3d-mesh-of-a-cube-with-a-balloon" title="Permalink to this headline"> </a></h2>
<p>First the <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">MeshSurface</span><span class="p">.</span><span class="n">idp</span></code> file to build boundary mesh of a Hexaedra and of a Sphere:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">mesh3</span> <span class="nf">SurfaceHex</span> <span class="p">(</span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="kr">N</span><span class="p">,</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="kp">B</span><span class="p">,</span> <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">L</span><span class="p">,</span> <span class="kt">int</span> <span class="kp">orientation</span><span class="p">){</span>
    <span class="kt">real</span> <span class="n">x0</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">x1</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span> <span class="nf">y0</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nf">y1</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kt">real</span> <span class="n">z0</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">z1</span> <span class="o">=</span> <span class="kp">B</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="kt">int</span> <span class="n">nx</span> <span class="o">=</span> <span class="kr">N</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ny</span> <span class="o">=</span> <span class="kr">N</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nz</span> <span class="o">=</span> <span class="kr">N</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

    <span class="kt">mesh</span> <span class="n">Thx</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="p">[</span><span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="n">z0</span><span class="o">+</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
    <span class="kt">mesh</span> <span class="n">Thy</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="n">z0</span><span class="o">+</span><span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>
    <span class="kt">mesh</span> <span class="n">Thz</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="o">+</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y0</span><span class="o">+</span><span class="p">(</span><span class="nf">y1</span><span class="o">-</span><span class="nf">y0</span><span class="p">)</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">refx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">refX</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span> <span class="c1">//Xmin, Ymax faces labels renumbering</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">refy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">refY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span> <span class="c1">//Ymin, Ymax faces labesl renumbering</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">refz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">refZ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span> <span class="c1">//Zmin, Zmax faces labels renumbering</span>

    <span class="kt">mesh3</span> <span class="n">Thx0</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refx</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Thx1</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thx</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refX</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Thy0</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thy</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y0</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refy</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Thy1</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thy</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="nf">y1</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refY</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Thz0</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thz</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="n">z0</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=-</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refz</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Thz1</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Thz</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">,</span> <span class="n">z1</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=+</span><span class="kp">orientation</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">refZ</span><span class="p">);</span>
    <span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="n">Thx0</span> <span class="o">+</span> <span class="n">Thx1</span> <span class="o">+</span> <span class="n">Thy0</span> <span class="o">+</span> <span class="n">Thy1</span> <span class="o">+</span> <span class="n">Thz0</span> <span class="o">+</span> <span class="n">Thz1</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">Th</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">func</span> <span class="kt">mesh3</span> <span class="nf">Sphere</span> <span class="p">(</span><span class="kt">real</span> <span class="n">R</span><span class="p">,</span> <span class="kt">real</span> <span class="n">h</span><span class="p">,</span> <span class="kt">int</span> <span class="n">L</span><span class="p">,</span> <span class="kt">int</span> <span class="kp">orientation</span><span class="p">){</span>
    <span class="kt">mesh</span> <span class="n">Th</span><span class="o">=</span><span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="kr">pi</span><span class="o">-</span><span class="kr">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="o">*</span><span class="kr">pi</span><span class="p">]);</span> <span class="c1">//]-pi/2, pi/2[X]0,2pi[</span>

    <span class="kt">func</span> <span class="n">f1</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f2</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f3</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>

    <span class="kt">func</span> <span class="n">f1x</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f1y</span> <span class="o">=</span> <span class="o">-</span><span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f2x</span> <span class="o">=</span> <span class="o">-</span><span class="nf">sin</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f2y</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">y</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f3x</span> <span class="o">=</span> <span class="nf">cos</span><span class="p">(</span><span class="kr">x</span><span class="p">);</span>
    <span class="kt">func</span> <span class="n">f3y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kt">func</span> <span class="n">m11</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
    <span class="kt">func</span> <span class="n">m21</span> <span class="o">=</span> <span class="n">f1x</span><span class="o">*</span><span class="n">f1y</span> <span class="o">+</span> <span class="n">f2x</span><span class="o">*</span><span class="n">f2y</span> <span class="o">+</span> <span class="n">f3x</span><span class="o">*</span><span class="n">f3y</span><span class="p">;</span>
    <span class="kt">func</span> <span class="n">m22</span> <span class="o">=</span> <span class="n">f1y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f2y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f3y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>

    <span class="kt">func</span> <span class="n">perio</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="kr">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kr">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="kr">x</span><span class="p">]];</span> <span class="c1">//to store the periodic condition</span>

    <span class="kt">real</span> <span class="n">hh</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">R</span><span class="p">;</span> <span class="c1">//hh mesh size on unite sphere</span>
    <span class="kt">real</span> <span class="n">vv</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nf">square</span><span class="p">(</span><span class="n">hh</span><span class="p">);</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">adaptmesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">m11</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m21</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="n">m22</span><span class="o">*</span><span class="n">vv</span><span class="p">,</span> <span class="kp">IsMetric</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">periodic</span><span class="o">=</span><span class="n">perio</span><span class="p">);</span>
    <span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">ref</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">];</span>

    <span class="kt">mesh3</span> <span class="n">ThS</span> <span class="o">=</span> <span class="nf">movemesh23</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="n">f1</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">f2</span><span class="o">*</span><span class="n">R</span><span class="p">,</span> <span class="n">f3</span><span class="o">*</span><span class="n">R</span><span class="p">],</span> <span class="kp">orientation</span><span class="o">=</span><span class="kp">orientation</span><span class="p">,</span> <span class="n">refface</span><span class="o">=</span><span class="n">ref</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">ThS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The test of the two functions and the call to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">TetGen</span></code> mesh generator:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">include</span> <span class="s">&quot;MeshSurface.idp&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">hs</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="c1">//mesh size on sphere</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">N</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">];</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span> <span class="kp">B</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]];</span>
<span class="kt">int</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]];</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh3</span> <span class="n">ThH</span> <span class="o">=</span> <span class="n">SurfaceHex</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">ThS</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="kt">mesh3</span> <span class="n">ThHS</span> <span class="o">=</span> <span class="n">ThH</span> <span class="o">+</span> <span class="n">ThS</span><span class="p">;</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Hex-Sphere&quot;</span><span class="p">,</span> <span class="n">ThHS</span><span class="p">);</span>

<span class="kt">real</span> <span class="n">voltet</span> <span class="o">=</span> <span class="p">(</span><span class="n">hs</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;voltet = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">voltet</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">voltet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">voltet</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">ThHS</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;pqaAAYYQ&quot;</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domain</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Cube with ball&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="figure compound align-center" id="CubeSphere">
<div style="width: 49%" class="subfigure" id="id33">
<span id="meshgenerationcubesphere1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_CubeSphere1.png"><img alt="MeshGeneration_CubeSphere1" src="../_images/MeshGeneration_CubeSphere1.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 94 </span><span class="caption-text">The surface mesh of the hex with internal sphere</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id34">
<span id="meshgenerationcubesphere2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_CubeSphere2.png"><img alt="MeshGeneration_CubeSphere2" src="../_images/MeshGeneration_CubeSphere2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 95 </span><span class="caption-text">The tetrahedral mesh of the cube with internal ball</span></p>
</div>
<p class="caption"><span class="caption-text">Cube sphere</span></p>
</div><div class="section" id="medit">
<span id="CubeSphere"></span><h3>Medit<a class="headerlink" href="#medit" title="Permalink to this headline"> </a></h3>
<p>The keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> allows to display a mesh alone or a mesh and one or several functions defined on the mesh using the Pascal Frey’s freeware <code class="docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code>.
<code class="docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> opens its own window and uses OpenGL extensively.
Naturally to use this command <code class="docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> must be installed.</p>
<p>A vizualisation with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> of scalar solutions <span class="math notranslate nohighlight">\(f1\)</span> and <span class="math notranslate nohighlight">\(f2\)</span> continuous, piecewise linear and known at the vertices of the mesh Th is obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sol1 sol2&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The first plot named <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">sol1</span></code> display f1.
The second plot names <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">sol2</span></code> display f2.</p>
<p>The arguments of the function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code> are the name of the differents scenes (separated by a space) of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">medit</span></code>, a mesh and solutions.</p>
<p>Each solution is associated with one scene.
The scalar, vector and symmetric tensor solutions are specified in the format described in the section dealing with the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">savesol</span></code>.</p>
<p>The parameters of this command line are :</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">order</span><span class="o">=</span></code> 0 if the solution is given at the center of gravity of elements.</dt>
<dd>1 is the solution is given at the vertices of elements.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">meditff</span><span class="o">=</span></code> set the name of execute command of medit.</dt>
<dd>By default, this string is medit.</dd>
</dl>
</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">save</span><span class="o">=</span></code> set the name of a file <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">sol</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="n">solb</span></code> to save solutions.</li>
</ul>
<p>This command line allows also to represent two differents meshes and solutions on them in the same windows.
The nature of solutions must be the same.
Hence, we can vizualize in the same window the different domains in a domain decomposition method for instance.
A vizualisation with medit of scalar solutions <span class="math notranslate nohighlight">\(h1\)</span> and <span class="math notranslate nohighlight">\(h2\)</span> at vertices of the mesh Th1 and Th2 respectively are obtained using:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nf">medit</span><span class="p">(</span><span class="s">&quot;sol2domain&quot;</span><span class="p">,</span> <span class="n">Th1</span><span class="p">,</span> <span class="n">h1</span><span class="p">,</span> <span class="n">Th2</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Medit</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// Initial Problem:</span>
<span class="c1">// Resolution of the following EDP:</span>
<span class="c1">// -Delta u_s = f on \Omega = { (x,y) | 1 &lt;= sqrt(x^2+y^2) &lt;= 2 }</span>
<span class="c1">// -Delta u_1 = f1 on \Omega_1 = { (x,y) | 0.5 &lt;= sqrt(x^2+y^2) &lt;= 1. }</span>
<span class="c1">// u = 1 on Gamma</span>
<span class="c1">// Null Neumman condition on Gamma_1 and on Gamma_2</span>
<span class="c1">// We find the solution u by solving two EDP defined on domain Omega and Omega_1</span>
<span class="c1">// This solution is visualize with medit</span>

<span class="kr">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">Gamma</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">Gamma1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">Gamma2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">pi</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="nf">sin</span><span class="p">(</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">3</span><span class="p">;};</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">));</span> <span class="c1">//Omega</span>
<span class="kt">mesh</span> <span class="n">Th1</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma2</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">));</span> <span class="c1">//Omega_1</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span> <span class="o">+</span> <span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">us</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vh1</span><span class="p">(</span><span class="n">Th1</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="kt">func</span> <span class="n">f1</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="kr">x</span><span class="o">*</span><span class="kr">x</span><span class="o">+</span><span class="kr">y</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Vh1</span> <span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="nf">Grad2</span><span class="p">(</span><span class="n">us</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">us</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">us</span><span class="p">)]</span> <span class="c1">// EOM</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="n">Lap2dOmega</span> <span class="p">(</span><span class="n">us</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="kr">false</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">Grad2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">Grad2</span><span class="p">(</span><span class="n">us</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">f</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">us</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">;</span>

<span class="kt">problem</span> <span class="nf">Lap2dOmega1</span> <span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="kr">false</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th1</span><span class="p">)(</span>
        <span class="n">Grad2</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">Grad2</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th1</span><span class="p">)(</span>
        <span class="n">f1</span><span class="o">*</span><span class="n">v1</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Solve</span>
<span class="n">Lap2dOmega</span><span class="p">;</span>
<span class="n">Lap2dOmega1</span><span class="p">;</span>

<span class="c1">// Plot with medit</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;solution&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">,</span> <span class="n">us</span><span class="p">,</span> <span class="n">Th1</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="kp">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">save</span><span class="o">=</span><span class="s">&quot;testsavemedit.solb&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="mshmet">
<span id="meshgenerationmshmet"></span><h3>Mshmet<a class="headerlink" href="#mshmet" title="Permalink to this headline"> </a></h3>
<p>Mshmet is a software developed by P. Frey that allows to compute an anisotropic metric based on solutions (i.e.&nbsp;Hessian-based).
This software can return also an isotropic metric.
Moreover, <code class="docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> can also construct a metric suitable for levelset interface capturing.
The solution can be defined on 2D or 3D structured/unstructured meshes.
For example, the solution can be an error estimate of a FE solution.</p>
<p>Solutions for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> are given as an argument.
The solution can be a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a vector <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a symmetric tensor, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> vector function and a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> symmetric tensor.
The symmetric tensor argument is defined as this type of data for datasol argument.
This software accepts more than one solution.</p>
<p>For example, the metric <span class="math notranslate nohighlight">\(M\)</span> computed with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> for the solution <span class="math notranslate nohighlight">\(u\)</span> defined on the mesh <span class="math notranslate nohighlight">\(Th\)</span> is obtained by writing:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">;</span> <span class="c1">//a scalar fespace function</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">M</span> <span class="o">=</span> <span class="nf">mshmet</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The parameters of the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> are :</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">normalization</span> <span class="o">=</span></code> (b) do a normalization of all solution in <span class="math notranslate nohighlight">\([0,1]\)</span>.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">aniso</span> <span class="o">=</span></code> (b) build anisotropic metric if 1 (default 0: isotropic)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">levelset</span> <span class="o">=</span></code> (b) build metric for levelset method (default: <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code>)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span> <span class="o">=</span></code> (l) level of verbosity</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">nbregul</span> <span class="o">=</span></code> (l) number of regularization’s iteration of solutions given (default 0).</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span> <span class="o">=</span></code> (d)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span> <span class="o">=</span></code> (d)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">err</span> <span class="o">=</span></code> (d) level of error.</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">width</span> <span class="o">=</span></code> (d) the width</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span> <span class="o">=</span></code> a vector of double.</dt>
<dd>This vector contains an initial metric given to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code>.
The structure of the metric vector is described in the next paragraph.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">loptions</span> <span class="o">=</span></code> a vector of integer of size 7.</dt>
<dd>This vector contains the integer parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> (for expert only).<ul class="last">
<li>loptions(0): normalization (default 1).</li>
<li><dl class="first docutils">
<dt>loptions(1): isotropic parameters (default 0).</dt>
<dd>1 for isotropic metric results otherwise 0.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(2): level set parameters (default 0).</dt>
<dd>1 for building level set metric otherwise 0.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(3): debug parameters (default 0).</dt>
<dd>1 for turning on debug mode otherwise 0.</dd>
</dl>
</li>
<li>loptions(4): level of verbosity (default 10).</li>
<li>loptions(5): number of regularization’s iteration of solutions given (default 0).</li>
<li><dl class="first docutils">
<dt>loptions(6): previously metric parameter (default 0).</dt>
<dd>1 for using previous metric otherwise 0.</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">doptions</span><span class="o">=</span></code> a vector of double of size 4.</dt>
<dd>This vector contains the real parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> (for expert only).<ul class="last">
<li>doptions(0): hmin : min size parameters (default 0.01).</li>
<li>doptions(1): hmax : max size parameters (default 1.0).</li>
<li>doptions(2): eps : tolerance parameters (default 0.01).</li>
<li>doptions(2): width : relative width for Level Set (<span class="math notranslate nohighlight">\(0&lt;w&lt;1\)</span>) (default 0.05).</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The result of the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> is a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> which contains the metric computed by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mshmet</span></code> at the different vertices <span class="math notranslate nohighlight">\(V_{i}\)</span> of the mesh.</p>
<p>With <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices, the structure of this vector is:</p>
<div class="math notranslate nohighlight">
\[M_{iso}= (m(V_0), m(V_1), \ldots, m(V_{nv}))^t\]</div>
<p>for a isotropic metric <span class="math notranslate nohighlight">\(m\)</span>.
For a symmetric tensor metric <span class="math notranslate nohighlight">\(h=\left(\begin{array}{ccc} m_{1 1} &amp; m_{1 2} &amp; m_{1 3}\\ m_{2 1} &amp; m_{2 2} &amp; m_{2 3} \\ m_{3 1} &amp; m_{3 2} &amp; m_{3 3} \end{array}\right)\)</span> , the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> is:</p>
<div class="math notranslate nohighlight">
\[M_{aniso}= (H(V_{0}), \ldots, H(V_{nv}) )^t\]</div>
<p>where <span class="math notranslate nohighlight">\(H(V_{i})\)</span> is the vector of size 6 defined by <span class="math notranslate nohighlight">\([m11,m21,m22,m31,m32,m33]\)</span></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>mshmet</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;</span><span class="nf">mshmet</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">error</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">MaxLayer</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">2</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">3</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">4</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">5</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">label</span><span class="o">=</span><span class="mi">6</span><span class="p">;};</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="nf">d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">MaxLayer</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh3</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="nc">P2</span><span class="p">);</span>
<span class="n">Vh3</span> <span class="n">u3</span><span class="p">,</span> <span class="n">v3</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">Vh3P1</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh3P1</span> <span class="n">usol</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="nf">Problem2</span><span class="p">(</span><span class="n">u3</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
        <span class="n">u3</span><span class="o">*</span><span class="n">v3</span><span class="o">*</span><span class="mf">1.0e-10</span>
        <span class="o">+</span> <span class="nf">dx</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u3</span><span class="p">)</span><span class="o">*</span><span class="nf">dz</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
        <span class="n">v3</span>
    <span class="p">)</span>
    <span class="o">+</span><span class="nf">on</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">u3</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Solve</span>
<span class="n">Problem2</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">u3</span><span class="p">[].</span><span class="kr">min</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u3</span><span class="p">[].</span><span class="kr">max</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Sol&quot;</span><span class="p">,</span> <span class="n">Th3</span><span class="p">,</span> <span class="n">u3</span><span class="p">);</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">bb</span> <span class="o">=</span> <span class="nf">mshmet</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span><span class="n">u3</span><span class="p">);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Metric:&quot;</span> <span class="o">&lt;&lt;</span> <span class="kp">bb</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">usol</span><span class="p">[][</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="kp">bb</span><span class="p">[</span><span class="n">ii</span><span class="p">];</span>

<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Metric&quot;</span><span class="p">,</span> <span class="n">Th3</span><span class="p">,</span> <span class="n">usol</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="freeyams">
<h3>FreeYams<a class="headerlink" href="#freeyams" title="Permalink to this headline"> </a></h3>
<p>FreeYams is a surface mesh adaptation software which is developed by P. Frey.
This software is a new version of yams.
The adapted surface mesh is constructed with a geometric metric tensor field.
This field is based on the intrinsic properties of the discrete surface.</p>
<p>Also, this software allows to construct a simplification of a mesh.
This decimation is based on the Hausdorff distance between the initial and the current triangulation.
Compared to the software yams, FreeYams can be used also to produce anisotropic triangulations adapted to levelset simulations.
A technical report on freeYams documentation is available <a class="reference external" href="https://www.ljll.math.upmc.fr/frey/publications/RT-0252.pdf">here</a>.</p>
<p>To call FreeYams in <strong>FreeFEM</strong>, we used the keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code>.
The arguments of this function are the initial mesh and/or metric.
The metric with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code> are a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">func</span></code>, a <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function, a symmetric tensor function, a symmetric tensor <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function or a vector of double (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>).
If the metric is a vector of double, this data must be given in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> parameter.
Otherwise, the metric is given in the argument.</p>
<p>For example, the adapted mesh of <code class="docutils literal highlight highlight-freefem"><span></span><span class="n">Thinit</span></code> defined by the metric <span class="math notranslate nohighlight">\(u\)</span> defined as <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">fespace</span></code> function is obtained by writing:</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Thinit</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">;</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">freeyams</span><span class="p">(</span><span class="n">Thinit</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The symmetric tensor argument for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">freeyams</span></code> keyword is defined as this type of data for datasol argument.</p>
<ul>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">aniso</span><span class="o">=</span></code> (b) aniso or iso metric (default 0, iso)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">mem</span><span class="o">=</span></code> (l) memory of for freeyams in Mb (default -1,
freeyams choose)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmin</span><span class="o">=</span></code> (d)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">hmax</span><span class="o">=</span></code> (d)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">gradation</span><span class="o">=</span></code> (d)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">option</span><span class="o">=</span></code> (l)</p>
<ul class="simple">
<li>0 : mesh optimization (smoothing+swapping)</li>
<li>1 : decimation+enrichment adaptated to a metric map. (default)</li>
<li>-1 : decimation adaptated to a metric map.</li>
<li>2 : decimation+enrichment with a Hausdorff-like method</li>
<li>-2 : decimation with a Hausdorff-like method</li>
<li>4 : split triangles recursively.</li>
<li>9 : No-Shrinkage Vertex Smoothing</li>
</ul>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ridgeangle</span><span class="o">=</span></code> (d)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">absolute</span><span class="o">=</span></code> (b)</p>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">verbosity</span><span class="o">=</span></code> (i)</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> vector expression.</dt>
<dd><p class="first last">This parameters contains the metric at the different vertices on the initial mesh.
With <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices, this vector is:</p>
</dd>
</dl>
<div class="math notranslate nohighlight">
\[M_{iso}= ( m(V_0), m(V_1), \ldots, m(V_{nv}) )^t\]</div>
<p>for a scalar metric <span class="math notranslate nohighlight">\(m\)</span>.
For a symmetric tensor metric
<span class="math notranslate nohighlight">\(h=\left(\begin{array}{ccc} m_{1 1} &amp; m_{1 2} &amp; m_{1 3}\\ m_{2 1} &amp; m_{2 2} &amp; m_{2 3} \\ m_{3 1} &amp; m_{3 2} &amp; m_{3 3} \end{array}\right)\)</span>, the parameters <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> is:</p>
<div class="math notranslate nohighlight">
\[M_{aniso}= ( H(V_{0}), \ldots, H(V_{nv}) )^t\]</div>
<p>where <span class="math notranslate nohighlight">\(H(V_{i})\)</span> is the vector of size 6 defined by <span class="math notranslate nohighlight">\([m11,m21,m22,m31,m32,m33]\)</span></p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">loptions</span><span class="o">=</span></code> a vector of integer of size 13.</dt>
<dd><p class="first">This vectors contains the integer options of FreeYams. (just for the expert)</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>loptions(0): anisotropic parameter (default 0).</dt>
<dd>If you give an anisotropic metric 1 otherwise 0.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(1): Finite Element correction parameter (default 0).</dt>
<dd>1 for <em>no</em> Finite Element correction otherwise 0.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(2): Split multiple connected points parameter (default 1).</dt>
<dd>1 for splitting multiple connected points otherwise 0.</dd>
</dl>
</li>
<li>loptions(3): maximum value of memory size in Mbytes (default -1: the size is given by freeyams).</li>
<li><dl class="first docutils">
<dt>loptions(4): set the value of the connected component which we want to obtain.</dt>
<dd>(Remark: freeyams give an automatic value at each connected component).</dd>
</dl>
</li>
<li>loptions(5): level of verbosity</li>
<li><dl class="first docutils">
<dt>loptions(6): Create point on straight edge (no mapping) parameter (default 0).</dt>
<dd>1 for creating point on straight edge otherwise 0.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(7): validity check during smoothing parameter.</dt>
<dd>This parameter is only used with No-Shrinkage Vertex Smoothing optimization (optimization option parameter 9).
1 for No validity checking during smoothing otherwise 0.</dd>
</dl>
</li>
<li>loptions(8): number of desired’s vertices (default -1).</li>
<li>loptions(9): number of iteration of optimizations (default 30).</li>
<li><dl class="first docutils">
<dt>loptions(10): no detection parameter (default 0).</dt>
<dd>1 for detecting the ridge on the mesh otherwise 0.
The ridge definition is given in the parameter doptions(12).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>loptions(11): no vertex smoothing parameter (default 0).</dt>
<dd>1 for smoothing the vertices otherwise 0.</dd>
</dl>
</li>
<li>loptions(12): Optimization level parameter (default 0).</li>
</ul>
<blockquote class="last">
<div><ul class="simple">
<li>0 : mesh optimization (smoothing+swapping)</li>
<li>1 : decimation+enrichment adaptated to a metric map.</li>
<li>-1: decimation adaptated to a metric map.</li>
<li>2 : decimation+enrichment with a Hausdorff-like method</li>
<li>-2: decimation with a Hausdorff-like method</li>
<li>4 : split triangles recursively.</li>
<li>9 : No-Shrinkage Vertex Smoothing</li>
</ul>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">doptions</span><span class="o">=</span></code> a vector of double of size 11.</dt>
<dd><p class="first last">This vectors contains the real options of freeyams.</p>
</dd>
</dl>
<ul class="simple">
<li>doptions(0): Set the geometric approximation (Tangent plane deviation) (default 0.01).</li>
<li>doptions(1): Set the lamda parameter (default -1).</li>
<li>doptions(2): Set the mu parmeter (default -1).</li>
<li>doptions(3): Set the gradation value (Mesh density control) (default 1.3).</li>
<li>doptions(4): Set the minimal size(hmin) (default -2.0: the size is automatically computed).</li>
<li>doptions(5): Set the maximal size(hmax) (default -2.0: the size is automatically computed).</li>
<li>doptions(6): Set the tolerance of the control of Chordal deviation (default -2.0).</li>
<li>doptions(7): Set the quality of degradation (default 0.599).</li>
<li>doptions(8): Set the declic parameter (default 2.0).</li>
<li>doptions(9): Set the angular walton limitation parameter (default 45 degree).</li>
<li>doptions(10): Set the angular ridge detection (default 45 degree).</li>
</ul>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>freeyams</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">freeyams</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th2</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span><span class="p">);</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">rdown</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">rmid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="n">Th2</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">],</span> <span class="kp">reffacemid</span><span class="o">=</span><span class="n">rmid</span><span class="p">,</span> <span class="kp">reffaceup</span><span class="o">=</span><span class="n">rup</span><span class="p">,</span> <span class="kp">reffacelow</span><span class="o">=</span><span class="n">rdown</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">freeyams</span><span class="p">(</span><span class="n">Th</span><span class="p">);</span>

<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;SurfaceMesh&quot;</span><span class="p">,</span> <span class="n">Th3</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="mmg3d">
<h3>mmg3d<a class="headerlink" href="#mmg3d" title="Permalink to this headline"> </a></h3>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">mmg3d-v4.0</p>
</div>
<p><a class="reference external" href="http://www.mmgtools.org">Mmg3d</a> is a 3D remeshing software developed by C. Dobrzynski and P. Frey.</p>
<p>This software allows to remesh an initial mesh made of tetrahedra.
This initial mesh is adapted to a geometric metric tensor field or to a displacement vector (moving rigid body).
The metric can be obtained with <a class="reference internal" href="#meshgenerationmshmet"><span class="std std-ref">mshmet</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>If no metric is given, an isotropic metric is computed by analyzing the size of the edges in the initial mesh.</li>
<li>If a displacement is given, the vertices of the surface triangles are moved without verifying the geometrical structure of the new surface mesh.</li>
</ul>
</div>
<p>The parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code> are :</p>
<ul>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">options</span><span class="o">=</span></code> vector expression.</dt>
<dd><p class="first last">This vector contains the option parameters of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code>.
It is a vector of 6 values, with the following meaning:</p>
</dd>
</dl>
<ul>
<li><p class="first">Optimization parameters : (default 1)</p>
<p>0 : mesh optimization.</p>
<p>1 : adaptation with metric (deletion and insertion vertices) and optimization.</p>
<p>-1 : adaptation with metric (deletion and insertion vertices) without optimization.</p>
<p>4 : split tetrahedra (be careful modify the surface).</p>
<p>9 : moving mesh with optimization.</p>
<p>-9 : moving mesh without optimization.</p>
</li>
<li><p class="first">Debug mode : (default 0)</p>
<p>1 : turn on debug mode.</p>
<p>0 : otherwise.</p>
</li>
<li><p class="first">Specify the size of bucket per dimension (default 64)</p>
</li>
<li><p class="first">Swapping mode : (default 0)</p>
<p>1 : no edge or face flipping.</p>
<p>0 : otherwise.</p>
</li>
<li><p class="first">Insert points mode : (default 0)</p>
<p>1 : no edge splitting or collapsing and no insert points.</p>
<p>0 : otherwise.</p>
</li>
</ul>
<ol class="arabic simple" start="5">
<li>Verbosity level (default 3)</li>
</ol>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">memory</span><span class="o">=</span></code> integer expression.</dt>
<dd><p class="first last">Set the maximum memory size of new mesh in Mbytes.
By default the number of maximum vertices, tetrahedra and triangles are respectively 500 000, 3000 000, 100000 which represent approximately a memory of 100 Mo.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span><span class="o">=</span></code> vector expression.</dt>
<dd><p class="first last">This vector contains the metric given at <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">mmg3d</span></code>.
It is a vector of size <span class="math notranslate nohighlight">\(nv\)</span> or 6 <span class="math notranslate nohighlight">\(nv\)</span> respectively for an isotropic and anisotropic metric where <span class="math notranslate nohighlight">\(nv\)</span> is the number of vertices in the initial mesh.
The structure of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">metric</span></code> vector is described in the <a class="reference internal" href="#meshgenerationmshmet"><span class="std std-ref">mshmet</span></a>.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">displacement</span><span class="o">=</span></code> <span class="math notranslate nohighlight">\([\Phi1, \Phi2, \Phi3]\)</span> set the displacement vector of the initial mesh <span class="math notranslate nohighlight">\(\mathbf{\Phi(x,y)} = [\Phi1(x,y), \Phi2(x,y), \Phi3(x,y)]\)</span>.</p>
</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">displVect</span><span class="o">=</span></code> sets the vector displacement in a vector expression.</dt>
<dd><p class="first last">This vector contains the displacement at each point of the initial mesh.
It is a vector of size 3 <span class="math notranslate nohighlight">\(nv\)</span>.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>mmg3d</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">mmg3d</span><span class="s">&quot;</span>
<span class="cp">include</span> <span class="s">&quot;Cube.idp&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Nxyz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">];</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">Bxyz</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]];</span>
<span class="kt">int</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">Lxyz</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]];</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="n">Cube</span><span class="p">(</span><span class="n">Nxyz</span><span class="p">,</span> <span class="n">Bxyz</span><span class="p">,</span> <span class="n">Lxyz</span><span class="p">);</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">isometric</span><span class="p">(</span><span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">nv</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span>
    <span class="n">isometric</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.17</span><span class="p">;</span>

<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">mmg3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">memory</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="kp">metric</span><span class="o">=</span><span class="n">isometric</span><span class="p">);</span>

<span class="c1">// Plot</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Initial&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Isometric&quot;</span><span class="p">,</span> <span class="n">Th3</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Falling spheres</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">mmg3d</span><span class="s">&quot;</span>
<span class="cp">include</span> <span class="s">&quot;MeshSurface.idp&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">real</span> <span class="n">hs</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">N</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="o">/</span><span class="n">hs</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="n">hs</span><span class="p">,</span> <span class="mf">11.5</span><span class="o">/</span><span class="n">hs</span><span class="p">];</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="kp">B</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]];</span>
<span class="kt">int</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">311</span><span class="p">,</span> <span class="mi">311</span><span class="p">],</span> <span class="p">[</span><span class="mi">311</span><span class="p">,</span> <span class="mi">311</span><span class="p">],</span> <span class="p">[</span><span class="mi">311</span><span class="p">,</span> <span class="mi">311</span><span class="p">]];</span>

<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">vit</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">];</span>
<span class="kt">func</span> <span class="n">zero</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<span class="kt">func</span> <span class="n">dep</span> <span class="o">=</span> <span class="n">vit</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh3</span> <span class="n">ThH</span> <span class="o">=</span> <span class="n">SurfaceHex</span><span class="p">(</span><span class="kr">N</span><span class="p">,</span> <span class="kp">B</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">ThSg</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">mesh3</span> <span class="n">ThSd</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hs</span><span class="p">,</span> <span class="mi">310</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">ThSd</span> <span class="o">=</span> <span class="n">movemesh3</span><span class="p">(</span><span class="n">ThSd</span><span class="p">,</span> <span class="kp">transfo</span><span class="o">=</span><span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="kr">y</span><span class="p">,</span> <span class="kr">z</span><span class="p">]);</span>
<span class="kt">mesh3</span> <span class="n">ThHS</span> <span class="o">=</span> <span class="n">ThH</span> <span class="o">+</span> <span class="n">ThSg</span> <span class="o">+</span> <span class="n">ThSd</span><span class="p">;</span><span class="c1">//gluing surface meshes</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;ThHS&quot;</span><span class="p">,</span> <span class="n">ThHS</span><span class="p">);</span>

<span class="kt">real</span> <span class="n">voltet</span> <span class="o">=</span> <span class="p">(</span><span class="n">hs</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">voltet</span><span class="p">];</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">holes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="kt">mesh3</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">tetg</span><span class="p">(</span><span class="n">ThHS</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;pqaAAYYQ&quot;</span><span class="p">,</span> <span class="kp">nbofregions</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">regionlist</span><span class="o">=</span><span class="n">domaine</span><span class="p">,</span> <span class="kp">nbofholes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="kp">holelist</span><span class="o">=</span><span class="n">holes</span><span class="p">);</span>
<span class="nf">medit</span><span class="p">(</span><span class="s">&quot;Box-With-two-Ball&quot;</span><span class="p">,</span> <span class="n">Th</span><span class="p">);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">uh</span><span class="p">,</span><span class="n">vh</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="nf">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="n">Lap</span> <span class="p">(</span><span class="n">uh</span><span class="p">,</span> <span class="n">vh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="n">Grad</span><span class="p">(</span><span class="n">uh</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">Grad</span><span class="p">(</span><span class="n">vh</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">uh</span><span class="o">=</span><span class="n">dep</span><span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">311</span><span class="p">,</span> <span class="n">uh</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Falling loop</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="mi">29</span><span class="p">;</span> <span class="n">it</span><span class="o">++</span><span class="p">){</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; ITERATION &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">it</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="c1">// Solve</span>
    <span class="n">Lap</span><span class="p">;</span>

    <span class="c1">// Plot</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">uh</span><span class="p">);</span>

    <span class="c1">// Sphere falling</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="nf">mmg3d</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">options</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="kp">displacement</span><span class="o">=</span><span class="p">[</span><span class="n">zero</span><span class="p">,</span> <span class="n">zero</span><span class="p">,</span> <span class="n">uh</span><span class="p">],</span> <span class="kp">memory</span><span class="o">=</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="a-first-3d-isotrope-mesh-adaptation-process">
<span id="meshfirstisotropemeshadaptation"></span><h3>A first 3d isotrope mesh adaptation process<a class="headerlink" href="#a-first-3d-isotrope-mesh-adaptation-process" title="Permalink to this headline"> </a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Adaptation 3D</p>
<div class="last highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;msh3&quot;</span>
<span class="cp">load</span> <span class="s">&quot;TetGen&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">mshmet</span><span class="s">&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">medit</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">int</span> <span class="n">nn</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">l1111</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> <span class="c1">//labels</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">l01</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">l11</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span>

<span class="kt">real</span> <span class="n">errm</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">;</span> <span class="c1">//level of error</span>

<span class="c1">// Mesh</span>
<span class="kt">mesh3</span> <span class="n">Th3</span> <span class="o">=</span> <span class="nf">buildlayers</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="kr">region</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kr">label</span><span class="o">=</span><span class="n">l1111</span><span class="p">),</span>
<span class="n">nn</span><span class="p">,</span> <span class="kp">zbound</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="kp">labelmid</span><span class="o">=</span><span class="n">l11</span><span class="p">,</span> <span class="kp">labelup</span><span class="o">=</span><span class="n">l01</span><span class="p">,</span> <span class="kp">labeldown</span><span class="o">=</span><span class="n">l01</span><span class="p">);</span>

<span class="n">Th3</span> <span class="o">=</span> <span class="nf">trunc</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="p">(</span><span class="kr">x</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="kr">y</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="kr">z</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">),</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//remove the ]0.5,1[^3 cube</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">usol</span><span class="p">,</span> <span class="n">h</span><span class="p">;</span>

<span class="c1">// Macro</span>
<span class="kt">macro</span> <span class="nf">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dz</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">// EOM</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="n">Poisson</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
        <span class="n">Grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">&#39;</span> <span class="o">*</span> <span class="n">Grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">-</span> <span class="nf">int3d</span><span class="p">(</span><span class="n">Th3</span><span class="p">)(</span>
        <span class="mi">1</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Loop</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">){</span>
    <span class="c1">// Solve</span>
    <span class="n">Poisson</span><span class="p">;</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;u min, max = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">[].</span><span class="kr">min</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span> <span class="n">u</span><span class="p">[].</span><span class="kr">max</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

    <span class="n">h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span> <span class="c1">//for resizing h[] because the mesh change</span>
    <span class="n">h</span><span class="p">[]</span> <span class="o">=</span> <span class="nf">mshmet</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="kp">normalization</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">aniso</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kp">nbregul</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">hmin</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="kp">hmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="kp">err</span><span class="o">=</span><span class="n">errm</span><span class="p">);</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;h min, max = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">h</span><span class="p">[].</span><span class="kr">min</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span> <span class="n">h</span><span class="p">[].</span><span class="kr">max</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">h</span><span class="p">[].</span><span class="kr">n</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

    <span class="n">errm</span> <span class="o">*=</span> <span class="mf">0.8</span><span class="p">;</span> <span class="c1">//change the level of error</span>
    <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Th3 &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th3</span><span class="p">.</span><span class="kr">nv</span> <span class="o">&lt;</span> <span class="s">&quot; &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th3</span><span class="p">.</span><span class="kr">nt</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
    <span class="n">Th3</span> <span class="o">=</span> <span class="nf">tetgreconstruction</span><span class="p">(</span><span class="n">Th3</span><span class="p">,</span> <span class="kp">switch</span><span class="o">=</span><span class="s">&quot;raAQ&quot;</span><span class="p">,</span> <span class="kp">sizeofvolume</span><span class="o">=</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mf">6.</span><span class="p">);</span> <span class="c1">//rebuild mesh</span>
    <span class="nf">medit</span><span class="p">(</span><span class="s">&quot;U-adap-iso-&quot;</span><span class="o">+</span><span class="n">ii</span><span class="p">,</span> <span class="n">Th3</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="build-a-2d-mesh-from-a-isoline">
<h3>Build a 2d mesh from a isoline<a class="headerlink" href="#build-a-2d-mesh-from-a-isoline" title="Permalink to this headline"> </a></h3>
<p>The idea is to get the discretization of an isoline of fluid meshes, this tool can be useful to construct meshes from image.
First, we give an example of the isovalue meshes <span class="math notranslate nohighlight">\(0.2\)</span> of analytical function <span class="math notranslate nohighlight">\(\sqrt{(x-1/2)^2 +(y-1/2)^2}\)</span>, on unit square.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;</span><span class="nf">isoline</span><span class="s">&quot;</span>

<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">]</span> <span class="n">xy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//to store the isoline points</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//to store the begin, end couple of lines</span>
<span class="p">{</span>
    <span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
    <span class="n">Vh</span> <span class="n">u</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="nf">square</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="nf">square</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mf">0.5</span><span class="p">));</span>
    <span class="kt">real</span> <span class="kp">iso</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="p">;</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">viso</span> <span class="o">=</span> <span class="p">[</span><span class="kp">iso</span><span class="p">];</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">,</span><span class="n">Th</span><span class="p">);</span><span class="c1">//to see the iso line</span>

    <span class="kt">int</span> <span class="n">nbc</span> <span class="o">=</span> <span class="nf">isoline</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="kp">close</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="kp">iso</span><span class="o">=</span><span class="kp">iso</span><span class="p">,</span> <span class="kp">beginend</span><span class="o">=</span><span class="kr">be</span><span class="p">,</span> <span class="kp">smoothing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">isoline</span></code> parameters are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Th</span></code> the mesh, the expression <span class="math notranslate nohighlight">\(u\)</span>, the bidimentionnal array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">xy</span></code> to store the list coordinate of the points.
The list of named parameter are :</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">iso</span><span class="o">=</span></code> value of the isoline to compute (0 is the default value)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">close</span><span class="o">=</span></code> close the isoline with the border (default <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code>), we add the part of the mesh border such the value is less than the isovalue</li>
<li><dl class="first docutils">
<dt><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">smoothing</span><span class="o">=</span></code> number of smoothing process is the <span class="math notranslate nohighlight">\({l} ^{r} {s}\)</span> where <span class="math notranslate nohighlight">\(l\)</span> is the length of the current line component, <span class="math notranslate nohighlight">\(r\)</span> the ratio, <span class="math notranslate nohighlight">\(s\)</span> is smoothing value.</dt>
<dd>The smoothing default value is 0.</dd>
</dl>
</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">ratio</span><span class="o">=</span></code> the ratio (1 by default).</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">eps</span><span class="o">=</span></code> relative <span class="math notranslate nohighlight">\(\varepsilon\)</span> (default 1e-10)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">beginend</span><span class="o">=</span></code> array to get begin, end couple of each of sub line (resize automatically)</li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">file</span><span class="o">=</span></code> to save the data curve in data file for gnuplot</li>
</ul>
<p>In the array <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">xy</span></code> you get the list of vertices of the isoline, each connex line go from <span class="math notranslate nohighlight">\(i= i_0^c ,\dots, i_1^c-1\)</span> with <span class="math notranslate nohighlight">\(i_0^c =be(2*c)\)</span> <span class="math notranslate nohighlight">\(i_1^c =be(2*c+1)\)</span>, and where <span class="math notranslate nohighlight">\(x_i= xy(0,i), y_i=yx( 1,i), l_i=xy(2,i)\)</span>.</p>
<p>Here <span class="math notranslate nohighlight">\(l_i\)</span> is the length of the line (the origin of the line is point <span class="math notranslate nohighlight">\(i_0^c\)</span>).</p>
<p>The sense of the isoline is such that the upper part is at the left size of the isoline.
So here : the minimum is a point <span class="math notranslate nohighlight">\(0.5,05\)</span> so the curve 1 turn in the clockwise sense, the order of each component are sort such that the number of point by component is decreasing.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span>      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of the line component = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nbc</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Number of points = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xy</span><span class="p">.</span><span class="kr">m</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
      <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;be = &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">be</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>

      <span class="c1">// shows the lines component</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">nbc</span><span class="p">;</span> <span class="o">++</span><span class="n">c</span><span class="p">){</span>
         <span class="kt">int</span> <span class="n">i0</span> <span class="o">=</span> <span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span> <span class="n">i1</span> <span class="o">=</span> <span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
         <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Curve &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">c</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">i1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
            <span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; y= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; s= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
         <span class="nf">plot</span><span class="p">([</span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nl">i0</span><span class="o">:</span><span class="n">i1</span><span class="p">),</span> <span class="n">xy</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nl">i0</span><span class="o">:</span><span class="n">i1</span><span class="p">)],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">viso</span><span class="o">=</span><span class="kp">viso</span><span class="p">,</span> <span class="kp">cmm</span><span class="o">=</span><span class="s">&quot; curve &quot;</span><span class="o">+</span><span class="n">c</span><span class="p">);</span>
   <span class="p">}</span>
<span class="p">}</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;length of last curve = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">xy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xy</span><span class="p">.</span><span class="kr">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>We also have a new function to easily parametrize a discrete curve defined by the couple <span class="math notranslate nohighlight">\(be, xy\)</span>.</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">Curve0</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">c</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="c1">//component 0</span>
    <span class="kt">int</span> <span class="n">i0</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span> <span class="n">i1</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="kp">t</span><span class="p">);</span> <span class="c1">//Curve 0</span>
    <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">border</span> <span class="nf">Curve1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//component 1</span>
    <span class="kt">int</span> <span class="n">i0</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">],</span> <span class="n">i1</span><span class="o">=</span><span class="kr">be</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="kp">t</span><span class="p">);</span> <span class="c1">//Curve 1</span>
    <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">Curve1</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span> <span class="c1">//show curve</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">Curve1</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>Secondly, we use this idea to build meshes from an image, we use the plugins <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">ppm2rnm</span></code> to read <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">pgm</span></code> a gray scale image and then we extract the gray contour at level 0.25.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Leman lake</p>
<div class="highlight-freefem notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">load</span> <span class="s">&quot;ppm2rnm&quot;</span>
<span class="cp">load</span> <span class="s">&quot;</span><span class="nf">isoline</span><span class="s">&quot;</span>

<span class="c1">// Parameters</span>
<span class="kt">string</span> <span class="n">leman</span> <span class="o">=</span> <span class="s">&quot;LemanLake.pgm&quot;</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">AreaLac</span> <span class="o">=</span> <span class="mf">580.03</span><span class="p">;</span> <span class="c1">//in km^2</span>
<span class="kt">real</span> <span class="n">hsize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">Curves</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">nc</span><span class="p">;</span> <span class="c1">//nb of curve</span>
<span class="p">{</span>
    <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">ff1</span><span class="p">(</span><span class="n">leman</span><span class="p">);</span> <span class="c1">//read image</span>
    <span class="c1">//and set it in a rect. array</span>
    <span class="kt">int</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">ff1</span><span class="p">.</span><span class="kr">n</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">ff1</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
    <span class="c1">//build a Cartesian mesh such that the origin is in the right place.</span>
    <span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">[(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="kr">x</span><span class="p">),</span> <span class="p">(</span><span class="n">ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="kr">y</span><span class="p">)]);</span>
    <span class="c1">//warning the numbering of the vertices (x,y) is</span>
    <span class="c1">//given by $i = x/nx + nx* y/ny $</span>
    <span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
    <span class="n">Vh</span> <span class="n">f1</span><span class="p">;</span>
    <span class="n">f1</span><span class="p">[]</span> <span class="o">=</span> <span class="n">ff1</span><span class="p">;</span> <span class="c1">//transform array in finite element functions.</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nf">isoline</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="kp">iso</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="kp">close</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Curves</span><span class="p">,</span> <span class="kp">beginend</span><span class="o">=</span><span class="kr">be</span><span class="p">,</span> <span class="kp">smoothing</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="kp">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//The longest isoline: the lake</span>
<span class="kt">int</span> <span class="n">ic0</span> <span class="o">=</span> <span class="kr">be</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">ic1</span> <span class="o">=</span> <span class="kr">be</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">([</span><span class="n">Curves</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nl">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">),</span> <span class="n">Curves</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nl">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">)],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">NC</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ic1</span><span class="p">)</span><span class="o">/</span><span class="n">hsize</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">xl</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nl">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">).</span><span class="kr">max</span> <span class="o">-</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">yl</span> <span class="o">=</span> <span class="n">Curves</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nl">ic0</span><span class="o">:</span><span class="n">ic1</span><span class="p">).</span><span class="kr">min</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">border</span> <span class="nf">G</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">P</span><span class="o">=</span><span class="n">Curve</span><span class="p">(</span><span class="n">Curves</span><span class="p">,</span> <span class="n">ic0</span><span class="p">,</span> <span class="n">ic1</span><span class="p">,</span> <span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="kr">x</span><span class="o">&gt;</span><span class="n">xl</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="kr">y</span><span class="o">&lt;</span><span class="n">yl</span><span class="p">);}</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="o">-</span><span class="n">NC</span><span class="p">),</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="o">-</span><span class="n">NC</span><span class="p">));</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>

<span class="kt">real</span> <span class="n">scale</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">AreaLac</span><span class="o">/</span><span class="n">Th</span><span class="p">.</span><span class="kr">area</span><span class="p">);</span>
<span class="n">Th</span> <span class="o">=</span> <span class="nf">movemesh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="kr">x</span><span class="o">*</span><span class="n">scale</span><span class="p">,</span> <span class="kr">y</span><span class="o">*</span><span class="n">scale</span><span class="p">]);</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Th.area = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Th</span><span class="p">.</span><span class="kr">area</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Km^2 &quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; == &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">AreaLac</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Km^2 &quot;</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">ps</span><span class="o">=</span><span class="s">&quot;leman.eps&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<div class="last figure compound align-center" id="Isoline">
<div style="width: 49%" class="subfigure" id="id35">
<span id="meshgenerationisoline1"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Isoline1.jpg"><img alt="MeshGeneration_Isoline1" src="../_images/MeshGeneration_Isoline1.jpg" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 96 </span><span class="caption-text">The image of the Leman lake meshes</span></p>
</div>
<div style="width: 49%" class="subfigure" id="id36">
<span id="meshgenerationisoline2"></span><a class="reference internal image-reference" href="../_images/MeshGeneration_Isoline2.png"><img alt="MeshGeneration_Isoline2" src="../_images/MeshGeneration_Isoline2.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-number">Fig. 97 </span><span class="caption-text">The mesh of the lake</span></p>
</div>
<p class="caption"><span class="caption-text">Isoline</span></p>
<span class="target" id="Isoline"></span></div></div>
</div>
</div>
</div>


		</div>
		
		<div id="toc">
	<div>
		<b>Table of content</b>
		<ul>
<li><a class="reference internal" href="#">Mesh Generation</a><ul>
<li><a class="reference internal" href="#square">Square</a></li>
<li><a class="reference internal" href="#border">Border</a></li>
<li><a class="reference internal" href="#multi-border">Multi-Border</a></li>
<li><a class="reference internal" href="#data-structures-and-read-write-statements-for-a-mesh">Data Structures and Read/Write Statements for a Mesh</a></li>
<li><a class="reference internal" href="#mesh-connectivity-and-data">Mesh Connectivity and data</a></li>
<li><a class="reference internal" href="#the-keyword-triangulate">The keyword “triangulate”</a><ul>
<li><a class="reference internal" href="#boundary-fem-spaces-built-as-empty-meshes">Boundary FEM Spaces Built as Empty Meshes</a></li>
<li><a class="reference internal" href="#remeshing">Remeshing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#movemesh">Movemesh</a><ul>
<li><a class="reference internal" href="#regular-triangulation-htriangle">Regular Triangulation: hTriangle</a></li>
<li><a class="reference internal" href="#adaptmesh">Adaptmesh</a></li>
<li><a class="reference internal" href="#trunc">Trunc</a></li>
<li><a class="reference internal" href="#splitmesh">Splitmesh</a></li>
<li><a class="reference internal" href="#meshing-examples">Meshing Examples</a></li>
<li><a class="reference internal" href="#how-to-change-the-label-of-elements-and-border-elements-of-a-mesh">How to change the label of elements and border elements of a mesh</a></li>
<li><a class="reference internal" href="#mesh-in-three-dimensions">Mesh in three dimensions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cube">Cube</a></li>
<li><a class="reference internal" href="#read-write-statements-for-a-mesh-in-3d">Read/Write Statements for a Mesh in 3D</a></li>
<li><a class="reference internal" href="#tetgen-a-tetrahedral-mesh-generator">TetGen: A tetrahedral mesh generator</a></li>
<li><a class="reference internal" href="#reconstruct-refine-a-three-dimensional-mesh-with-tetgen">Reconstruct/Refine a three dimensional mesh with TetGen</a></li>
<li><a class="reference internal" href="#moving-mesh-in-three-dimensions">Moving mesh in three dimensions</a></li>
<li><a class="reference internal" href="#layer-mesh">Layer mesh</a><ul>
<li><a class="reference internal" href="#meshing-examples-1">Meshing examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-a-3d-mesh-of-a-cube-with-a-balloon">Build a 3d mesh of a cube with a balloon</a><ul>
<li><a class="reference internal" href="#medit">Medit</a></li>
<li><a class="reference internal" href="#mshmet">Mshmet</a></li>
<li><a class="reference internal" href="#freeyams">FreeYams</a></li>
<li><a class="reference internal" href="#mmg3d">mmg3d</a></li>
<li><a class="reference internal" href="#a-first-3d-isotrope-mesh-adaptation-process">A first 3d isotrope mesh adaptation process</a></li>
<li><a class="reference internal" href="#build-a-2d-mesh-from-a-isoline">Build a 2d mesh from a isoline</a></li>
</ul>
</li>
</ul>
</li>
</ul>

	</div>
</div>
		<footer>
	<p>
		Coded with <i class="fas fa-heart"></i> since 1987
	</p>
	<img src='../_static/img/Symbole.svg' alt="FreeFEM logo"/>
	<div>
		<a id="lgpl" href="https://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">LGPL 3.0</a>
		<a href="http://doc.freefem.org/introduction/citation/" target="_blank">BibTeX</a>
	</div>
</footer>
		

		<script async src="../_static/js/common.js"></script>
	</body>
</html>
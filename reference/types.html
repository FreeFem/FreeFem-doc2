<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Types</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">Types</a><ul>
<li><a class="reference internal" href="#standard-types">Standard types</a><ul>
<li><a class="reference internal" href="#int">int</a></li>
<li><a class="reference internal" href="#bool">bool</a></li>
<li><a class="reference internal" href="#real">real</a></li>
<li><a class="reference internal" href="#complex">complex</a></li>
<li><a class="reference internal" href="#string">string</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mesh-design">Mesh design</a><ul>
<li><a class="reference internal" href="#border">border</a></li>
<li><a class="reference internal" href="#mesh">mesh</a></li>
<li><a class="reference internal" href="#mesh3">mesh3</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finite-element-space-design">Finite element space design</a><ul>
<li><a class="reference internal" href="#fespace">fespace</a></li>
</ul>
</li>
<li><a class="reference internal" href="#macro-design">Macro design</a><ul>
<li><a class="reference internal" href="#macro">macro</a></li>
<li><a class="reference internal" href="#newmacro-endmacro">NewMacro / EndMacro</a></li>
<li><a class="reference internal" href="#ifmacro">IFMACRO</a></li>
<li><a class="reference internal" href="#endifmacro">ENDIFMACRO</a></li>
</ul>
</li>
<li><a class="reference internal" href="#functions-design">Functions design</a><ul>
<li><a class="reference internal" href="#func">func</a></li>
<li><a class="reference internal" href="#elementary-functions">Elementary functions</a></li>
<li><a class="reference internal" href="#random-functions">Random functions</a></li>
<li><a class="reference internal" href="#fe-functions">FE-functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#problem-design">Problem design</a><ul>
<li><a class="reference internal" href="#problem">problem</a></li>
<li><a class="reference internal" href="#solve">solve</a></li>
<li><a class="reference internal" href="#varf">varf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#array">Array</a><ul>
<li><a class="reference internal" href="#array-index">Array index</a></li>
<li><a class="reference internal" href="#array-size">Array size</a></li>
<li><a class="reference internal" href="#array-sort">Array sort</a></li>
<li><a class="reference internal" href="#double-array">Double array</a></li>
<li><a class="reference internal" href="#array-of-fe-functions">Array of FE functions</a></li>
<li><a class="reference internal" href="#map-arrays">Map arrays</a></li>
</ul>
</li>
<li><a class="reference internal" href="#matrix">matrix</a><ul>
<li><a class="reference internal" href="#matrix-size">Matrix size</a></li>
<li><a class="reference internal" href="#matrix-resize">Matrix resize</a></li>
<li><a class="reference internal" href="#matrix-diagonal">Matrix diagonal</a></li>
<li><a class="reference internal" href="#matrix-renumbering">Matrix renumbering</a></li>
<li><a class="reference internal" href="#complex-matrix">Complex matrix</a></li>
<li><a class="reference internal" href="#dot-product-outer-product">Dot product / Outer product</a></li>
<li><a class="reference internal" href="#matrix-inversion">Matrix inversion</a></li>
</ul>
</li>
</ul>
</li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="section" id="types">
<span id="referencetypes"></span><h1>Types<a class="headerlink" href="#types" title="Permalink to this headline">¶</a></h1>
<div class="section" id="standard-types">
<h2>Standard types<a class="headerlink" href="#standard-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="int">
<h3>int<a class="headerlink" href="#int" title="Permalink to this headline">¶</a></h3>
<p>Integer value (equivalent to <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="kt">long</span></code> in <code class="docutils literal highlight highlight-default"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="bool">
<h3>bool<a class="headerlink" href="#bool" title="Permalink to this headline">¶</a></h3>
<p>Boolean value.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="n">b</span> <span class="o">=</span> <span class="kr">true</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The result of a comparison is a boolean</p>
<p class="last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">bool</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">);</span></code></p>
</div>
</div>
<div class="section" id="real">
<h3>real<a class="headerlink" href="#real" title="Permalink to this headline">¶</a></h3>
<p>Real value (equivalent to <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="kt">double</span></code> in <code class="docutils literal highlight highlight-default"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="complex">
<h3>complex<a class="headerlink" href="#complex" title="Permalink to this headline">¶</a></h3>
<p>Complex value (equivalent to two <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="kt">double</span></code> or <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span></code> in <code class="docutils literal highlight highlight-default"><span></span><span class="n">C</span><span class="o">++</span></code>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">complex</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="p">;</span>
</pre></div>
</div>
<p>The imaginary number <span class="math notranslate nohighlight">\(i\)</span> is defined as <code class="docutils literal highlight highlight-default"><span></span><span class="mi">1</span><span class="n">i</span></code></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Example</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">complex</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="n">i</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a + b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a - b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a*b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;a/b = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The output of this script is:</p>
<div class="last highlight-bash notranslate"><div class="highlight"><pre><span></span>a + <span class="nv">b</span> <span class="o">=</span> <span class="o">(</span><span class="m">2</span>,4<span class="o">)</span>
a - <span class="nv">b</span> <span class="o">=</span> <span class="o">(</span>-2,-2<span class="o">)</span>
a*b <span class="o">=</span> <span class="o">(</span>-3,2<span class="o">)</span>
a/b <span class="o">=</span> <span class="o">(</span><span class="m">0</span>.230769,0.153846<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="../example/index.html#examplecomplex"><span class="std std-ref">Complex example</span></a> for a detailed example.</p>
</div>
</div>
<div class="section" id="string">
<h3>string<a class="headerlink" href="#string" title="Permalink to this headline">¶</a></h3>
<p>String value.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;this is a string&quot;</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">string</span></code> value is enclosed within double quotes.</p>
</div>
<p>Other types can be concatenate to a string, like:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span>
<span class="kt">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;the int i = &quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span><span class="s">&quot;, the real r = &quot;</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="s">&quot;, the complex z = &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="p">);</span>
</pre></div>
</div>
<p>To append a string in a string at position 4:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s">&quot;+++&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>To copy a substring in an other string:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="p">(</span><span class="mi">5</span><span class="o">:</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../example/index.html#examplestring"><span class="std std-ref">String Example</span></a> for a complete example.</p>
</div>
</div>
<div class="section" id="mesh-design">
<h2>Mesh design<a class="headerlink" href="#mesh-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="border">
<h3>border<a class="headerlink" href="#border" title="Permalink to this headline">¶</a></h3>
<p>Border type.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);}</span>
</pre></div>
</div>
<p>Define the 2D geometrical border in parametric coordinates.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Label</p>
<p>A label can be defined with the border:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">);</span> <span class="kr">label</span><span class="o">=</span><span class="mi">1</span><span class="p">;}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Inner variable</p>
<p>An inner variable can be defined inside a border:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">){</span><span class="kt">real</span> <span class="n">tt</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="kr">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">;</span> <span class="kr">x</span><span class="o">=</span><span class="nf">cos</span><span class="p">(</span><span class="n">tt</span><span class="p">);</span> <span class="kr">y</span><span class="o">=</span><span class="nf">sin</span><span class="p">(</span><span class="n">tt</span><span class="p">);}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>From vector</p>
<p>A border can be defined from two vectors using :freefem`P.x` and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">P</span><span class="p">.</span><span class="kr">y</span></code>:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vectorX</span><span class="p">.</span><span class="kr">n</span><span class="o">-</span><span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="n">vectorX</span><span class="p">[</span><span class="kp">t</span><span class="p">];</span> <span class="kr">P</span><span class="p">.</span><span class="kr">x</span><span class="o">=</span><span class="n">vectorY</span><span class="p">[</span><span class="kp">t</span><span class="p">];}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mesh">
<h3>mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h3>
<p>2D Mesh type (see <a class="reference internal" href="../documentation/meshGeneration.html#meshgeneration"><span class="std std-ref">Mesh Generation</span></a>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">mesh</span> <span class="n">Th</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="mesh3">
<h3>mesh3<a class="headerlink" href="#mesh3" title="Permalink to this headline">¶</a></h3>
<p>3D mesh type (see <a class="reference internal" href="../documentation/meshGeneration.html#meshgeneration"><span class="std std-ref">Mesh Generation</span></a>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">mesh3</span> <span class="n">Th</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="finite-element-space-design">
<h2>Finite element space design<a class="headerlink" href="#finite-element-space-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fespace">
<h3>fespace<a class="headerlink" href="#fespace" title="Permalink to this headline">¶</a></h3>
<p>Finite element space type (see <a class="reference internal" href="../documentation/finiteElement.html#finiteelement"><span class="std std-ref">Finite Element</span></a>).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Uh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="kt">fespace</span> <span class="nf">UPh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]);</span>
</pre></div>
</div>
<p>A finite element space is based on a mesh (<code class="docutils literal highlight highlight-default"><span></span><span class="n">Th</span></code>) with an element definition, scalar (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span></code>) or vector (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]</span></code>).</p>
<p><strong>Available finite element space:</strong></p>
<p>Generic:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0</span> <span class="o">/</span> <span class="nc">P03d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P0Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1</span> <span class="o">/</span> <span class="nc">P13d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1dc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1b</span> <span class="o">/</span> <span class="nc">P1b3d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1bl</span> <span class="o">/</span> <span class="nc">P1bl3d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1nc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2</span> <span class="o">/</span> <span class="nc">P23d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2b</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2dc</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2h</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT0</span> <span class="o">/</span> <span class="nc">RT03d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT0Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge03d</span></code></li>
</ul>
<p>Using <em>Element_P3</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3</span></code></li>
</ul>
<p>Using <em>Element_P3dc</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3dc</span></code></li>
</ul>
<p>Using <em>Element_P4</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4</span></code></li>
</ul>
<p>Using <em>Element_P4dc</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4dc</span></code></li>
</ul>
<p>Using <em>Element_PkEdge</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P1Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P3Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P4Edge</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P5Edge</span></code></li>
</ul>
<p>Using <em>Morlay</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2Morley</span></code></li>
</ul>
<p>Using <em>HCT</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">HCT</span></code></li>
</ul>
<p>Using <em>BernardiRaugel</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">P2BR</span></code></li>
</ul>
<p>Using <em>Element_Mixte</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT1</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT1Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT2</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">RT2Ortho</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">BDM1</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">BDM1Ortho</span></code></li>
</ul>
<p>Using <em>Element_Mixte3d</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge13d</span></code></li>
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">Edge23d</span></code></li>
</ul>
<p>Using <em>Element_QF</em>:</p>
<ul class="simple">
<li><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nc">FEQF</span></code></li>
</ul>
<p>A finite element function is defined as follow:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">fespace</span> <span class="nf">Uh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Uh</span> <span class="n">u</span><span class="p">;</span>

<span class="kt">fespace</span> <span class="nf">UPh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="p">[</span><span class="nc">P2</span><span class="p">,</span> <span class="nc">P2</span><span class="p">,</span> <span class="nc">P1</span><span class="p">]);</span>
<span class="n">UPh</span> <span class="p">[</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">,</span> <span class="n">p</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="macro-design">
<span id="typemacrodesign"></span><h2>Macro design<a class="headerlink" href="#macro-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="macro">
<h3>macro<a class="headerlink" href="#macro" title="Permalink to this headline">¶</a></h3>
<p>Macro type.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="n">vU</span><span class="p">()</span> <span class="p">[</span><span class="n">Ux</span><span class="p">,</span> <span class="n">Uy</span><span class="p">]</span> <span class="c1">//</span>
<span class="kt">macro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="c1">//</span>
</pre></div>
</div>
<p>Macro ends with <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="c1">//</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Macro concatenation</p>
<p>You can use the C concatenation operator <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="cp">##</span></code> inside a macro using <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="o">#</span><span class="cp"></span></code>.</p>
<p>If <cite>Ux</cite> and <cite>Uy</cite> are defined as finite element function, you can define:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">macro</span> <span class="n">Grad</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="p">[</span><span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">x</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">U</span><span class="o">#</span><span class="kr">y</span><span class="p">)]</span> <span class="c1">// End of macro</span>
</pre></div>
</div>
</div>
<p>See <a class="reference internal" href="../example/index.html#examplemacro"><span class="std std-ref">Macro example</span></a></p>
</div>
<div class="section" id="newmacro-endmacro">
<h3>NewMacro / EndMacro<a class="headerlink" href="#newmacro-endmacro" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In developement - Not tested</p>
</div>
<p>Set and end a macro</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">NewMacro</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="p">[</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="kt">EndMacro</span>
</pre></div>
</div>
</div>
<div class="section" id="ifmacro">
<h3>IFMACRO<a class="headerlink" href="#ifmacro" title="Permalink to this headline">¶</a></h3>
<p>Check if a macro exists and check its value.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="cp">IFMACRO</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span> <span class="c1">//check if macro AA exists</span>
<span class="p">...</span>
<span class="cp">ENDIFMACRO</span>

<span class="cp">IFMACRO</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span> <span class="c1">//check if amcro exists and is equall to tt</span>
<span class="p">...</span>
<span class="cp">ENDIFMACRO</span>
</pre></div>
</div>
</div>
<div class="section" id="endifmacro">
<h3>ENDIFMACRO<a class="headerlink" href="#endifmacro" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="functions-design">
<h2>Functions design<a class="headerlink" href="#functions-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="func">
<h3>func<a class="headerlink" href="#func" title="Permalink to this headline">¶</a></h3>
<p>Function type.</p>
<p>Function without parameters (<span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are implicitly considered):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Function’s type is defined by the expression’s type.</p>
</div>
<p>Function with parameters:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span> <span class="nf">f</span> <span class="p">(</span><span class="kt">real</span> <span class="n">var</span><span class="p">){</span>
    <span class="k">return</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">var</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="elementary-functions">
<span id="typeelementaryfunctions"></span><h3>Elementary functions<a class="headerlink" href="#elementary-functions" title="Permalink to this headline">¶</a></h3>
<p>Class of basic functions (polynomials, exponential, logarithmic, trigonometric, circular) and the functions obtained from those by the four arithmetic operations</p>
<div class="math notranslate nohighlight">
\[f(x) + g(x),\, f(x) - g(x),\, f(x)g(x),\, f(x)/g(x)\]</div>
<p>and by composition <span class="math notranslate nohighlight">\(f(g(x))\)</span>, each applied a finite number of times.</p>
<p>In <strong>FreeFem++</strong>, all elementary functions can thus be created.
The derivative of an elementary function is also an elementary function; however, the indefinite integral of an elementary function cannot always be expressed in terms of elementary functions.</p>
<p>See <a class="reference internal" href="../example/index.html#exampleelementaryfunction"><span class="std std-ref">Elementary function example</span></a> for a complete example.</p>
</div>
<div class="section" id="random-functions">
<h3>Random functions<a class="headerlink" href="#random-functions" title="Permalink to this headline">¶</a></h3>
<p><strong>FreeFem++</strong> includes the <a class="reference external" href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">Mersenne Twister</a> random number generator.
It is a very fast and accurate random number generator of period <span class="math notranslate nohighlight">\(2^{219937}-1\)</span>.</p>
<p>See <a class="reference internal" href="functions.html#referencerandint32"><span class="std std-ref">randint32()</span></a>, <a class="reference internal" href="functions.html#referencerandint31"><span class="std std-ref">randint31()</span></a>, <a class="reference internal" href="functions.html#referencerandreal1"><span class="std std-ref">randreal1()</span></a>, <a class="reference internal" href="functions.html#referencerandreal2"><span class="std std-ref">randreal2()</span></a>, <a class="reference internal" href="functions.html#referencerandreal3"><span class="std std-ref">randreal3()</span></a>, <a class="reference internal" href="functions.html#referencerandres53"><span class="std std-ref">randres53()</span></a>, <a class="reference internal" href="functions.html#referencerandinit"><span class="std std-ref">randinit(seed)</span></a>.</p>
<p>In addition, the <code class="docutils literal highlight highlight-default"><span></span><span class="n">ffrandom</span></code> plugin interface <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">random</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandom</span></code> and <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandomdev</span></code> functions of the Unix <code class="docutils literal highlight highlight-default"><span></span><span class="n">libc</span></code> library.
The range is <span class="math notranslate nohighlight">\(0 -- 2^{31}-1\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">srandomdev</span></code> is not defined, a seed based on the current time is used.</p>
</div>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">gsl</span></code> plugin equally allows usage of all random functions of the <code class="docutils literal highlight highlight-default"><span></span><span class="n">gsllib</span></code>, see <a class="reference internal" href="externalLibraries.html#referenceffgslawk"><span class="std std-ref">gsl external library</span></a>.</p>
</div>
<div class="section" id="fe-functions">
<h3>FE-functions<a class="headerlink" href="#fe-functions" title="Permalink to this headline">¶</a></h3>
<p>Finite element functions are also constructed like elementary functions by an arithmetic formula involving elementary functions.</p>
<p>The difference is that they are evaluated at declaration time and <strong>FreeFem++</strong> stores the array of its values at the places associated with he degree of freedom of the finite element type.
By opposition, elementary functions are evaluated only when needed.
Hence FE-functions are not defined only by their formula but also by the mesh and the finite element which enter in their definitions.</p>
<p>If the value of a FE-function is requested at a point which is not a degree of freedom, an interpolation is used, leading to an interpolation error, while by contrast, an elementary function can be evaluated at any point exactly.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="n">f</span> <span class="o">=</span> <span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span> <span class="c1">// ]-2, 2[^2</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">fh</span><span class="o">=</span><span class="n">f</span><span class="p">;</span> <span class="c1">//fh is the projection of f to Vh (real value)</span>
<span class="kt">func</span> <span class="n">zf</span> <span class="o">=</span> <span class="p">(</span><span class="kr">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="kr">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="kr">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nf">exp</span><span class="p">(</span><span class="kr">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">i</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Vh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">zh</span> <span class="o">=</span> <span class="n">zf</span><span class="p">;</span> <span class="c1">//zh is the projection of zf to complex value Vh space</span>
</pre></div>
</div>
<p>The construction of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">fh</span> <span class="o">=</span> <span class="n">f</span></code> is explained in <a class="reference internal" href="../documentation/finiteElement.html#finiteelement"><span class="std std-ref">Finite Element</span></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">plot</span></code> command only works for real or complex FE-functions, not for elementary functions.</p>
</div>
</div>
</div>
<div class="section" id="problem-design">
<span id="typeproblemdesign"></span><h2>Problem design<a class="headerlink" href="#problem-design" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem">
<span id="typeproblem"></span><h3>problem<a class="headerlink" href="#problem" title="Permalink to this headline">¶</a></h3>
<p>Problem type.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p><strong>FreeFem++</strong> needs the variational form in the problem definition.</p>
<p>In order to solve the problem, just call:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="n">Laplacian</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Solver</p>
<p>A solver can be specified in the problem definition:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p>The default solver is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">sparsesolver</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code> if any direct sparse solver is available.</p>
<p class="last">Solvers are listed in the <a class="reference internal" href="globalVariables.html#globalvariables"><span class="std std-ref">Global variables</span></a> section.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Stop test</p>
<p>A criterion <span class="math notranslate nohighlight">\(\varepsilon\)</span> can be defined for iterative methods, like CG for example:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">CG</span><span class="p">,</span> <span class="kp">eps</span><span class="o">=</span><span class="mf">1.e-6</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span>, the stop test is:</p>
<div class="math notranslate nohighlight">
\[||Ax-b|| &lt; \varepsilon\]</div>
<p>Else, the stop test is:</p>
<div class="last math notranslate nohighlight">
\[||Ax-b|| &lt; \frac{|\varepsilon|}{||Ax_0-b||}\]</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Reconstruction</p>
<p>The keyword <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span></code> controls the reconstruction of the internal problem matrix.</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">init</span></code> is set to <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">false</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="mi">0</span></code>, the matrix is reconstructed et each problem calls (or after a mesh modification), else the previously constructed matrix is used.</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">init</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Preconditioning</p>
<p>A preconditioner can be specified in the problem definition:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">precon</span><span class="o">=</span><span class="kr">P</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p>The preconditioning function must have a prototype like:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">func</span> <span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kr">P</span><span class="p">(</span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="o">&amp;</span><span class="n">xx</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>“<em>Très grande valeur</em>”</p>
<p>The “<em>Très grand valeur</em>” <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">tgv</span></code> (or <em>Terrible giant value</em>) used to implement the Dirichlet conditions can be modified in the problem definition:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">tgv</span><span class="o">=</span><span class="mf">1e30</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p class="last">Refere to <a class="reference internal" href="../documentation/finiteElement.html#problemdefinition"><span class="std std-ref">Problem definition</span></a> for a description of the Dirichlet condition implementation.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pivot tolerance</p>
<p>The tolerance of the pivot in <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> factorization can be modified in the problem definition:</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">tolpivot</span><span class="o">=</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p>
<p>Two specific parameters for the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code> can be modifed:</p>
<ul class="simple">
<li>Tolerance of the pivot sym</li>
<li>strategy</li>
</ul>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">problem</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">tolpivotsym</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="kp">strategy</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p class="last">Refer to the <a class="reference external" href="http://faculty.cse.tamu.edu/davis/research.html">UMFPACK website</a> for more informations.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">dimKrylov</span></code></p>
<p class="last">Dimension of the Krylov space</p>
</div>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">problem</span></code> is detailled in the <a class="reference internal" href="../tutorial/index.html#tutorial"><span class="std std-ref">tutorials</span></a>.</p>
</div>
<div class="section" id="solve">
<span id="typesolve"></span><h3>solve<a class="headerlink" href="#solve" title="Permalink to this headline">¶</a></h3>
<p>Solve type.</p>
<p>Identical to <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a> but automatically solved.</p>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">solve</span></code> is detailled in the <a class="reference internal" href="../tutorial/index.html#tutorial"><span class="std std-ref">tutorials</span></a>.</p>
</div>
<div class="section" id="varf">
<span id="typevarf"></span><h3>varf<a class="headerlink" href="#varf" title="Permalink to this headline">¶</a></h3>
<p>Variational form type.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">varf</span> <span class="n">vLaplacian</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">uh</span><span class="p">)</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<p>Directly define a variational form.</p>
<p>This is the other way to define a problem in order to directly manage matrix and right hang side.</p>
<p>Usage of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">varf</span></code> is detailed in the <a class="reference internal" href="../tutorial/index.html#tutorial"><span class="std std-ref">tutorial</span></a>.</p>
</div>
</div>
<div class="section" id="array">
<h2>Array<a class="headerlink" href="#array" title="Permalink to this headline">¶</a></h2>
<p>An array stores multiple objects, and there are 2 kinds of arrays:</p>
<ul class="simple">
<li>the first is similar to vector, i.e.&nbsp;array with integer indices</li>
<li>the second is array with string indices</li>
</ul>
<p>In the first case, the size of the array must be known at execution time, and implementation is done with the <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">KN</span><span class="o">&lt;&gt;</span></code> class and all the vector operator of <code class="code cpp docutils literal highlight highlight-cpp"><span></span><span class="n">KN</span><span class="o">&lt;&gt;</span></code> are implemented.</p>
<p>Arrays can be set like in Matlab or Scilab with the operator <code class="docutils literal highlight highlight-default"><span></span><span class="p">::</span></code>, the array generator of <code class="docutils literal highlight highlight-default"><span></span><span class="n">a</span><span class="p">:</span><span class="n">c</span></code> is equivalent to <code class="docutils literal highlight highlight-default"><span></span><span class="n">a</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">c</span></code>, and the array set by <code class="docutils literal highlight highlight-default"><span></span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="p">:</span><span class="n">c</span></code> is set to size <span class="math notranslate nohighlight">\(\lfloor |(b-a)/c|+1 \rfloor\)</span> and the value <span class="math notranslate nohighlight">\(i\)</span> is set by <span class="math notranslate nohighlight">\(a + i (b-a)/c\)</span>.</p>
<p>There are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span> <span class="kt">complex</span></code> array with, in the third case, two operators (<code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">im</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="p">.</span><span class="kr">re</span></code>) to generate the real and imaginary real array from the complex array (without copy).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Quantiles are points taken at regular intervals from the cumulative distribution function of a random variable.
Here the array values are random.</p>
<p>This statistical function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">a</span><span class="p">.</span><span class="kr">quantile</span><span class="p">(</span><span class="n">q</span><span class="p">)</span></code> computes <span class="math notranslate nohighlight">\(v\)</span> from an array <span class="math notranslate nohighlight">\(a\)</span> of size <span class="math notranslate nohighlight">\(n\)</span> for a given number <span class="math notranslate nohighlight">\(q\in ]0,1[\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\#\{ i / a[i] &lt; v \} \sim q*n\]</div>
<p class="last">it is equivalent to <span class="math notranslate nohighlight">\(v = a[q*n]\)</span> when the array <span class="math notranslate nohighlight">\(a\)</span> is sorted.</p>
</div>
<p>For example, to declare, fill and display an array of <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span></code> of size <code class="docutils literal highlight highlight-default"><span></span><span class="n">n</span></code>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Ai</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="kr">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">Ai</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Ai</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The output of this script is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">5</span>
      <span class="m">0</span>   <span class="m">1</span>   <span class="m">2</span>   <span class="m">3</span>   <span class="m">4</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../example/index.html#examplearray"><span class="std std-ref">Array example</span></a> for a complete example.</p>
<div class="section" id="array-index">
<h3>Array index<a class="headerlink" href="#array-index" title="Permalink to this headline">¶</a></h3>
<p>Array index can be int or string:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Ai</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="kt">real</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span> <span class="n">As</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="array-size">
<h3>Array size<a class="headerlink" href="#array-size" title="Permalink to this headline">¶</a></h3>
<p>The size of an array is obtained using the keyword <code class="docutils literal highlight highlight-default"><span></span><span class="n">n</span></code>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ArraySize</span> <span class="o">=</span> <span class="n">Ai</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="array-sort">
<h3>Array sort<a class="headerlink" href="#array-sort" title="Permalink to this headline">¶</a></h3>
<p>To sort an array:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="n">Ai</span><span class="p">.</span><span class="nf">sort</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="double-array">
<h3>Double array<a class="headerlink" href="#double-array" title="Permalink to this headline">¶</a></h3>
<p>A double array (matrix) can be defined using two indexes:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">]</span> <span class="n">Aii</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]];</span>
</pre></div>
</div>
<p>The two sizes are obtained using the keywords <code class="docutils literal highlight highlight-default"><span></span><span class="n">n</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="n">m</span></code>:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">ArraySize1</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">ArraySize2</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
</pre></div>
</div>
<p>The minimum and maximum values of an array (simple or double) can be obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="n">ArrayMin</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">min</span><span class="p">;</span>
<span class="kt">real</span> <span class="n">ArrayMax</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span>
</pre></div>
</div>
<p>Th minimum and maximum position of an array can be obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">mini</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">imin</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">minj</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="n">jmin</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">maxi</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="kr">imax</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">maxj</span> <span class="o">=</span> <span class="n">Aii</span><span class="p">.</span><span class="n">jmax</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>An array can be obtained from a finite element function using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">aU</span> <span class="o">=</span> <span class="n">U</span><span class="p">[];</span>
</pre></div>
</div>
<p class="last">where <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">U</span></code> is a finite element function.</p>
</div>
</div>
<div class="section" id="array-of-fe-functions">
<h3>Array of FE functions<a class="headerlink" href="#array-of-fe-functions" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to make an array of FE functions, with the same syntax, and we can treat them as vector valued function if we need them.</p>
<p>The syntax for space or vector finite function is</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="kr">n</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">//size of the array.</span>
<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">wh</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//real scalar case</span>
<span class="n">Wh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">uh</span><span class="p">,</span><span class="n">vh</span><span class="p">](</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//real vectorial case</span>
<span class="n">Vh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">cwh</span><span class="p">(</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//complex scalar case</span>
<span class="n">Wh</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="p">[</span><span class="n">cuh</span><span class="p">,</span> <span class="n">cvh</span><span class="p">](</span><span class="kr">n</span><span class="p">);</span> <span class="c1">//complex vectorial case</span>
<span class="p">[</span><span class="n">cuh</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cvh</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="kr">x</span><span class="p">,</span> <span class="kr">y</span><span class="p">];</span> <span class="c1">//set interpolation of index 2</span>

<span class="c1">// Array of Array</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="n">V</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="kt">matrix</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="kp">B</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="kt">real</span> <span class="p">[</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">][</span><span class="kt">int</span><span class="p">]</span> <span class="kp">A</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Example</p>
<p>In the following example, Poisson’s equation is solved for 3 different given functions <span class="math notranslate nohighlight">\(f=1,\, \sin(\pi x)\cos(\pi y),\, |x-1||y-1|\)</span>, whose solutions are stored in an array of FE function.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">mesh</span> <span class="n">Th</span> <span class="o">=</span> <span class="nf">square</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="kr">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="kr">y</span><span class="p">]);</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Vh</span><span class="p">(</span><span class="n">Th</span><span class="p">,</span> <span class="nc">P1</span><span class="p">);</span>
<span class="n">Vh</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">;</span>

<span class="c1">// Problem</span>
<span class="kt">problem</span> <span class="nf">Poisson</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
          <span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">Th</span><span class="p">)(</span>
        <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="n">Vh</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">uu</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">//an array of FE function</span>
<span class="c1">// Solve problem 1</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
<span class="c1">// Solve problem 2</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">sin</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">x</span><span class="p">)</span><span class="o">*</span><span class="nf">cos</span><span class="p">(</span><span class="kr">pi</span><span class="o">*</span><span class="kr">y</span><span class="p">);</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
<span class="c1">// Solve problem 3</span>
<span class="n">f</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="kr">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="kr">y</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">Poisson</span><span class="p">;</span>
<span class="n">uu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>

<span class="c1">// Plot</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nf">plot</span><span class="p">(</span><span class="n">uu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../example/index.html#examplefearray"><span class="std std-ref">FE array example</span></a>.</p>
</div>
</div>
<div class="section" id="map-arrays">
<h3>Map arrays<a class="headerlink" href="#map-arrays" title="Permalink to this headline">¶</a></h3>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span> <span class="n">map</span><span class="p">;</span> <span class="c1">//a dynamic array</span>

<span class="n">map</span><span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">map</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span> <span class="c1">//2 is automatically cast to the string &quot;2&quot;</span>

<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;map[</span><span class="se">\&quot;</span><span class="s">1</span><span class="se">\&quot;</span><span class="s">] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">map</span><span class="p">[</span><span class="s">&quot;1&quot;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;map[2] = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">map</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>It is just a map of the standard template library so no operations on vector are allowed, except the selection of an item.</p>
</div>
</div>
<div class="section" id="matrix">
<span id="typematrix"></span><h2>matrix<a class="headerlink" href="#matrix" title="Permalink to this headline">¶</a></h2>
<p>Defines a sparse matrix.</p>
<p>Matrices can be defined like vectors:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]];</span>
</pre></div>
</div>
<p>or using a variational form type (see <a class="reference internal" href="../documentation/finiteElement.html#variationalformsparsematrixpde"><span class="std std-ref">Finite Element</span></a>):</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="n">Laplacian</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">);</span>
</pre></div>
</div>
<p>or from block of matrices:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A1</span><span class="p">,</span> <span class="p">...,</span> <span class="n">An</span><span class="p">;</span>
<span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">[[</span><span class="kp">A1</span><span class="p">,</span> <span class="p">...],</span> <span class="p">...,</span> <span class="p">[...,</span> <span class="n">An</span><span class="p">]];</span>
</pre></div>
</div>
<p>or using sparse matrix set:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kp">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">C</span><span class="p">];</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal highlight highlight-default"><span></span><span class="n">I</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="n">J</span></code> are <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="n">C</span></code> is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span></code>. The matrix is defined as:</p>
<div class="math notranslate nohighlight">
\[A = \sum_k{C[k]M_{I[k], J[k]}}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{a, b} = \left(\delta_{ia}\delta_{jb}\right)_{ij}\)</span></p>
<p><cite>I</cite>, <cite>J</cite> and <cite>C</cite> can be retrieved using <cite>[I, J, C] = A</cite> (arrays are automatically resized).</p>
<p class="last">The size of the matrix is <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">n</span> <span class="o">=</span> <span class="n">I</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">m</span> <span class="o">=</span> <span class="n">J</span><span class="p">.</span><span class="kr">max</span><span class="p">;</span></code>.</p>
</div>
<p>Matrices are designed using templates, so they can be real or complex:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">real</span><span class="o">&gt;</span> <span class="kp">A</span> <span class="o">=</span> <span class="p">...</span>
<span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">Ai</span> <span class="o">=</span> <span class="p">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Solver</p>
<p>See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
<p>The default solver is <a class="reference internal" href="globalVariables.html#globalvariablesgmres"><span class="std std-ref">GMRES</span></a>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>
</pre></div>
</div>
<p>or</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="nf">set</span><span class="p">(</span><span class="kp">A</span> <span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">sparsesolver</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Factorize</p>
<p>If <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">true</span></code>, the factorization is done for <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">LU</span></code>, <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Cholesky</span></code> or <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">Crout</span></code>.</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="kp">A</span> <span class="o">=</span> <span class="n">vLaplacian</span><span class="p">(</span><span class="n">Uh</span><span class="p">,</span> <span class="n">Uh</span><span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>or</p>
<div class="last highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="nf">set</span><span class="p">(</span><span class="kp">A</span> <span class="p">,</span> <span class="kp">solver</span><span class="o">=</span><span class="kr">LU</span><span class="p">,</span> <span class="kp">factorize</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Stop test</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><em>Très grande valeur</em></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Preconditioning</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pivot tolerance</p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">UMFPACK</span></code></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">dimKrylov</span></code></p>
<p class="last">See <a class="reference internal" href="#typeproblem"><span class="std std-ref">problem</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>datafilename</p>
<p class="last">Name of the file containing solver parameters, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">lparams</span></code></p>
<p class="last">Vector of integer parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">dparams</span></code></p>
<p class="last">Vector of real parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">sparams</span></code></p>
<p class="last">String parameters for the solver, see <a class="reference internal" href="../documentation/parallelization.html#parallelsparsesolvers"><span class="std std-ref">Parallel sparse solvers</span></a></p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">To modify the <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kp">solver</span></code>, the stop test,… after the matrix construction, use the <a class="reference internal" href="functions.html#functionset"><span class="std std-ref">set keyword</span></a>.</p>
</div>
<div class="section" id="matrix-size">
<h3>Matrix size<a class="headerlink" href="#matrix-size" title="Permalink to this headline">¶</a></h3>
<p>The size of a matrix is obtain using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">NRows</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">NColumns</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">m</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="matrix-resize">
<h3>Matrix resize<a class="headerlink" href="#matrix-resize" title="Permalink to this headline">¶</a></h3>
<p>To resize a matrix, use:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kp">A</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="kr">n</span><span class="p">,</span> <span class="kr">m</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When resizing, all new terms are set to zero.</p>
</div>
</div>
<div class="section" id="matrix-diagonal">
<h3>Matrix diagonal<a class="headerlink" href="#matrix-diagonal" title="Permalink to this headline">¶</a></h3>
<p>The diagonal of the matrix is obtained using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">Aii</span> <span class="o">=</span> <span class="kp">A</span><span class="p">.</span><span class="kr">diag</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="matrix-renumbering">
<h3>Matrix renumbering<a class="headerlink" href="#matrix-renumbering" title="Permalink to this headline">¶</a></h3>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span> <span class="n">I</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">J</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span>
<span class="kt">matrix</span> <span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">;</span>
<span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">);</span>
<span class="kp">B</span> <span class="o">=</span> <span class="kp">A</span><span class="p">(</span><span class="n">I</span><span class="o">^-</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="o">^-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="complex-matrix">
<h3>Complex matrix<a class="headerlink" href="#complex-matrix" title="Permalink to this headline">¶</a></h3>
<p>Use <code class="docutils literal highlight highlight-default"><span></span><span class="o">.</span><span class="n">im</span></code> and <code class="docutils literal highlight highlight-default"><span></span><span class="o">.</span><span class="n">re</span></code> to get the imaginary and real part of a complex matrix, respectively:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span><span class="o">&lt;</span><span class="kt">complex</span><span class="o">&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="p">...</span>
<span class="kt">matrix</span> <span class="n">R</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="kr">re</span><span class="p">;</span>
<span class="kt">matrix</span> <span class="n">I</span> <span class="o">=</span> <span class="n">C</span><span class="p">.</span><span class="kr">im</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="dot-product-outer-product">
<h3>Dot product / Outer product<a class="headerlink" href="#dot-product-outer-product" title="Permalink to this headline">¶</a></h3>
<p>The dot product of two matrices is realized using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">real</span> <span class="nf">d</span> <span class="o">=</span> <span class="kp">A</span><span class="o">&#39;</span> <span class="o">*</span> <span class="kp">B</span><span class="p">;</span>
</pre></div>
</div>
<p>The outer product of two matrices is realized using:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="kt">matrix</span> <span class="n">C</span> <span class="o">=</span> <span class="kp">A</span> <span class="o">*</span> <span class="kp">B</span><span class="o">&#39;</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../example/index.html#examplematrixoperations"><span class="std std-ref">Matrix operations example</span></a> for a complete example.</p>
</div>
<div class="section" id="matrix-inversion">
<h3>Matrix inversion<a class="headerlink" href="#matrix-inversion" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../example/index.html#examplematrixinversion"><span class="std std-ref">Matrix inversion example</span></a>.</p>
</div>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>
<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Transmission problem</title>
		<link rel="icon" href="../_static/img/favicon.png">

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

		<!-- Google font -->
		<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

		<!-- FreeFem++ theme specific -->
		<link rel="stylesheet" type="text/css" href="../_static/css/freefemtheme.css" />

		<!-- css -->
		<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

		<!-- js -->
		<script src="../_static/nav.json"></script>
		<script src="../_static/js/nav.js"></script>
		<script src="../_static/js/common.js"></script>

		<!-- MathJax -->
		<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	</head>
	<body>
		<header>
			<div class="header-logo">
    <div>
        <a href="../introduction/introduction.html">
            <img alt="logo" title="FreeFem++ documentation" src="../_static/img/Logo.png" />
        </a>
    </div>
</div>
<div class="header-title">
    <div>
        <a href="../introduction/introduction.html">
            <h2>FreeFem++ documentation</h2>
        </a>
    </div>
</div>
<div class="header-github">
    <a href="https://github.com/FreeFem/FreeFem-sources">
        <div class="header-github-img">
            <img alt="GitHub" title="FreeFem++ on GitHub" src="../_static/img/GitHub-Mark-120px-plus.png" />
        </div>
        <div class="header-github-title">
            <div class="header-github-title-text">
                FreeFem++ on GitHub
            </div>
            <div class="header-github-title-stars">
                <span id="headerGithubStars"></span> stars - <span id="headerGithubForks"></span> forks
            </div>
        </div>
    </a>
</div>
<script src="../_static/js/github.js"></script>
		</header>
		
		<nav>
			<script>nav("../")</script>
			<div class="search">
				<script async src="../_static/js/lunr.js"></script>
<script async src="../_static/lunr_index.js"></script>

<script src="../_static/js/search.js"></script>

<div class="search">
    <input type="search" id="searchInput" placeholder="Search..." oninput="search(this.value);" />
    <div class="searchResults">
        <div id="resultCount">
        </div>
        <div id="searchResults">
        </div>
    </div>
</div>
			</div>
		</nav>
		

		
		<div class="container">
			<div class="toc" id="toc">
				<div>
					<ul>
<li><a class="reference internal" href="#">Transmission problem</a></li>
</ul>

				</div>
			</div>
			<div class="content">
				<div>
					
    <div class="math notranslate nohighlight">
\[\def\p{{\partial}}\]</div>
<div class="section" id="transmission-problem">
<h1>Transmission problem<a class="headerlink" href="#transmission-problem" title="Permalink to this headline">¶</a></h1>
<p>Consider an elastic plate whose displacement change vertically, which is made up of three plates of different materials, welded on each other.</p>
<p>Let <span class="math notranslate nohighlight">\(\Omega_i\)</span>, <span class="math notranslate nohighlight">\(i=1,2,3\)</span> be the domain occupied by <span class="math notranslate nohighlight">\(i\)</span>-th material with tension <span class="math notranslate nohighlight">\(\mu_i\)</span> (see <a class="reference internal" href="staticProblems.html#modelstatissoap"><span class="std std-ref">Soap film</span></a>).</p>
<p>The computational domain <span class="math notranslate nohighlight">\(\Omega\)</span> is the interior of <span class="math notranslate nohighlight">\(\overline{\Omega_1}\cup \overline{\Omega_2}\cup \overline{\Omega_3}\)</span>.
The vertical displacement <span class="math notranslate nohighlight">\(u(x,y)\)</span> is obtained from:</p>
<div class="math notranslate nohighlight" id="equation-eqn-transm">
<span class="eqno">(62)<a class="headerlink" href="#equation-eqn-transm" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{rcll}
    -\mu_i\Delta u &amp;=&amp; f &amp; \textrm{ in }\Omega_i\\
    \mu_i\p_n u|_{\Gamma_{i}} &amp;=&amp; -\mu_j\p_n u|_{\Gamma_{j}} &amp; \textrm{ on }\overline{\Omega_{i}}\cap\overline{\Omega_{j}} \textrm{ if }1\le i&lt; j\le 3
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\p_n u|_{\Gamma_{i}}\)</span> denotes the value of the normal derivative <span class="math notranslate nohighlight">\(\p_n u\)</span> on the boundary <span class="math notranslate nohighlight">\(\Gamma_i\)</span> of the domain <span class="math notranslate nohighlight">\(\Omega_i\)</span>.</p>
<p>By introducing the characteristic function <span class="math notranslate nohighlight">\(\chi_i\)</span> of <span class="math notranslate nohighlight">\(\Omega_i\)</span>, that is:</p>
<div class="math notranslate nohighlight">
\[\chi_i(x)=1\ \textrm{ if }x\in\Omega_i;\
\chi_i(x)=0\ \textrm{ if }x\not\in\Omega_i\]</div>
<p>we can easily rewrite <a class="reference internal" href="#equation-eqn-transm">(62)</a> to the weak form.
Here we assume that <span class="math notranslate nohighlight">\(u=0\)</span> on <span class="math notranslate nohighlight">\(\Gamma=\p\Omega\)</span>.</p>
<p>Transmission problem: For a given function <span class="math notranslate nohighlight">\(f\)</span>, find <span class="math notranslate nohighlight">\(u\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[a(u,v) = \ell(f,v) \textrm{ for all }v\in H^1_0(\Omega)\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
    a(u,v) &amp;=&amp; \int_{\Omega}\mu \nabla u\cdot \nabla v\nonumber\\
    \ell(f,v) &amp;=&amp; \int_{\Omega}fv\nonumber
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu=\mu_1\chi_1+\mu_2\chi_2+\mu_3\chi_3\)</span>.
Here we notice that <span class="math notranslate nohighlight">\(\mu\)</span> become the discontinuous function.</p>
<p>This example explains the definition and manipulation of <em>region</em>, i.e.&nbsp;sub-domains of the whole domain.
Consider this L-shaped domain with 3 diagonals as internal boundaries, defining 4 sub-domains:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Mesh</span>
<span class="kt">border</span> <span class="nf">a</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">b</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">c</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">d</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">e</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">f</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">i1</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">i2</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">border</span> <span class="nf">i3</span><span class="p">(</span><span class="kp">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">){</span><span class="kr">x</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="kp">t</span><span class="p">;</span> <span class="kr">y</span><span class="o">=</span><span class="kp">t</span><span class="p">;};</span>
<span class="kt">mesh</span> <span class="n">th</span> <span class="o">=</span> <span class="nf">buildmesh</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span><span class="nf">d</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">i1</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">i2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">i3</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>

<span class="c1">// Fespace</span>
<span class="kt">fespace</span> <span class="nf">Ph</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="nc">P0</span><span class="p">);</span> <span class="c1">//constant discontinuous functions / element</span>
<span class="n">Ph</span> <span class="n">reg</span><span class="o">=</span><span class="kr">region</span><span class="p">;</span> <span class="c1">//defined the P0 function associated to region number</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span> <span class="kp">value</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure" id="id1">
<img alt="../_images/TransmissionProblem_Region.png" src="../_images/TransmissionProblem_Region.png" />
<p class="caption"><span class="caption-number">Fig. 218 </span><span class="caption-text">The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">reg</span></code></span></p>
</div>
<p><code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="kr">region</span></code> is a keyword of <strong>FreeFem++</strong> which is in fact a variable depending of the current position (is not a function today, use <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">Ph</span> <span class="n">reg</span><span class="o">=</span><span class="kr">region</span><span class="p">;</span></code> to set a function).
This variable value returned is the number of the sub-domain of the current position.
This number is defined by <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="nf">buildmesh</span></code> which scans while building the mesh all its connected component.</p>
<p>So to get the number of a region containing a particular point one does:</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Characteristic function</span>
<span class="kt">int</span> <span class="n">nupper</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">);</span> <span class="c1">//get the region number of point (0.4,0.9)</span>
<span class="kt">int</span> <span class="n">nlower</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span> <span class="c1">//get the region number of point (0.4,0.1)</span>
<span class="kr">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;nlower = &quot;</span> <span class="o">&lt;&lt;</span>  <span class="n">nlower</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, nupper = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nupper</span><span class="o">&lt;&lt;</span> <span class="kr">endl</span><span class="p">;</span>
<span class="n">Ph</span> <span class="n">nu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nlower</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="kr">region</span><span class="o">==</span><span class="n">nupper</span><span class="p">);</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="kp">fill</span><span class="o">=</span><span class="kr">true</span><span class="p">,</span><span class="kp">wait</span><span class="o">=</span><span class="kr">true</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure" id="id2">
<img alt="../_images/TransmissionProblem_Nu.png" src="../_images/TransmissionProblem_Nu.png" />
<p class="caption"><span class="caption-number">Fig. 219 </span><span class="caption-text">The function <code class="code freefem docutils literal highlight highlight-freefem"><span></span><span class="n">nu</span></code></span></p>
</div>
<p>This is particularly useful to define discontinuous functions such as might occur when one part of the domain is copper and the other one is iron, for example.</p>
<p>We this in mind we proceed to solve a Laplace equation with discontinuous coefficients (<span class="math notranslate nohighlight">\(\nu\)</span> is 1, 6 and 11 below).</p>
<div class="highlight-freefem notranslate"><div class="highlight"><pre><span></span><span class="c1">// Problem</span>
<span class="kt">solve</span> <span class="nf">lap</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="o">=</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th</span><span class="p">)(</span>
          <span class="n">nu</span><span class="o">*</span><span class="p">(</span><span class="nf">dx</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dx</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="nf">dy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="nf">dy</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">int2d</span><span class="p">(</span><span class="n">th</span><span class="p">)(</span>
        <span class="o">-</span> <span class="mi">1</span><span class="o">*</span><span class="n">v</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="nf">on</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">;</span>

<span class="c1">// Plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</pre></div>
</div>
<div class="figure" id="id3">
<img alt="../_images/TransmissionProblem_U.png" src="../_images/TransmissionProblem_U.png" />
<p class="caption"><span class="caption-number">Fig. 220 </span><span class="caption-text">The isovalue of the solution <span class="math notranslate nohighlight">\(u\)</span></span></p>
</div>
</div>


				</div>
			</div>
		</div>
		
		<footer>
			<script>
    let date = new Date()
    let currentYear = date.getFullYear()
</script>
<div class="footer-text">
    <a href="https://freefem.org/">FreeFem++</a> 1987-<script>document.write(currentYear)</script>
</div>
<div class="footer-img">
    <p>
        Made with <i class="fas fa-heart"></i> on
    </p>
    <span class="separator"></span>
    <a href="https://github.com/FreeFem">
        <img alt="Github" title="Github" src="../_static/img/GitHub_Logo_White.png" />
    </a>
</div>
		</footer>
		

		<script src="../_static/js/toc.js"></script>
	</body>
</html>